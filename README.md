/*
Deployment script for 500008_ALF_Life

This code was generated by a tool.
Changes to this file may cause incorrect behavior and will be lost if
the code is regenerated.
*/

GO
SET ANSI_NULLS, ANSI_PADDING, ANSI_WARNINGS, ARITHABORT, CONCAT_NULL_YIELDS_NULL, QUOTED_IDENTIFIER ON;

SET NUMERIC_ROUNDABORT OFF;


GO
:setvar DATA_FOLDER "D:\_Team\Percana SPO\Branches\Development\Databases\LifeData_500008\Data"
:setvar LIFE "Life"
:setvar DatabaseName "500008_ALF_Life"
:setvar DefaultFilePrefix "500008_ALF_Life"
:setvar DefaultDataPath "C:\Program Files\Microsoft SQL Server\MSSQL15.MSSQLSERVER\MSSQL\DATA\"
:setvar DefaultLogPath "C:\Program Files\Microsoft SQL Server\MSSQL15.MSSQLSERVER\MSSQL\DATA\"

GO
:on error exit
GO
/*
Detect SQLCMD mode and disable script execution if SQLCMD mode is not supported.
To re-enable the script after enabling SQLCMD mode, execute the following:
SET NOEXEC OFF; 
*/
:setvar __IsSqlCmdEnabled "True"
GO
IF N'$(__IsSqlCmdEnabled)' NOT LIKE N'True'
    BEGIN
        PRINT N'SQLCMD mode must be enabled to successfully execute this script.';
        SET NOEXEC ON;
    END


GO
USE [$(DatabaseName)];


GO
/*
The column [dbo].[iy_intermediary].[iy_brand] is being dropped, data loss could occur.

The column [dbo].[iy_intermediary].[iy_distribution_channel] is being dropped, data loss could occur.

The column [dbo].[iy_intermediary].[iy_distribution_group] is being dropped, data loss could occur.

The column [dbo].[iy_intermediary].[iy_firm] is being dropped, data loss could occur.
*/

IF EXISTS (select top 1 1 from [dbo].[iy_intermediary])
    RAISERROR (N'Rows were detected. The schema update is terminating because data loss might occur.', 16, 127) WITH NOWAIT

GO
/*
The column [dbo].[iyh_intermediary_history].[iyh_brand] is being dropped, data loss could occur.

The column [dbo].[iyh_intermediary_history].[iyh_distribution_channel] is being dropped, data loss could occur.

The column [dbo].[iyh_intermediary_history].[iyh_distribution_group] is being dropped, data loss could occur.

The column [dbo].[iyh_intermediary_history].[iyh_firm] is being dropped, data loss could occur.
*/

IF EXISTS (select top 1 1 from [dbo].[iyh_intermediary_history])
    RAISERROR (N'Rows were detected. The schema update is terminating because data loss might occur.', 16, 127) WITH NOWAIT

GO
PRINT N'Dropping Index [dbo].[ct_client].[ct_indx1]...';


GO
DROP INDEX [ct_indx1]
    ON [dbo].[ct_client];


GO
PRINT N'Dropping Index [dbo].[ct_client].[ct_indx2]...';


GO
DROP INDEX [ct_indx2]
    ON [dbo].[ct_client];


GO
PRINT N'Dropping Default Constraint [dbo].[DF_blk_buk_actions_blk_parent_task_id]...';


GO
ALTER TABLE [dbo].[blk_buk_actions] DROP CONSTRAINT [DF_blk_buk_actions_blk_parent_task_id];


GO
PRINT N'Dropping Default Constraint [dbo].[DF_blk_buk_actions_blk_no_awd_items]...';


GO
ALTER TABLE [dbo].[blk_buk_actions] DROP CONSTRAINT [DF_blk_buk_actions_blk_no_awd_items];


GO
PRINT N'Dropping Default Constraint [dbo].[DF_blk_buk_actions_blk_no_exceptions]...';


GO
ALTER TABLE [dbo].[blk_buk_actions] DROP CONSTRAINT [DF_blk_buk_actions_blk_no_exceptions];


GO
PRINT N'Dropping Default Constraint [dbo].[DF_blk_buk_actions_blk_no_attempts]...';


GO
ALTER TABLE [dbo].[blk_buk_actions] DROP CONSTRAINT [DF_blk_buk_actions_blk_no_attempts];


GO
PRINT N'Dropping Default Constraint [dbo].[DF_blk_buk_actions_blk_parameters]...';


GO
ALTER TABLE [dbo].[blk_buk_actions] DROP CONSTRAINT [DF_blk_buk_actions_blk_parameters];


GO
PRINT N'Dropping Default Constraint unnamed constraint on [dbo].[blk_buk_actions]...';


GO
ALTER TABLE [dbo].[blk_buk_actions] DROP CONSTRAINT [DF__blk_buk_a__blk_n__335592AB];


GO
PRINT N'Dropping Default Constraint unnamed constraint on [dbo].[iy_intermediary]...';


GO
ALTER TABLE [dbo].[iy_intermediary] DROP CONSTRAINT [DF__iy_interm__iy_br__181857E1];


GO
PRINT N'Dropping Default Constraint unnamed constraint on [dbo].[iy_intermediary]...';


GO
ALTER TABLE [dbo].[iy_intermediary] DROP CONSTRAINT [DF__iy_interm__iy_fi__1AF4C48C];


GO
PRINT N'Dropping Default Constraint unnamed constraint on [dbo].[iy_intermediary]...';


GO
ALTER TABLE [dbo].[iy_intermediary] DROP CONSTRAINT [DF__iy_interm__iy_di__1A00A053];


GO
PRINT N'Dropping Default Constraint unnamed constraint on [dbo].[iy_intermediary]...';


GO
ALTER TABLE [dbo].[iy_intermediary] DROP CONSTRAINT [DF__iy_interm__iy_di__190C7C1A];


GO
PRINT N'Dropping Default Constraint [dbo].[DF__iyh_inter__iyh_c__56A9BBE0]...';


GO
ALTER TABLE [dbo].[iyh_intermediary_history] DROP CONSTRAINT [DF__iyh_inter__iyh_c__56A9BBE0];


GO
PRINT N'Dropping Default Constraint unnamed constraint on [dbo].[iyh_intermediary_history]...';


GO
ALTER TABLE [dbo].[iyh_intermediary_history] DROP CONSTRAINT [DF__iyh_inter__iyh_d__1DD13137];


GO
PRINT N'Dropping Default Constraint unnamed constraint on [dbo].[iyh_intermediary_history]...';


GO
ALTER TABLE [dbo].[iyh_intermediary_history] DROP CONSTRAINT [DF__iyh_inter__iyh_d__1CDD0CFE];


GO
PRINT N'Dropping Default Constraint unnamed constraint on [dbo].[iyh_intermediary_history]...';


GO
ALTER TABLE [dbo].[iyh_intermediary_history] DROP CONSTRAINT [DF__iyh_inter__iyh_b__1BE8E8C5];


GO
PRINT N'Dropping Default Constraint unnamed constraint on [dbo].[iyh_intermediary_history]...';


GO
ALTER TABLE [dbo].[iyh_intermediary_history] DROP CONSTRAINT [DF__iyh_inter__iyh_f__1EC55570];


GO
PRINT N'Altering Table [dbo].[ai_assignee]...';


GO
ALTER TABLE [dbo].[ai_assignee]
    ADD [ai_date_end_of_assignment] CHAR (8) DEFAULT (99991231) NOT NULL;


GO
PRINT N'Altering Table [dbo].[aih_assignee_history]...';


GO
ALTER TABLE [dbo].[aih_assignee_history]
    ADD [ai_date_end_of_assignment] CHAR (8) DEFAULT (99991231) NOT NULL;


GO
PRINT N'Altering Table [dbo].[ct_client]...';


GO
ALTER TABLE [dbo].[ct_client] ALTER COLUMN [ct_surname] NVARCHAR (200) NOT NULL;


GO
PRINT N'Creating Index [dbo].[ct_client].[ct_indx1]...';


GO
CREATE NONCLUSTERED INDEX [ct_indx1]
    ON [dbo].[ct_client]([ct_surname] ASC, [ct_firstname] ASC, [ct_dob] ASC) WITH (FILLFACTOR = 80);


GO
PRINT N'Creating Index [dbo].[ct_client].[ct_indx2]...';


GO
CREATE NONCLUSTERED INDEX [ct_indx2]
    ON [dbo].[ct_client]([ct_surname] ASC, [ct_dob] ASC) WITH (FILLFACTOR = 80);


GO
PRINT N'Altering Table [dbo].[ctd_client_tax_directive]...';


GO
SET ANSI_NULLS, QUOTED_IDENTIFIER OFF;


GO
ALTER TABLE [dbo].[ctd_client_tax_directive]
    ADD [ctd_opt]         CHAR (1)  DEFAULT ('') NOT NULL,
        [ctd_currency]    NCHAR (3) DEFAULT ('') NOT NULL,
        [ctd_active]      CHAR (1)  DEFAULT ('N') NOT NULL,
        [ctd_status_date] CHAR (8)  DEFAULT ('') NOT NULL;


GO
SET ANSI_NULLS, QUOTED_IDENTIFIER ON;


GO
PRINT N'Altering Table [dbo].[ctdh_client_tax_directive_history]...';


GO
SET ANSI_NULLS, QUOTED_IDENTIFIER OFF;


GO
ALTER TABLE [dbo].[ctdh_client_tax_directive_history]
    ADD [ctd_opt]         CHAR (1)  DEFAULT ('') NOT NULL,
        [ctd_currency]    NCHAR (3) DEFAULT ('') NOT NULL,
        [ctd_active]      CHAR (1)  DEFAULT ('N') NOT NULL,
        [ctd_status_date] CHAR (8)  DEFAULT ('') NOT NULL;


GO
SET ANSI_NULLS, QUOTED_IDENTIFIER ON;


GO
PRINT N'Altering Table [dbo].[cth_client_history]...';


GO
ALTER TABLE [dbo].[cth_client_history] ALTER COLUMN [cth_surname] NVARCHAR (200) NOT NULL;


GO
PRINT N'Altering Table [dbo].[ip_intermediary_policy_rel]...';


GO
ALTER TABLE [dbo].[ip_intermediary_policy_rel]
    ADD [ip_broker]                CHAR (1) DEFAULT ('N') NOT NULL,
        [ip_advising_intermediary] CHAR (1) DEFAULT ('N') NOT NULL,
        [ip_jockey]                CHAR (1) DEFAULT ('N') NOT NULL;


GO
PRINT N'Altering Table [dbo].[iy_intermediary]...';


GO
ALTER TABLE [dbo].[iy_intermediary] DROP COLUMN [iy_brand], COLUMN [iy_distribution_channel], COLUMN [iy_distribution_group], COLUMN [iy_firm];


GO
PRINT N'Altering Table [dbo].[iyh_intermediary_history]...';


GO
ALTER TABLE [dbo].[iyh_intermediary_history] DROP COLUMN [iyh_brand], COLUMN [iyh_distribution_channel], COLUMN [iyh_distribution_group], COLUMN [iyh_firm];


GO
PRINT N'Starting rebuilding table [dbo].[blk_buk_actions]...';


GO
BEGIN TRANSACTION;

SET TRANSACTION ISOLATION LEVEL SERIALIZABLE;

SET XACT_ABORT ON;

CREATE TABLE [dbo].[tmp_ms_xx_blk_buk_actions] (
    [blk_task_id]            INT            NOT NULL,
    [gsc_scheme_id]          INT            NOT NULL,
    [blk_task_type]          VARCHAR (8)    NOT NULL,
    [blk_next_task]          VARCHAR (8)    NOT NULL,
    [blk_create_date]        CHAR (8)       NOT NULL,
    [blk_last_updt_date]     CHAR (8)       NOT NULL,
    [blk_last_updt_time]     CHAR (8)       NOT NULL,
    [blk_last_updt_userid]   CHAR (8)       NOT NULL,
    [blk_business_date]      CHAR (8)       NOT NULL,
    [blk_record_status]      CHAR (1)       NOT NULL,
    [blk_init_create_date]   CHAR (8)       NOT NULL,
    [blk_init_create_userid] CHAR (8)       NOT NULL,
    [blk_archive]            CHAR (1)       NOT NULL,
    [blk_next_action_date]   CHAR (8)       NOT NULL,
    [blk_total]              INT            NOT NULL,
    [blk_no_complete]        INT            NOT NULL,
    [blk_no_failed]          INT            NOT NULL,
    [blk_parameters]         NVARCHAR (800) CONSTRAINT [DF_blk_buk_actions_blk_parameters] DEFAULT ('') NOT NULL,
    [blk_no_attempts]        INT            CONSTRAINT [DF_blk_buk_actions_blk_no_attempts] DEFAULT ((0)) NOT NULL,
    [blk_parent_task_id]     INT            CONSTRAINT [DF_blk_buk_actions_blk_parent_task_id] DEFAULT ((0)) NOT NULL,
    [blk_no_exceptions]      INT            CONSTRAINT [DF_blk_buk_actions_blk_no_exceptions] DEFAULT ((0)) NOT NULL,
    [blk_no_awd_items]       INT            CONSTRAINT [DF_blk_buk_actions_blk_no_awd_items] DEFAULT ((0)) NOT NULL,
    [blk_no_validated]       INT            DEFAULT ((0)) NOT NULL,
    CONSTRAINT [tmp_ms_xx_constraint_PK_blk_buk_actions1] PRIMARY KEY CLUSTERED ([blk_task_id] ASC)
);

IF EXISTS (SELECT TOP 1 1 
           FROM   [dbo].[blk_buk_actions])
    BEGIN
        INSERT INTO [dbo].[tmp_ms_xx_blk_buk_actions] ([blk_task_id], [gsc_scheme_id], [blk_task_type], [blk_next_task], [blk_create_date], [blk_last_updt_date], [blk_last_updt_time], [blk_last_updt_userid], [blk_business_date], [blk_record_status], [blk_init_create_date], [blk_init_create_userid], [blk_archive], [blk_next_action_date], [blk_total], [blk_no_complete], [blk_no_failed], [blk_parameters], [blk_no_attempts], [blk_parent_task_id], [blk_no_exceptions], [blk_no_awd_items], [blk_no_validated])
        SELECT   [blk_task_id],
                 [gsc_scheme_id],
                 [blk_task_type],
                 [blk_next_task],
                 [blk_create_date],
                 [blk_last_updt_date],
                 [blk_last_updt_time],
                 [blk_last_updt_userid],
                 [blk_business_date],
                 [blk_record_status],
                 [blk_init_create_date],
                 [blk_init_create_userid],
                 [blk_archive],
                 [blk_next_action_date],
                 [blk_total],
                 [blk_no_complete],
                 [blk_no_failed],
                 [blk_parameters],
                 [blk_no_attempts],
                 [blk_parent_task_id],
                 [blk_no_exceptions],
                 [blk_no_awd_items],
                 [blk_no_validated]
        FROM     [dbo].[blk_buk_actions]
        ORDER BY [blk_task_id] ASC;
    END

DROP TABLE [dbo].[blk_buk_actions];

EXECUTE sp_rename N'[dbo].[tmp_ms_xx_blk_buk_actions]', N'blk_buk_actions';

EXECUTE sp_rename N'[dbo].[tmp_ms_xx_constraint_PK_blk_buk_actions1]', N'PK_blk_buk_actions', N'OBJECT';

COMMIT TRANSACTION;

SET TRANSACTION ISOLATION LEVEL READ COMMITTED;


GO
PRINT N'Creating Table [dbo].[fpc_fit_and_proper_check]...';


GO
SET ANSI_NULLS, QUOTED_IDENTIFIER OFF;


GO
CREATE TABLE [dbo].[fpc_fit_and_proper_check] (
    [fpc_fit_n_proper_check_id] INT            IDENTITY (1, 1) NOT NULL,
    [iy_intermediary_id]        BIGINT         NOT NULL,
    [fpc_transaction]           NVARCHAR (10)  NOT NULL,
    [fpc_product_category]      NVARCHAR (7)   NOT NULL,
    [fpc_class_of_business]     NVARCHAR (7)   NOT NULL,
    [fpc_type]                  NVARCHAR (20)  NOT NULL,
    [fpc_effective_date]        CHAR (8)       NOT NULL,
    [fpc_create_date]           CHAR (8)       NOT NULL,
    [fpc_last_updt_date]        CHAR (8)       NOT NULL,
    [fpc_last_updt_time]        CHAR (6)       NOT NULL,
    [fpc_last_updt_userid]      CHAR (8)       NOT NULL,
    [fpc_business_date]         CHAR (8)       NOT NULL,
    [fpc_record_status]         CHAR (1)       NOT NULL,
    [fpc_valid]                 CHAR (1)       NOT NULL,
    [fpc_reason]                VARCHAR (1000) NOT NULL,
    CONSTRAINT [PK_fpc_fit_n_proper_check_id] PRIMARY KEY CLUSTERED ([fpc_fit_n_proper_check_id] ASC)
);


GO
SET ANSI_NULLS, QUOTED_IDENTIFIER ON;


GO
PRINT N'Creating Index [dbo].[fpc_fit_and_proper_check].[_dta_index_fpc_fit_and_proper_check__K10_K11]...';


GO
CREATE NONCLUSTERED INDEX [_dta_index_fpc_fit_and_proper_check__K10_K11]
    ON [dbo].[fpc_fit_and_proper_check]([fpc_last_updt_date] ASC, [fpc_last_updt_time] ASC) WITH (FILLFACTOR = 80);


GO
PRINT N'Creating Table [dbo].[gsco_scheme_charge_options]...';


GO
CREATE TABLE [dbo].[gsco_scheme_charge_options] (
    [gsco_scheme_charge_options_id] INT            NOT NULL,
    [gsc_scheme_id]                 INT            NOT NULL,
    [gsco_create_date]              CHAR (8)       NOT NULL,
    [gsco_last_updt_date]           CHAR (8)       NOT NULL,
    [gsco_last_updt_time]           CHAR (6)       NOT NULL,
    [gsco_last_updt_userid]         CHAR (8)       NOT NULL,
    [gsco_business_date]            CHAR (8)       NOT NULL,
    [gsco_record_status]            CHAR (1)       NOT NULL,
    [gsco_fee_type]                 CHAR (3)       NOT NULL,
    [gsco_payer]                    CHAR (2)       NOT NULL,
    [rule_st_selection_table_id]    INT            NOT NULL,
    [rule_ba_basis_no]              INT            NOT NULL,
    [gsco_value_type]               CHAR (1)       NOT NULL,
    [gsco_value]                    VARCHAR (5000) NOT NULL,
    CONSTRAINT [PK_gsco_charge_options_id] PRIMARY KEY CLUSTERED ([gsco_scheme_charge_options_id] ASC)
);


GO
PRINT N'Creating Table [dbo].[gscoh_scheme_charge_options_history]...';


GO
CREATE TABLE [dbo].[gscoh_scheme_charge_options_history] (
    [gscoh_scheme_charge_options_history_id] INT            IDENTITY (1, 1) NOT NULL,
    [gsco_scheme_charge_options_id]          INT            NOT NULL,
    [gsc_scheme_id]                          INT            NOT NULL,
    [gsco_create_date]                       CHAR (8)       NOT NULL,
    [gsco_last_updt_date]                    CHAR (8)       NOT NULL,
    [gsco_last_updt_time]                    CHAR (6)       NOT NULL,
    [gsco_last_updt_userid]                  CHAR (8)       NOT NULL,
    [gsco_business_date]                     CHAR (8)       NOT NULL,
    [gsco_record_status]                     CHAR (1)       NOT NULL,
    [gsco_fee_type]                          CHAR (3)       NOT NULL,
    [gsco_payer]                             CHAR (2)       NOT NULL,
    [rule_st_selection_table_id]             INT            NOT NULL,
    [rule_ba_basis_no]                       INT            NOT NULL,
    [gsco_value_type]                        CHAR (1)       NOT NULL,
    [gsco_value]                             VARCHAR (5000) NOT NULL,
    CONSTRAINT [PK_gscoh_scheme_charge_options_history_id] PRIMARY KEY CLUSTERED ([gscoh_scheme_charge_options_history_id] ASC) WITH (FILLFACTOR = 80)
);


GO
PRINT N'Creating Default Constraint unnamed constraint on [dbo].[fpc_fit_and_proper_check]...';


GO
ALTER TABLE [dbo].[fpc_fit_and_proper_check]
    ADD DEFAULT ('') FOR [fpc_transaction];


GO
PRINT N'Creating Default Constraint unnamed constraint on [dbo].[fpc_fit_and_proper_check]...';


GO
ALTER TABLE [dbo].[fpc_fit_and_proper_check]
    ADD DEFAULT ('') FOR [fpc_product_category];


GO
PRINT N'Creating Default Constraint unnamed constraint on [dbo].[fpc_fit_and_proper_check]...';


GO
ALTER TABLE [dbo].[fpc_fit_and_proper_check]
    ADD DEFAULT ('') FOR [fpc_class_of_business];


GO
PRINT N'Creating Default Constraint unnamed constraint on [dbo].[fpc_fit_and_proper_check]...';


GO
ALTER TABLE [dbo].[fpc_fit_and_proper_check]
    ADD DEFAULT ('') FOR [fpc_type];


GO
PRINT N'Creating Default Constraint unnamed constraint on [dbo].[fpc_fit_and_proper_check]...';


GO
ALTER TABLE [dbo].[fpc_fit_and_proper_check]
    ADD DEFAULT ('') FOR [fpc_last_updt_userid];


GO
PRINT N'Creating Default Constraint unnamed constraint on [dbo].[fpc_fit_and_proper_check]...';


GO
ALTER TABLE [dbo].[fpc_fit_and_proper_check]
    ADD DEFAULT ('') FOR [fpc_record_status];


GO
PRINT N'Creating Default Constraint unnamed constraint on [dbo].[fpc_fit_and_proper_check]...';


GO
ALTER TABLE [dbo].[fpc_fit_and_proper_check]
    ADD DEFAULT ('N') FOR [fpc_valid];


GO
PRINT N'Creating Default Constraint unnamed constraint on [dbo].[fpc_fit_and_proper_check]...';


GO
ALTER TABLE [dbo].[fpc_fit_and_proper_check]
    ADD DEFAULT ('') FOR [fpc_reason];


GO
PRINT N'Creating Default Constraint [dbo].[DF__iyh_inter__iyh_c__56A9BBE1]...';


GO
ALTER TABLE [dbo].[iyh_intermediary_history]
    ADD CONSTRAINT [DF__iyh_inter__iyh_c__56A9BBE1] DEFAULT ('') FOR [iyh_commission_contact];


GO
PRINT N'Creating Foreign Key [dbo].[FK_gsc_scheme]...';


GO
ALTER TABLE [dbo].[gsco_scheme_charge_options] WITH NOCHECK
    ADD CONSTRAINT [FK_gsc_scheme] FOREIGN KEY ([gsc_scheme_id]) REFERENCES [dbo].[gsc_scheme] ([gsc_scheme_id]);


GO
PRINT N'Refreshing View [dbo].[Eclipse_Box_Man_fh_Bdate]...';


GO
SET ANSI_NULLS ON;

SET QUOTED_IDENTIFIER OFF;


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[Eclipse_Box_Man_fh_Bdate]';


GO
SET ANSI_NULLS, QUOTED_IDENTIFIER ON;


GO
PRINT N'Refreshing View [dbo].[Eclipse_Box_Mngt_fh]...';


GO
SET ANSI_NULLS ON;

SET QUOTED_IDENTIFIER OFF;


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[Eclipse_Box_Mngt_fh]';


GO
SET ANSI_NULLS, QUOTED_IDENTIFIER ON;


GO
PRINT N'Refreshing View [dbo].[Eclipse_Box_mngt_pf]...';


GO
SET ANSI_NULLS ON;

SET QUOTED_IDENTIFIER OFF;


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[Eclipse_Box_mngt_pf]';


GO
SET ANSI_NULLS, QUOTED_IDENTIFIER ON;


GO
PRINT N'Refreshing View [dbo].[Eclipse_Box_mngt_pf_rec]...';


GO
SET ANSI_NULLS ON;

SET QUOTED_IDENTIFIER OFF;


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[Eclipse_Box_mngt_pf_rec]';


GO
SET ANSI_NULLS, QUOTED_IDENTIFIER ON;


GO
PRINT N'Refreshing View [dbo].[Eclipse_Box_Mngt_Tdo]...';


GO
SET ANSI_NULLS ON;

SET QUOTED_IDENTIFIER OFF;


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[Eclipse_Box_Mngt_Tdo]';


GO
SET ANSI_NULLS, QUOTED_IDENTIFIER ON;


GO
PRINT N'Refreshing View [dbo].[Eclipse_Box_Mngt_th]...';


GO
SET ANSI_NULLS ON;

SET QUOTED_IDENTIFIER OFF;


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[Eclipse_Box_Mngt_th]';


GO
SET ANSI_NULLS, QUOTED_IDENTIFIER ON;


GO
PRINT N'Refreshing View [dbo].[Eclipse_Box_Mngt_th_bdate]...';


GO
SET ANSI_NULLS ON;

SET QUOTED_IDENTIFIER OFF;


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[Eclipse_Box_Mngt_th_bdate]';


GO
SET ANSI_NULLS, QUOTED_IDENTIFIER ON;


GO
PRINT N'Refreshing View [dbo].[Eclipse_SAPExtract]...';


GO
SET ANSI_NULLS ON;

SET QUOTED_IDENTIFIER OFF;


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[Eclipse_SAPExtract]';


GO
SET ANSI_NULLS, QUOTED_IDENTIFIER ON;


GO
PRINT N'Refreshing View [dbo].[Eclipse_Val_PolicyClient]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[Eclipse_Val_PolicyClient]';


GO
PRINT N'Refreshing View [dbo].[VW_Contract_LTA]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[VW_Contract_LTA]';


GO
PRINT N'Refreshing View [dbo].[Eclipse_Val_PolicyGeneral]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[Eclipse_Val_PolicyGeneral]';


GO
PRINT N'Altering Procedure [dbo].[Report_DetailTradeExecution]...';


GO
ALTER PROCEDURE [dbo].[Report_DetailTradeExecution]
AS
BEGIN
	--------------------------INSERT STATEMENTS HERE------------------------------------

	DECLARE @SQL		VARCHAR(MAX)
	DECLARE @RULE_DB	VARCHAR(MAX)
	DECLARE @CurrentBusinessDate varchar(20)
	SELECT @CurrentBusinessDate = sc_run_from_date from sc_system_control
	SET @RULE_DB = dbo.fn_DatabasePrefix('RULES')

	SET @SQL = '
	SELECT FundCode
	,FundCurrencyCode
	,PensionTrustId
	,ProcessDate
	,PriceDate
	,PolicyId
	,TransactionId
	,TransactionType
	,TransactionDatePrice
	,UnitMovement
	,SUM(TranasactionAmount) AS TranasactionAmount
	,ProcessDatePrice
	,SUM(FundAmount) AS FundAmount
FROM (
	SELECT FPH.fd_fund_id AS FundCode
		,FF.fd_currency AS FundCurrencyCode
		,pp.po_company_number AS PensionTrustId
		,FORMAT(CONVERT(DATETIME, FF.fd_last_price_date, 112), ''dd/MM/yyyy'') AS ProcessDate
		,FORMAT(CONVERT(DATETIME, FPH.fp_pricing_date, 112), ''dd/MM/yyyy'') AS PriceDate
		,FPH.po_policy_id AS PolicyId
		,FPH.po_transaction_id AS TransactionId
		,fh_transaction_type AS TransactionType
		,IIF(fh_no_of_units > 0, FFP.fp_offer_price, FFP.fp_bid_price) AS TransactionDatePrice
		,fh_no_of_units AS UnitMovement
		,IIF(fh_no_of_units > 0, FFP.fp_offer_price * fh_no_of_units, FFP.fp_bid_price * fh_no_of_units) AS TranasactionAmount
		,IIF(fh_no_of_units > 0, FF.fd_last_offer_price, fd_last_bid_price) AS ProcessDatePrice
		,IIF(fh_no_of_units > 0, FF.fd_last_offer_price * fh_no_of_units, fd_last_bid_price * fh_no_of_units) AS FundAmount
	FROM fh_policy_fund_history FPH
	INNER JOIN fd_fund FF ON FF.fd_fund_id = FPH.fd_fund_id
		AND FPH.fd_fund_type = FF.fd_fund_type
		AND FF.fd_fund_classification = ''DEF''
	LEFT JOIN fp_fund_price FFP ON FFP.fd_fund_id = FF.fd_fund_id
		AND FPH.fd_fund_type = FFP.fd_fund_type
		AND FPH.fp_pricing_date = FFP.fp_pricing_date
	LEFT JOIN po_policy PP ON PP.po_policy_id = FPH.po_policy_id
	LEFT JOIN '+@RULE_DB+'.dbo.rule_pr_product RPP ON PP.po_product_number = RPP.rule_pr_Product_number
	WHERE rule_pr_country_code <> ''BS''
		AND FPH.fh_business_date = '+@CurrentBusinessDate+'
	) AS Tab
GROUP BY Tab.PolicyId
	,Tab.TransactionId
	,Tab.FundCode
	,Tab.PriceDate
	,Tab.FundCurrencyCode
	,Tab.PensionTrustId
	,Tab.ProcessDate
	,Tab.TransactionType
	,Tab.TransactionDatePrice
	,Tab.UnitMovement
	,Tab.ProcessDatePrice'

	EXEC (@SQL)

END
GO
PRINT N'Altering Procedure [dbo].[Report_DetailTradeGeneration]...';


GO
ALTER PROCEDURE [dbo].[Report_DetailTradeGeneration]
AS
BEGIN
	--------------------------INSERT STATEMENTS HERE------------------------------------

	DECLARE @SQL		VARCHAR(MAX)
	DECLARE @RULE_DB	VARCHAR(MAX)
	DECLARE @CurrentBusinessDate varchar(20)
	SELECT @CurrentBusinessDate = sc_run_from_date from sc_system_control
	SET @RULE_DB = dbo.fn_DatabasePrefix('RULES')

	SET @SQL = '
	SELECT tab.FundCode
	,tab.FundCurrencyCode
	,PensionTrustId
	,tab.TradeDate
	,tab.TradeType
	,tab.ValueBased
	,sum(Quantity) AS Quantity
	,tab.PolicyId
	,tab.TransactionId
	,tab.TransactionType
FROM (
	SELECT fd_rule_fund_id AS FundCode
		,tdo_fund_currency AS FundCurrencyCode
		,FORMAT(CONVERT(DATETIME, tdo_price_date, 112), ''dd/MM/yyyy'') AS TradeDate
		,IIF(tdo_order_type = ''S'', ''SAL'', ''PUR'') AS TradeType
		,CASE 
			WHEN tdo_value <> 0
				THEN ''Yes''
			WHEN tdo_units <> 0
				THEN ''No''
			END AS ValueBased
		,CASE 
			WHEN tdo_value <> 0
				AND tdo_order_type != ''S''
				THEN tdo_value
			WHEN tdo_value <> 0
				AND tdo_order_type = ''S''
				THEN - tdo_value
			WHEN tdo_units <> 0
				AND tdo_order_type != ''S''
				THEN tdo_units
			WHEN tdo_units <> 0
				AND tdo_order_type = ''S''
				THEN - tdo_units
			ELSE 0
			END AS Quantity
		,tto.po_policy_id AS PolicyId
		,tto.po_transaction_id AS TransactionId
		,tdo_unit_history_tx_type AS TransactionType
		,tto.pr_premium_id
		,tto.po_policy_id
		,tto.po_transaction_id
		,fd_rule_fund_id
		,tdo_price_date
		,tdo_order_type
		,pp.po_company_number AS PensionTrustId
	FROM tdo_trade_orders tto
	LEFT JOIN '+@RULE_DB+'.dbo.rule_pr_product rpp ON tto.po_product_number = rpp.rule_pr_Product_number
	LEFT JOIN po_policy pp ON pp.po_policy_id = tto.po_policy_id
	WHERE rule_pr_country_code <> ''BS''
		AND (
			(
				tdo_order_type = ''S''
				AND tto.tdo_record_status = ''I''
				AND tdo_business_date = '+@CurrentBusinessDate+'
				)
			OR (
				tdo_order_type = ''B''
				AND tto.tdo_record_status = ''G''
				AND tdo_unit_history_tx_type <> ''SWIN''
				AND tdo_business_date = '+@CurrentBusinessDate+'
				)
			OR (
				tdo_order_type = ''B''
				AND tto.tdo_record_status = ''G''
				AND tdo_unit_history_tx_type = ''SWIN''
				AND EXISTS (
					SELECT *
					FROM tdo_trade_orders TDOLINKED
					WHERE TDOLINKED.tdo_trade_order_id = tdo_linked_proportion_order_id
						AND TDOLINKED.tdo_last_attempted_execution_date = '+@CurrentBusinessDate+'
					)
				)
			)
	) AS tab
GROUP BY tab.PolicyId
	,tab.TransactionId
	,tab.FundCode
	,tab.tdo_price_date
	,tab.tdo_order_type
	,tab.TransactionId
	,tab.TransactionType
	,tab.FundCurrencyCode
	,tab.TradeType
	,tab.TradeDate
	,tab.ValueBased
	,tab.PensionTrustId
'

	EXEC (@SQL)

END
GO
PRINT N'Altering Procedure [dbo].[Report_SummaryTradeExecution]...';


GO
ALTER PROCEDURE [dbo].[Report_SummaryTradeExecution]
AS
BEGIN
	--------------------------INSERT STATEMENTS HERE------------------------------------

	DECLARE @SQL		VARCHAR(MAX)
	DECLARE @RULE_DB	VARCHAR(MAX)
	DECLARE @CurrentBusinessDate varchar(20)
	SELECT @CurrentBusinessDate = sc_run_from_date from sc_system_control
	SET @RULE_DB = dbo.fn_DatabasePrefix('RULES')

	SET @SQL = '
	SELECT FundCode
	,FundCurrencyCode
	,PensionTrustId
	,ProcessDate
	,UnitsIn
	,AmtsIn
	,FundAmtsIn
	,UnitsOut
	,AmtsOut
	,FundAmtsOut
	,Openingunit.OpeningUnits
	,(UnitsIn + UnitsOut) AS MovementInUnits
	,(UnitsIn + UnitsOut + Openingunit.OpeningUnits) AS ClosingUnits
	,(AmtsIn + AmtsOut) AS TotalAmounts
	,(FundAmtsIn + FundAmtsOut) AS TotalFundAmounts
FROM (
	SELECT rule_fa_fund_code AS FundCode
		,fdf.fd_currency AS FundCurrencyCode
		,rule_pr_company_number AS PensionTrustId
		,fdf.fd_last_price_date AS ProcessDate
		,UnitsIn
		,AmtsIn
		,FundAmtsIn
		,UnitsOut
		,AmtsOut
		,FundAmtsOut
		,(UnitsIn + UnitsOut) AS MovementInUnits
		,(AmtsIn + AmtsOut) AS TotalAmounts
		,(FundAmtsIn + FundAmtsOut) AS TotalFundAmounts
	FROM (
		SELECT DISTINCT rule_fa_fund_code
			,rule_pr_company_number
		FROM '+@RULE_DB+'.dbo.rule_fa_fundapplies ff
		JOIN '+@RULE_DB+'.dbo.rule_pr_product pp ON pp.rule_pr_Product_number = ff.rule_pr_product_number
		JOIN fd_fund fund ON fund.fd_fund_id = ff.rule_fa_fund_code
		WHERE pp.rule_pr_country_code <> ''BS''
			AND fund.fd_fund_classification = ''DEF''
		) main
	LEFT JOIN (
		SELECT noOpeningUnits.fd_fund_id
			,noOpeningUnits.po_company_number
			,UnitsIn
			,UnitsOut
			,AmtsIn
			,AmtsOut
			,FundAmtsIn
			,FundAmtsOut
		FROM (
			SELECT FPH.fd_fund_id
				,pp.po_company_number
				,SUM(IIF(fh_no_of_units > 0, fh_no_of_units, 0)) AS UnitsIn
				,SUM(IIF(fh_no_of_units < 0, fh_no_of_units, 0)) AS UnitsOut
				,SUM(IIF(fh_no_of_units > 0, FFP.fp_offer_price * fh_no_of_units, 0)) AS AmtsIn
				,SUM(IIF(fh_no_of_units < 0, FFP.fp_bid_price * fh_no_of_units, 0)) AS AmtsOut
				,SUM(IIF(fh_no_of_units > 0, FF.fd_last_offer_price * fh_no_of_units, 0)) AS FundAmtsIn
				,SUM(IIF(fh_no_of_units < 0, fd_last_bid_price * fh_no_of_units, 0)) AS FundAmtsOut
			FROM fh_policy_fund_history FPH
			INNER JOIN fd_fund FF ON FF.fd_fund_id = FPH.fd_fund_id
				AND FPH.fd_fund_type = FF.fd_fund_type
				AND FF.fd_fund_classification = ''DEF''
			LEFT JOIN fp_fund_price FFP ON FFP.fd_fund_id = FF.fd_fund_id
				AND FPH.fd_fund_type = FFP.fd_fund_type
				AND FPH.fp_pricing_date = FFP.fp_pricing_date
			LEFT JOIN po_policy PP ON PP.po_policy_id = FPH.po_policy_id
			LEFT JOIN '+@RULE_DB+'.dbo.rule_pr_product RPP ON PP.po_product_number = RPP.rule_pr_Product_number
			WHERE rule_pr_country_code <> ''BS''
				AND FPH.fh_business_date = '+@CurrentBusinessDate+'
			GROUP BY FPH.fd_fund_id
				,pp.po_company_number
			) noOpeningUnits
		) detail ON detail.fd_fund_id = main.rule_fa_fund_code
		AND detail.po_company_number = main.rule_pr_company_number
	INNER JOIN fd_fund fdf ON fdf.fd_fund_id = main.rule_fa_fund_code
	) nocom
LEFT JOIN (
	SELECT FPH.fd_fund_id
		,pp.po_company_number
		,SUM(IIF(fh_attribution_date < '+@CurrentBusinessDate+', fh_no_of_units, 0)) AS OpeningUnits
	FROM fh_policy_fund_history FPH
	INNER JOIN fd_fund FF ON FF.fd_fund_id = FPH.fd_fund_id
		AND FPH.fd_fund_type = FF.fd_fund_type
		AND FF.fd_fund_classification = ''DEF''
	LEFT JOIN po_policy PP ON PP.po_policy_id = FPH.po_policy_id
	LEFT JOIN '+@RULE_DB+'.dbo.rule_pr_product RPP ON PP.po_product_number = RPP.rule_pr_Product_number
	WHERE rule_pr_country_code <> ''BS''
	GROUP BY FPH.fd_fund_id
		,pp.po_company_number
	) Openingunit ON Openingunit.fd_fund_id = nocom.FundCode
'
	EXEC (@SQL)

END
GO
PRINT N'Altering Procedure [dbo].[Report_SummaryTradeGeneration]...';


GO
ALTER PROCEDURE [dbo].[Report_SummaryTradeGeneration]
AS
BEGIN
	--------------------------INSERT STATEMENTS HERE------------------------------------

	DECLARE @SQL		VARCHAR(MAX)
	DECLARE @RULE_DB	VARCHAR(MAX)
	DECLARE @CurrentBusinessDate varchar(20)
	SELECT @CurrentBusinessDate = sc_run_from_date from sc_system_control
	SET @RULE_DB = dbo.fn_DatabasePrefix('RULES')

	SET @SQL = '
	SELECT tab.FundCode
	,tab.FundCurrencyCode
	,PensionTrustId
	,tab.TradeDate
	,tab.TradeType
	,tab.ValueBased
	,sum(Quantity) AS Quantity
FROM (
	SELECT fd_rule_fund_id AS FundCode
		,tdo_fund_currency AS FundCurrencyCode
		,pp.po_company_number AS PensionTrustId
		,FORMAT(CONVERT(DATETIME, tdo_price_date, 112), ''dd/MM/yyyy'') AS TradeDate
		,CASE 
			WHEN tdo_order_type = ''S''
				THEN ''SAL''
			ELSE ''PUR''
			END AS TradeType
		,CASE 
			WHEN tdo_value <> 0
				THEN ''Yes''
			WHEN tdo_units <> 0
				THEN ''No''
			END AS ValueBased
		,CASE 
			WHEN tdo_value <> 0
				AND tdo_order_type != ''S''
				THEN tdo_value
			WHEN tdo_value <> 0
				AND tdo_order_type = ''S''
				THEN - tdo_value
			WHEN tdo_units <> 0
				AND tdo_order_type != ''S''
				THEN tdo_units
			WHEN tdo_units <> 0
				AND tdo_order_type = ''S''
				THEN - tdo_units
			ELSE 0
			END AS Quantity
		,tdo_price_date
		,tdo_order_type
	FROM tdo_trade_orders tto
	LEFT JOIN '+@RULE_DB+'.dbo.rule_pr_product rpp ON tto.po_product_number = rpp.rule_pr_Product_number
	LEFT JOIN po_policy pp ON pp.po_policy_id = tto.po_policy_id
	WHERE rule_pr_country_code <> ''BS''
		AND (
			(
				tdo_order_type = ''S''
				AND tto.tdo_record_status = ''I''
				AND tdo_business_date = '+@CurrentBusinessDate+'
				)
			OR (
				tdo_order_type = ''B''
				AND tto.tdo_record_status = ''G''
				AND tdo_unit_history_tx_type <> ''SWIN''
				AND tdo_business_date = '+@CurrentBusinessDate+'
				)
			OR (
				tdo_order_type = ''B''
				AND tto.tdo_record_status = ''G''
				AND tdo_unit_history_tx_type = ''SWIN''
				AND EXISTS (
					SELECT *
					FROM tdo_trade_orders TDOLINKED
					WHERE TDOLINKED.tdo_trade_order_id = tdo_linked_proportion_order_id
						AND TDOLINKED.tdo_last_attempted_execution_date = '+@CurrentBusinessDate+'
					)
				)
			)
	) AS tab
GROUP BY tab.tdo_price_date
	,tab.tdo_order_type
	,tab.FundCode
	,tab.FundCurrencyCode
	,tab.PensionTrustId
	,tab.TradeDate
	,tab.TradeType
	,tab.ValueBased
'

	EXEC (@SQL)

END
GO
PRINT N'Creating Procedure [dbo].[Add_New_Segregated_fund_Life.sql]...';


GO
SET ANSI_NULLS, QUOTED_IDENTIFIER OFF;


GO
CREATE PROCEDURE [dbo].[Add_New_Segregated_fund_Life.sql] 
	(
	 @FundId CHAR(5), 
	 @UserId VARCHAR(8),
	 @Currency VARCHAR(3),
	 @NextPriceDate VARCHAR(8),
	 @LastPriceDate VARCHAR(8),
	 @LastPrice NUMERIC(21,12)
	)
AS
BEGIN

DECLARE @Today	AS VARCHAR(8)
DECLARE @Time	AS VARCHAR(6)
DECLARE @BusDate AS VARCHAR(8)

SET @Today  = CONVERT(CHAR(8), GETDATE(), 112)
SET @Time   = RTRIM(REPLACE(CONVERT(CHAR(8), GETDATE(), 108), ':', ''))
IF (@UserId = '') SET @UserId = 'NEWFUND'		
SET @BusDate =(SELECT sc_business_date  FROM sc_system_control )

IF EXISTS (SELECT * FROM fd_fund WHERE fd_fund_id = @FundId ) 
	BEGIN
		PRINT 'Fund record already exists for Fund : ' +@FundId 
		PRINT 'Updates will not be applied.'
	END
ELSE
	BEGIN
	
		INSERT INTO fd_fund
		VALUES (@FundId,		--fd_fund_id
				'A',			--fd_fund_type
				@Today,			--fd_create_date
				@Today,			--fd_last_updt_date
				@Time,			--fd_last_updt_time
				@UserId,		--fd_last_updt_userid
				@BusDate,		--fd_business_date
				'I',			--fd_record_status
				@LastPrice,		--fd_last_bid_price
				@LastPrice,		--fd_last_offer_price
				@LastPriceDate,	--fd_last_price_date
				@NextPriceDate,	--fd_next_price_date
				0,				--fd_total_no_units
				'000000',		--fd_last_price_time
				'000000',		--fd_next_price_time
				@LastPriceDate,	--fd_last_expected_price_date
				@LastPriceDate,	--fd_last_expected_sell_price_date
				@Currency,		--fd_currency
				0,				--fd_last_asset_offer_price
				0,				--fd_last_asset_bid_price
				'N',			--rule_fu_whole_units
				@FundId,		--fd_rule_fund_id
				'10000101',		--fd_freq_change_next_price_date
				'10000101',		--fd_next_trade_cutoff_date
				'10000101',		--fd_next_disinvestment_notice_date
				'10000101',		--fd_last_trade_cutoff_date
				'10000101',		--fd_last_disinvestment_notice_date
				0,				--fd_nominal_no_of_units
				'E',			--fd_rule_fund_group
				'DEF',			--fd_fund_classification
				0,				--fd_portfolio_cash
				0,				--fd_portfolio_num_assets
				0,				--fd_portfolio_last_value
				'',				--fd_portfolio_external_id
				0,				--fd_portfolio_num_accounts
				'',				--fd_fu_gl_code
				'99991231'		--fd_closed_date
				)		

				INSERT INTO fp_fund_price
				VALUES 
				(@FundId,		--fd_fund_id
				'A',			--fd_fund_type
				@LastPriceDate,	--fp_pricing_date
				'000000',		--fp_pricing_time
				@Today,			--fp_create_date
				@Today,			--fp_last_updt_date
				@Time,			--fp_last_updt_time
				@UserId,		--fp_last_updt_userid
				@LastPriceDate,	--fp_business_date
				'I',			--fp_record_status
				@LastPrice,		--fp_offer_price
				@LastPrice,		--fp_bid_price
				@LastPriceDate,	--fp_applies_from_date
				@LastPriceDate,	--fp_applies_to_date
				'10000101',				--fp_previous_price_date
				@NextPriceDate,	--fp_next_price_date
				'P',			--fp_record_type
				0,				--fp_asset_offer_price
				0,				--fp_asset_bid_price
				0,				--fp_price_purpose
				-1,				--fp_fund_price_id
				-1				--sl_system_log_id
				)		

	END
END
GO
SET ANSI_NULLS, QUOTED_IDENTIFIER ON;


GO
PRINT N'Creating Extended Property [dbo].[blk_buk_actions].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'TBD', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'blk_buk_actions';


GO
PRINT N'Creating Extended Property [dbo].[blk_buk_actions].[blk_task_id].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'TBD', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'blk_buk_actions', @level2type = N'COLUMN', @level2name = N'blk_task_id';


GO
PRINT N'Creating Extended Property [dbo].[blk_buk_actions].[gsc_scheme_id].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'TBD', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'blk_buk_actions', @level2type = N'COLUMN', @level2name = N'gsc_scheme_id';


GO
PRINT N'Creating Extended Property [dbo].[blk_buk_actions].[blk_task_type].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'TBD', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'blk_buk_actions', @level2type = N'COLUMN', @level2name = N'blk_task_type';


GO
PRINT N'Creating Extended Property [dbo].[blk_buk_actions].[blk_next_task].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'TBD', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'blk_buk_actions', @level2type = N'COLUMN', @level2name = N'blk_next_task';


GO
PRINT N'Creating Extended Property [dbo].[blk_buk_actions].[blk_create_date].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'TBD', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'blk_buk_actions', @level2type = N'COLUMN', @level2name = N'blk_create_date';


GO
PRINT N'Creating Extended Property [dbo].[blk_buk_actions].[blk_last_updt_date].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'TBD', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'blk_buk_actions', @level2type = N'COLUMN', @level2name = N'blk_last_updt_date';


GO
PRINT N'Creating Extended Property [dbo].[blk_buk_actions].[blk_last_updt_time].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'TBD', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'blk_buk_actions', @level2type = N'COLUMN', @level2name = N'blk_last_updt_time';


GO
PRINT N'Creating Extended Property [dbo].[blk_buk_actions].[blk_last_updt_userid].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'TBD', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'blk_buk_actions', @level2type = N'COLUMN', @level2name = N'blk_last_updt_userid';


GO
PRINT N'Creating Extended Property [dbo].[blk_buk_actions].[blk_business_date].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'TBD', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'blk_buk_actions', @level2type = N'COLUMN', @level2name = N'blk_business_date';


GO
PRINT N'Creating Extended Property [dbo].[blk_buk_actions].[blk_record_status].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'TBD', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'blk_buk_actions', @level2type = N'COLUMN', @level2name = N'blk_record_status';


GO
PRINT N'Creating Extended Property [dbo].[blk_buk_actions].[blk_init_create_date].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'TBD', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'blk_buk_actions', @level2type = N'COLUMN', @level2name = N'blk_init_create_date';


GO
PRINT N'Creating Extended Property [dbo].[blk_buk_actions].[blk_init_create_userid].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'TBD', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'blk_buk_actions', @level2type = N'COLUMN', @level2name = N'blk_init_create_userid';


GO
PRINT N'Creating Extended Property [dbo].[blk_buk_actions].[blk_archive].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'TBD', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'blk_buk_actions', @level2type = N'COLUMN', @level2name = N'blk_archive';


GO
PRINT N'Creating Extended Property [dbo].[blk_buk_actions].[blk_next_action_date].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'TBD', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'blk_buk_actions', @level2type = N'COLUMN', @level2name = N'blk_next_action_date';


GO
PRINT N'Creating Extended Property [dbo].[blk_buk_actions].[blk_total].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'TBD', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'blk_buk_actions', @level2type = N'COLUMN', @level2name = N'blk_total';


GO
PRINT N'Creating Extended Property [dbo].[blk_buk_actions].[blk_no_complete].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'TBD', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'blk_buk_actions', @level2type = N'COLUMN', @level2name = N'blk_no_complete';


GO
PRINT N'Creating Extended Property [dbo].[blk_buk_actions].[blk_no_failed].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'TBD', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'blk_buk_actions', @level2type = N'COLUMN', @level2name = N'blk_no_failed';


GO
PRINT N'Creating Extended Property [dbo].[blk_buk_actions].[blk_parameters].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'TBD', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'blk_buk_actions', @level2type = N'COLUMN', @level2name = N'blk_parameters';


GO
PRINT N'Creating Extended Property [dbo].[blk_buk_actions].[blk_no_attempts].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'TBD', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'blk_buk_actions', @level2type = N'COLUMN', @level2name = N'blk_no_attempts';


GO
PRINT N'Creating Extended Property [dbo].[blk_buk_actions].[blk_parent_task_id].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'TBD', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'blk_buk_actions', @level2type = N'COLUMN', @level2name = N'blk_parent_task_id';


GO
PRINT N'Creating Extended Property [dbo].[blk_buk_actions].[blk_no_exceptions].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'TBD', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'blk_buk_actions', @level2type = N'COLUMN', @level2name = N'blk_no_exceptions';


GO
PRINT N'Creating Extended Property [dbo].[blk_buk_actions].[blk_no_awd_items].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'TBD', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'blk_buk_actions', @level2type = N'COLUMN', @level2name = N'blk_no_awd_items';


GO
PRINT N'Creating Extended Property [dbo].[blk_buk_actions].[blk_no_validated].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'TBD', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'blk_buk_actions', @level2type = N'COLUMN', @level2name = N'blk_no_validated';


GO
PRINT N'Creating Extended Property [dbo].[fpc_fit_and_proper_check].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'This table maintains history for Fit and proper check.', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'fpc_fit_and_proper_check';


GO
PRINT N'Creating Extended Property [dbo].[fpc_fit_and_proper_check].[fpc_fit_n_proper_check_id].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'The code used to identify a fit n proper check id.', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'fpc_fit_and_proper_check', @level2type = N'COLUMN', @level2name = N'fpc_fit_n_proper_check_id';


GO
PRINT N'Creating Extended Property [dbo].[fpc_fit_and_proper_check].[iy_intermediary_id].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'The code used to identify an intermediary id.', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'fpc_fit_and_proper_check', @level2type = N'COLUMN', @level2name = N'iy_intermediary_id';


GO
PRINT N'Creating Extended Property [dbo].[fpc_fit_and_proper_check].[fpc_transaction].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'The code used to identify a transaction.', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'fpc_fit_and_proper_check', @level2type = N'COLUMN', @level2name = N'fpc_transaction';


GO
PRINT N'Creating Extended Property [dbo].[fpc_fit_and_proper_check].[fpc_product_category].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'The code used to identify a product category.', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'fpc_fit_and_proper_check', @level2type = N'COLUMN', @level2name = N'fpc_product_category';


GO
PRINT N'Creating Extended Property [dbo].[fpc_fit_and_proper_check].[fpc_class_of_business].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'The code used to identify a class of business.', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'fpc_fit_and_proper_check', @level2type = N'COLUMN', @level2name = N'fpc_class_of_business';


GO
PRINT N'Creating Extended Property [dbo].[fpc_fit_and_proper_check].[fpc_type].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'The code used to identify a type.', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'fpc_fit_and_proper_check', @level2type = N'COLUMN', @level2name = N'fpc_type';


GO
PRINT N'Creating Extended Property [dbo].[fpc_fit_and_proper_check].[fpc_effective_date].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'The code used to identify effective date.', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'fpc_fit_and_proper_check', @level2type = N'COLUMN', @level2name = N'fpc_effective_date';


GO
PRINT N'Creating Extended Property [dbo].[fpc_fit_and_proper_check].[fpc_create_date].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'The code used to identify created date.', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'fpc_fit_and_proper_check', @level2type = N'COLUMN', @level2name = N'fpc_create_date';


GO
PRINT N'Creating Extended Property [dbo].[fpc_fit_and_proper_check].[fpc_last_updt_date].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'The code used to identify last updated date.', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'fpc_fit_and_proper_check', @level2type = N'COLUMN', @level2name = N'fpc_last_updt_date';


GO
PRINT N'Creating Extended Property [dbo].[fpc_fit_and_proper_check].[fpc_last_updt_time].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'The code used to identify last updated time.', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'fpc_fit_and_proper_check', @level2type = N'COLUMN', @level2name = N'fpc_last_updt_time';


GO
PRINT N'Creating Extended Property [dbo].[fpc_fit_and_proper_check].[fpc_last_updt_userid].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'The code used to identify last updated user.', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'fpc_fit_and_proper_check', @level2type = N'COLUMN', @level2name = N'fpc_last_updt_userid';


GO
PRINT N'Creating Extended Property [dbo].[fpc_fit_and_proper_check].[fpc_business_date].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'The code used to identify business date.', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'fpc_fit_and_proper_check', @level2type = N'COLUMN', @level2name = N'fpc_business_date';


GO
PRINT N'Creating Extended Property [dbo].[fpc_fit_and_proper_check].[fpc_record_status].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'The code used to identify record status.', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'fpc_fit_and_proper_check', @level2type = N'COLUMN', @level2name = N'fpc_record_status';


GO
PRINT N'Creating Extended Property [dbo].[fpc_fit_and_proper_check].[fpc_valid].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'The code used to identify validity.', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'fpc_fit_and_proper_check', @level2type = N'COLUMN', @level2name = N'fpc_valid';


GO
PRINT N'Creating Extended Property [dbo].[fpc_fit_and_proper_check].[fpc_reason].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'The code used to identify reason.', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'fpc_fit_and_proper_check', @level2type = N'COLUMN', @level2name = N'fpc_reason';


GO
PRINT N'Creating Extended Property [dbo].[gsco_scheme_charge_options].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'TBD', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'gsco_scheme_charge_options';


GO
PRINT N'Creating Extended Property [dbo].[gsco_scheme_charge_options].[gsco_scheme_charge_options_id].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'TBD', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'gsco_scheme_charge_options', @level2type = N'COLUMN', @level2name = N'gsco_scheme_charge_options_id';


GO
PRINT N'Creating Extended Property [dbo].[gsco_scheme_charge_options].[gsc_scheme_id].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'TBD', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'gsco_scheme_charge_options', @level2type = N'COLUMN', @level2name = N'gsc_scheme_id';


GO
PRINT N'Creating Extended Property [dbo].[gsco_scheme_charge_options].[gsco_create_date].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'TBD', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'gsco_scheme_charge_options', @level2type = N'COLUMN', @level2name = N'gsco_create_date';


GO
PRINT N'Creating Extended Property [dbo].[gsco_scheme_charge_options].[gsco_last_updt_date].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'TBD', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'gsco_scheme_charge_options', @level2type = N'COLUMN', @level2name = N'gsco_last_updt_date';


GO
PRINT N'Creating Extended Property [dbo].[gsco_scheme_charge_options].[gsco_last_updt_time].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'TBD', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'gsco_scheme_charge_options', @level2type = N'COLUMN', @level2name = N'gsco_last_updt_time';


GO
PRINT N'Creating Extended Property [dbo].[gsco_scheme_charge_options].[gsco_last_updt_userid].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'TBD', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'gsco_scheme_charge_options', @level2type = N'COLUMN', @level2name = N'gsco_last_updt_userid';


GO
PRINT N'Creating Extended Property [dbo].[gsco_scheme_charge_options].[gsco_business_date].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'TBD', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'gsco_scheme_charge_options', @level2type = N'COLUMN', @level2name = N'gsco_business_date';


GO
PRINT N'Creating Extended Property [dbo].[gsco_scheme_charge_options].[gsco_record_status].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'TBD', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'gsco_scheme_charge_options', @level2type = N'COLUMN', @level2name = N'gsco_record_status';


GO
PRINT N'Creating Extended Property [dbo].[gsco_scheme_charge_options].[gsco_fee_type].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'TBD', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'gsco_scheme_charge_options', @level2type = N'COLUMN', @level2name = N'gsco_fee_type';


GO
PRINT N'Creating Extended Property [dbo].[gsco_scheme_charge_options].[gsco_payer].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'TBD', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'gsco_scheme_charge_options', @level2type = N'COLUMN', @level2name = N'gsco_payer';


GO
PRINT N'Creating Extended Property [dbo].[gsco_scheme_charge_options].[rule_st_selection_table_id].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'TBD', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'gsco_scheme_charge_options', @level2type = N'COLUMN', @level2name = N'rule_st_selection_table_id';


GO
PRINT N'Creating Extended Property [dbo].[gsco_scheme_charge_options].[rule_ba_basis_no].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'TBD', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'gsco_scheme_charge_options', @level2type = N'COLUMN', @level2name = N'rule_ba_basis_no';


GO
PRINT N'Creating Extended Property [dbo].[gsco_scheme_charge_options].[gsco_value_type].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'TBD', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'gsco_scheme_charge_options', @level2type = N'COLUMN', @level2name = N'gsco_value_type';


GO
PRINT N'Creating Extended Property [dbo].[gsco_scheme_charge_options].[gsco_value].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'TBD', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'gsco_scheme_charge_options', @level2type = N'COLUMN', @level2name = N'gsco_value';


GO
PRINT N'Creating Extended Property [dbo].[gscoh_scheme_charge_options_history].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'TBD', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'gscoh_scheme_charge_options_history';


GO
PRINT N'Creating Extended Property [dbo].[gscoh_scheme_charge_options_history].[gscoh_scheme_charge_options_history_id].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'TBD', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'gscoh_scheme_charge_options_history', @level2type = N'COLUMN', @level2name = N'gscoh_scheme_charge_options_history_id';


GO
PRINT N'Creating Extended Property [dbo].[gscoh_scheme_charge_options_history].[gsco_scheme_charge_options_id].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'TBD', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'gscoh_scheme_charge_options_history', @level2type = N'COLUMN', @level2name = N'gsco_scheme_charge_options_id';


GO
PRINT N'Creating Extended Property [dbo].[gscoh_scheme_charge_options_history].[gsc_scheme_id].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'TBD', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'gscoh_scheme_charge_options_history', @level2type = N'COLUMN', @level2name = N'gsc_scheme_id';


GO
PRINT N'Creating Extended Property [dbo].[gscoh_scheme_charge_options_history].[gsco_create_date].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'TBD', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'gscoh_scheme_charge_options_history', @level2type = N'COLUMN', @level2name = N'gsco_create_date';


GO
PRINT N'Creating Extended Property [dbo].[gscoh_scheme_charge_options_history].[gsco_last_updt_date].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'TBD', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'gscoh_scheme_charge_options_history', @level2type = N'COLUMN', @level2name = N'gsco_last_updt_date';


GO
PRINT N'Creating Extended Property [dbo].[gscoh_scheme_charge_options_history].[gsco_last_updt_time].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'TBD', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'gscoh_scheme_charge_options_history', @level2type = N'COLUMN', @level2name = N'gsco_last_updt_time';


GO
PRINT N'Creating Extended Property [dbo].[gscoh_scheme_charge_options_history].[gsco_last_updt_userid].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'TBD', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'gscoh_scheme_charge_options_history', @level2type = N'COLUMN', @level2name = N'gsco_last_updt_userid';


GO
PRINT N'Creating Extended Property [dbo].[gscoh_scheme_charge_options_history].[gsco_business_date].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'TBD', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'gscoh_scheme_charge_options_history', @level2type = N'COLUMN', @level2name = N'gsco_business_date';


GO
PRINT N'Creating Extended Property [dbo].[gscoh_scheme_charge_options_history].[gsco_record_status].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'TBD', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'gscoh_scheme_charge_options_history', @level2type = N'COLUMN', @level2name = N'gsco_record_status';


GO
PRINT N'Creating Extended Property [dbo].[gscoh_scheme_charge_options_history].[gsco_fee_type].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'TBD', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'gscoh_scheme_charge_options_history', @level2type = N'COLUMN', @level2name = N'gsco_fee_type';


GO
PRINT N'Creating Extended Property [dbo].[gscoh_scheme_charge_options_history].[gsco_payer].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'TBD', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'gscoh_scheme_charge_options_history', @level2type = N'COLUMN', @level2name = N'gsco_payer';


GO
PRINT N'Creating Extended Property [dbo].[gscoh_scheme_charge_options_history].[rule_st_selection_table_id].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'TBD', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'gscoh_scheme_charge_options_history', @level2type = N'COLUMN', @level2name = N'rule_st_selection_table_id';


GO
PRINT N'Creating Extended Property [dbo].[gscoh_scheme_charge_options_history].[rule_ba_basis_no].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'TBD', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'gscoh_scheme_charge_options_history', @level2type = N'COLUMN', @level2name = N'rule_ba_basis_no';


GO
PRINT N'Creating Extended Property [dbo].[gscoh_scheme_charge_options_history].[gsco_value_type].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'TBD', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'gscoh_scheme_charge_options_history', @level2type = N'COLUMN', @level2name = N'gsco_value_type';


GO
PRINT N'Creating Extended Property [dbo].[gscoh_scheme_charge_options_history].[gsco_value].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'TBD', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'gscoh_scheme_charge_options_history', @level2type = N'COLUMN', @level2name = N'gsco_value';


GO
PRINT N'Creating Extended Property [dbo].[ai_assignee].[ai_date_end_of_assignment].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'The end date of the assignment process. Added in FPS-5898- Cession Details', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'ai_assignee', @level2type = N'COLUMN', @level2name = N'ai_date_end_of_assignment';


GO
PRINT N'Creating Extended Property [dbo].[aih_assignee_history].[ai_date_end_of_assignment].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'The end date of the assignment process. Added in FPS-5898- Cession Details', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'aih_assignee_history', @level2type = N'COLUMN', @level2name = N'ai_date_end_of_assignment';


GO
PRINT N'Creating Extended Property [dbo].[ctd_client_tax_directive].[ctd_active].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'Is tax directive active. More than one active tax directive type can be linked to the same client. However only one can be active at any given time', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'ctd_client_tax_directive', @level2type = N'COLUMN', @level2name = N'ctd_active';


GO
PRINT N'Creating Extended Property [dbo].[ctd_client_tax_directive].[ctd_currency].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'The currency of tax ammount.', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'ctd_client_tax_directive', @level2type = N'COLUMN', @level2name = N'ctd_currency';


GO
PRINT N'Creating Extended Property [dbo].[ctd_client_tax_directive].[ctd_opt].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'Is opted in or out to the tax directive I = OptIn and O = OptOut.', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'ctd_client_tax_directive', @level2type = N'COLUMN', @level2name = N'ctd_opt';


GO
PRINT N'Creating Extended Property [dbo].[ctd_client_tax_directive].[ctd_status_date].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'The Status Date reflects the date that the record was added and any subsequent changes made.', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'ctd_client_tax_directive', @level2type = N'COLUMN', @level2name = N'ctd_status_date';


GO
PRINT N'Creating Extended Property [dbo].[ctdh_client_tax_directive_history].[ctd_active].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'Is tax directive active. More than one active tax directive type can be linked to the same client. However only one can be active at any given time', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'ctdh_client_tax_directive_history', @level2type = N'COLUMN', @level2name = N'ctd_active';


GO
PRINT N'Creating Extended Property [dbo].[ctdh_client_tax_directive_history].[ctd_currency].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'The currency of tax ammount.', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'ctdh_client_tax_directive_history', @level2type = N'COLUMN', @level2name = N'ctd_currency';


GO
PRINT N'Creating Extended Property [dbo].[ctdh_client_tax_directive_history].[ctd_opt].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'Is opted in or out to the tax directive I = OptIn and O = OptOut.', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'ctdh_client_tax_directive_history', @level2type = N'COLUMN', @level2name = N'ctd_opt';


GO
PRINT N'Creating Extended Property [dbo].[ctdh_client_tax_directive_history].[ctd_status_date].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'The Status Date reflects the date that the record was added and any subsequent changes made.', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'ctdh_client_tax_directive_history', @level2type = N'COLUMN', @level2name = N'ctd_status_date';


GO
PRINT N'Creating Extended Property [dbo].[ip_intermediary_policy_rel].[ip_advising_intermediary].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'advising intermediary', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'ip_intermediary_policy_rel', @level2type = N'COLUMN', @level2name = N'ip_advising_intermediary';


GO
PRINT N'Creating Extended Property [dbo].[ip_intermediary_policy_rel].[ip_broker].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'Denotes whether selected intermediary is a broker or not.', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'ip_intermediary_policy_rel', @level2type = N'COLUMN', @level2name = N'ip_broker';


GO
PRINT N'Creating Extended Property [dbo].[ip_intermediary_policy_rel].[ip_jockey].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'jockey', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'ip_intermediary_policy_rel', @level2type = N'COLUMN', @level2name = N'ip_jockey';


GO
PRINT N'Refreshing Function [dbo].[AtSp_NumActualResults_Clients]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[AtSp_NumActualResults_Clients]';


GO
PRINT N'Refreshing Function [dbo].[GI_getPolicyOwnerDetails]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[GI_getPolicyOwnerDetails]';


GO
PRINT N'Refreshing Function [dbo].[GI_getPolicyOwnerNames]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[GI_getPolicyOwnerNames]';


GO
PRINT N'Refreshing Function [dbo].[GI_getPolicyOwners]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[GI_getPolicyOwners]';


GO
PRINT N'Refreshing Function [dbo].[PX_getBackDatedClientDetail]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[PX_getBackDatedClientDetail]';


GO
PRINT N'Refreshing Function [dbo].[AtSp_NumActualResults_Agents]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[AtSp_NumActualResults_Agents]';


GO
PRINT N'Refreshing Procedure [dbo].[DailyReport_PlanExtract]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[DailyReport_PlanExtract]';


GO
PRINT N'Refreshing Procedure [dbo].[Report_ThirdPartyCorrespondence]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[Report_ThirdPartyCorrespondence]';


GO
PRINT N'Refreshing Procedure [dbo].[Correspondence_SP_Address]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[Correspondence_SP_Address]';


GO
PRINT N'Refreshing Procedure [dbo].[Correspondence_SP_Assignment]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[Correspondence_SP_Assignment]';


GO
PRINT N'Refreshing Procedure [dbo].[Correspondence_SP_Client]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[Correspondence_SP_Client]';


GO
PRINT N'Refreshing Procedure [dbo].[Correspondence_SP_ClientRoles]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[Correspondence_SP_ClientRoles]';


GO
PRINT N'Refreshing Procedure [dbo].[RedoPolicyClearDown]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[RedoPolicyClearDown]';


GO
PRINT N'Refreshing Procedure [dbo].[Report_IHT100Report]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[Report_IHT100Report]';


GO
PRINT N'Refreshing Procedure [dbo].[Report_MaturityCorrespondence]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[Report_MaturityCorrespondence]';


GO
PRINT N'Refreshing Procedure [dbo].[Report_PaidUpPoliciesWithValue]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[Report_PaidUpPoliciesWithValue]';


GO
PRINT N'Refreshing Procedure [dbo].[Report_ParagonCorrespondenceReconciliation]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[Report_ParagonCorrespondenceReconciliation]';


GO
PRINT N'Refreshing Procedure [dbo].[Correspondence_SP_Policy]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[Correspondence_SP_Policy]';


GO
PRINT N'Refreshing Procedure [dbo].[CustomEnquiry-TaxFreeCash]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[CustomEnquiry-TaxFreeCash]';


GO
PRINT N'Refreshing Procedure [dbo].[DailyDelta_STG_Client]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[DailyDelta_STG_Client]';


GO
PRINT N'Refreshing Procedure [dbo].[DailyDelta_STG_Client_Plan]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[DailyDelta_STG_Client_Plan]';


GO
PRINT N'Refreshing Procedure [dbo].[FATCA_Annual_Submission_Report]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[FATCA_Annual_Submission_Report]';


GO
PRINT N'Refreshing Procedure [dbo].[Report_PolicyReview]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[Report_PolicyReview]';


GO
PRINT N'Refreshing Procedure [dbo].[GW_Age_Of_Member]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[GW_Age_Of_Member]';


GO
PRINT N'Refreshing Procedure [dbo].[GW_Sex_Of_Member]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[GW_Sex_Of_Member]';


GO
PRINT N'Refreshing Procedure [dbo].[Report_Reassurance]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[Report_Reassurance]';


GO
PRINT N'Refreshing Procedure [dbo].[Report_TPPRenewabilityPlans]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[Report_TPPRenewabilityPlans]';


GO
PRINT N'Refreshing Procedure [dbo].[PAS_PolicyLifes]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[PAS_PolicyLifes]';


GO
PRINT N'Refreshing Procedure [dbo].[PAS_PolicyRisks]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[PAS_PolicyRisks]';


GO
PRINT N'Refreshing Procedure [dbo].[SkandiaProtectNBAndEBQDeployment_1_14_3_0_Common]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[SkandiaProtectNBAndEBQDeployment_1_14_3_0_Common]';


GO
PRINT N'Refreshing Procedure [dbo].[PolEnq_ClaimEnquiry]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[PolEnq_ClaimEnquiry]';


GO
PRINT N'Refreshing Procedure [dbo].[PolEnq_PoliciesLinkedToSimplyBiz]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[PolEnq_PoliciesLinkedToSimplyBiz]';


GO
PRINT N'Refreshing Procedure [dbo].[PolReview_Claim]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[PolReview_Claim]';


GO
PRINT N'Refreshing Procedure [dbo].[PolEnq_AdditionalEnquiry]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[PolEnq_AdditionalEnquiry]';


GO
PRINT N'Refreshing Procedure [dbo].[PX_DrawdownIllustration_1_1_Common]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[PX_DrawdownIllustration_1_1_Common]';


GO
PRINT N'Refreshing Procedure [dbo].[PX_PensionIllustrations_Common3]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[PX_PensionIllustrations_Common3]';


GO
PRINT N'Refreshing Procedure [dbo].[PX_PPPCAPIllustration_2_4_ChgEBQSMPI]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[PX_PPPCAPIllustration_2_4_ChgEBQSMPI]';


GO
PRINT N'Refreshing Procedure [dbo].[PX_PPPCAPIllustration_2_4_NoChgEBQ]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[PX_PPPCAPIllustration_2_4_NoChgEBQ]';


GO
PRINT N'Refreshing Procedure [dbo].[PX_ProtectionPRVDeployment_0_0_0_1_Common]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[PX_ProtectionPRVDeployment_0_0_0_1_Common]';


GO
PRINT N'Refreshing Procedure [dbo].[PX_SterlingDebtIllustrations_2_15_1_0_Common]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[PX_SterlingDebtIllustrations_2_15_1_0_Common]';


GO
PRINT N'Refreshing Procedure [dbo].[Report_Advisor_Commission]...';


GO
SET ANSI_NULLS, QUOTED_IDENTIFIER OFF;


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[Report_Advisor_Commission]';


GO
SET ANSI_NULLS, QUOTED_IDENTIFIER ON;


GO
PRINT N'Refreshing Procedure [dbo].[Report_BrokerValuation]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[Report_BrokerValuation]';


GO
PRINT N'Refreshing Procedure [dbo].[AgentPortfolioReport]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[AgentPortfolioReport]';


GO
PRINT N'Refreshing Procedure [dbo].[Report_Contract_Hedging_UK_Stat]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[Report_Contract_Hedging_UK_Stat]';


GO
PRINT N'Refreshing Procedure [dbo].[Report_Contract_UK_Stat]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[Report_Contract_UK_Stat]';


GO
PRINT N'Refreshing Procedure [dbo].[Report_Contract_UK_Stat_Exclusions]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[Report_Contract_UK_Stat_Exclusions]';


GO
PRINT N'Refreshing Procedure [dbo].[Report_Contract_UK_Stat_NotInForce]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[Report_Contract_UK_Stat_NotInForce]';


GO
PRINT N'Refreshing Procedure [dbo].[AdHocEventReport22]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[AdHocEventReport22]';


GO
PRINT N'Refreshing Procedure [dbo].[AdHocEventReport23]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[AdHocEventReport23]';


GO
PRINT N'Refreshing Procedure [dbo].[BulkAnnualStatement]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[BulkAnnualStatement]';


GO
PRINT N'Refreshing Procedure [dbo].[Correspondence_SP_Account]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[Correspondence_SP_Account]';


GO
PRINT N'Refreshing Procedure [dbo].[Correspondence_SP_Client_ByClientId]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[Correspondence_SP_Client_ByClientId]';


GO
PRINT N'Refreshing Procedure [dbo].[CustomEnquiry-BulkTransferTrailCommission]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[CustomEnquiry-BulkTransferTrailCommission]';


GO
PRINT N'Refreshing Procedure [dbo].[FATCA_Annual_Threshold_Report]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[FATCA_Annual_Threshold_Report]';


GO
PRINT N'Refreshing Procedure [dbo].[GW_Age_Bands]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[GW_Age_Bands]';


GO
PRINT N'Refreshing Procedure [dbo].[NominatedGADReviewReport]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[NominatedGADReviewReport]';


GO
PRINT N'Refreshing Procedure [dbo].[PolEnq_ClaimsAwaitingPaymentAuthorisation]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[PolEnq_ClaimsAwaitingPaymentAuthorisation]';


GO
PRINT N'Refreshing Procedure [dbo].[PolEnq_CompleteClaims]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[PolEnq_CompleteClaims]';


GO
PRINT N'Refreshing Procedure [dbo].[PolEnq_PoliciesLinkedToAFund]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[PolEnq_PoliciesLinkedToAFund]';


GO
PRINT N'Refreshing Procedure [dbo].[PolEnq_PoliciesWithRegularTargeted Withdrawals]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[PolEnq_PoliciesWithRegularTargeted Withdrawals]';


GO
PRINT N'Refreshing Procedure [dbo].[Report_BOPRequirements]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[Report_BOPRequirements]';


GO
PRINT N'Refreshing Procedure [dbo].[Report_Bulk_Claim_Report]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[Report_Bulk_Claim_Report]';


GO
PRINT N'Refreshing Procedure [dbo].[Report_ChargeableEvents]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[Report_ChargeableEvents]';


GO
PRINT N'Refreshing Procedure [dbo].[Report_CorrespondencePrintSuppression]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[Report_CorrespondencePrintSuppression]';


GO
PRINT N'Refreshing Procedure [dbo].[Report_FATCA_CRS_Annual_Report]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[Report_FATCA_CRS_Annual_Report]';


GO
PRINT N'Refreshing Procedure [dbo].[Report_MRLO]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[Report_MRLO]';


GO
PRINT N'Refreshing Procedure [dbo].[Report_NominatedGADReviewReport]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[Report_NominatedGADReviewReport]';


GO
PRINT N'Refreshing Procedure [dbo].[Report_PendingDeath]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[Report_PendingDeath]';


GO
PRINT N'Refreshing Procedure [dbo].[Report_PolicyRestrictionsReport]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[Report_PolicyRestrictionsReport]';


GO
PRINT N'Refreshing Procedure [dbo].[Report_PreAge75LTA]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[Report_PreAge75LTA]';


GO
PRINT N'Refreshing Procedure [dbo].[Report_PreSwitch]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[Report_PreSwitch]';


GO
PRINT N'Refreshing Procedure [dbo].[Report_SKY_Billing]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[Report_SKY_Billing]';


GO
PRINT N'Refreshing Procedure [dbo].[Report_UnauthorisedTransactionReport]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[Report_UnauthorisedTransactionReport]';


GO
PRINT N'Refreshing Procedure [dbo].[PAS_Review]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[PAS_Review]';


GO
PRINT N'Refreshing Procedure [dbo].[PAS_RiskCharging]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[PAS_RiskCharging]';


GO
PRINT N'Refreshing Procedure [dbo].[SkandiaProtectNBAndEBQDeployment_1_14_3_0]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[SkandiaProtectNBAndEBQDeployment_1_14_3_0]';


GO
PRINT N'Refreshing Procedure [dbo].[SkandiaProtectNBAndEBQDeployment_1_14_3_0_NWB]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[SkandiaProtectNBAndEBQDeployment_1_14_3_0_NWB]';


GO
PRINT N'Refreshing Procedure [dbo].[PX_DrawdownIllustration_1_1_ChangeAndNoChangeEBQ]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[PX_DrawdownIllustration_1_1_ChangeAndNoChangeEBQ]';


GO
PRINT N'Refreshing Procedure [dbo].[PensionSeries6Illustrations_0_15_3_0]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[PensionSeries6Illustrations_0_15_3_0]';


GO
PRINT N'Refreshing Procedure [dbo].[PensionPLACIllustrations_0_4_1_0]...';


GO
SET ANSI_NULLS ON;

SET QUOTED_IDENTIFIER OFF;


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[PensionPLACIllustrations_0_4_1_0]';


GO
SET ANSI_NULLS, QUOTED_IDENTIFIER ON;


GO
PRINT N'Refreshing Procedure [dbo].[ProtectionPRVDeployment_0_0_0_1_ChgEBQ]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[ProtectionPRVDeployment_0_0_0_1_ChgEBQ]';


GO
PRINT N'Refreshing Procedure [dbo].[SterlingDebtIllustrations_2_15_1_0_ChgEBQANNPROC]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[SterlingDebtIllustrations_2_15_1_0_ChgEBQANNPROC]';


GO
PRINT N'Refreshing Procedure [dbo].[SterlingDebtIllustrations_2_15_1_0_NoChgEBQ]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[SterlingDebtIllustrations_2_15_1_0_NoChgEBQ]';


GO
PRINT N'Refreshing Procedure [dbo].[DailyDelta_STG_Partner_Plan]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[DailyDelta_STG_Partner_Plan]';


GO
PRINT N'Refreshing Procedure [dbo].[PolEnq_AgencyTransfer]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[PolEnq_AgencyTransfer]';


GO
PRINT N'Refreshing Procedure [dbo].[Report_DocsLog]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[Report_DocsLog]';


GO
PRINT N'Refreshing Procedure [dbo].[Correspondence_SP_Correspondence]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[Correspondence_SP_Correspondence]';


GO
PRINT N'Refreshing Procedure [dbo].[Reports_DealingExceptionReport]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[Reports_DealingExceptionReport]';


GO
PRINT N'Refreshing Procedure [dbo].[GW108A_Total_Contribution_Percent_Breakdown]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[GW108A_Total_Contribution_Percent_Breakdown]';


GO
PRINT N'Refreshing Procedure [dbo].[GW96A_Member_Contribution_Percent_Breakdown]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[GW96A_Member_Contribution_Percent_Breakdown]';


GO
PRINT N'Refreshing Procedure [dbo].[GW97A_Employer_Contribution_Percent_Breakdown]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[GW97A_Employer_Contribution_Percent_Breakdown]';


GO
PRINT N'Refreshing Procedure [dbo].[GW_94A_Age_Of_Member_Breakdown]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[GW_94A_Age_Of_Member_Breakdown]';


GO
PRINT N'Refreshing Procedure [dbo].[GW_95A_Member_Inv_Breakdown]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[GW_95A_Member_Inv_Breakdown]';


GO
-- This file was auto Generated by run Generate Post Deploy.bat 

DECLARE @mergeError int 
DECLARE @mergeCount int 
DECLARE @Today 				VARCHAR(8) 
DECLARE @Time 				VARCHAR(6) 
DECLARE @UserId 			VARCHAR(8) 
DECLARE @Status				CHAR(1) 
DECLARE @ProdNumber INT 
DECLARE @SQL NVARCHAR(MAX) 
DECLARE @RulesDB NVARCHAR(MAX) 
DECLARE @ParmDefinition nvarchar(500); 
 
print 'Include Synonyms + Standing Data From Base DB' 

 -- Include Synonyms
EXEC [ADD_NEW_SYNONYM] 'Docs', 'da_document_applies';
EXEC [ADD_NEW_SYNONYM] 'Delta', 'Delta_Trigger_Log';
EXEC [ADD_NEW_SYNONYM] 'Docs', 'do_document';
EXEC [ADD_NEW_SYNONYM] 'Docs', 'dr_document_request';
EXEC [ADD_NEW_SYNONYM] 'Docs', 'rp_request_parms';
EXEC [ADD_NEW_SYNONYM] 'Rules', 'rule_ak_actuarial_lookup';
EXEC [ADD_NEW_SYNONYM] 'Rules', 'rule_as_systemattributes';
EXEC [ADD_NEW_SYNONYM] 'Rules', 'rule_at_productattributes';
EXEC [ADD_NEW_SYNONYM] 'Rules', 'rule_baa_basis_allocation';
EXEC [ADD_NEW_SYNONYM] 'Rules', 'rule_bac_basis_charges';
EXEC [ADD_NEW_SYNONYM] 'Rules', 'rule_bag_basis_generic';
EXEC [ADD_NEW_SYNONYM] 'Rules', 'rule_cq_custom_queries';
EXEC [ADD_NEW_SYNONYM] 'Rules', 'rule_em_mapping';
EXEC [ADD_NEW_SYNONYM] 'Rules', 'rule_fu_fund';
EXEC [ADD_NEW_SYNONYM] 'Rules', 'rule_fx_fund_extra';

EXEC [ADD_NEW_SYNONYM] 'Rules', 'rule_ld_lookupdescription';

EXEC [ADD_NEW_SYNONYM] 'Rules', 'rule_lu_lookup';
EXEC [ADD_NEW_SYNONYM] 'Rules', 'rule_pa_productattributerel';
EXEC [ADD_NEW_SYNONYM] 'Rules', 'rule_pg_product_configuration';
EXEC [ADD_NEW_SYNONYM] 'Rules', 'rule_pk_package_definition';
EXEC [ADD_NEW_SYNONYM] 'Rules', 'rule_pm_premium';
EXEC [ADD_NEW_SYNONYM] 'Rules', 'rule_pp_premiumapplies';
EXEC [ADD_NEW_SYNONYM] 'Rules', 'rule_pr_product';
EXEC [ADD_NEW_SYNONYM] 'Rules', 'rule_ra_riskapplies';
EXEC [ADD_NEW_SYNONYM] 'Rules', 'rule_re_retention_rates';
EXEC [ADD_NEW_SYNONYM] 'Rules', 'rule_rs_risk';
EXEC [ADD_NEW_SYNONYM] 'Rules', 'rule_sg_selection_grouping';
EXEC [ADD_NEW_SYNONYM] 'Rules', 'rule_stg_selection_table_generic';
EXEC [ADD_NEW_SYNONYM] 'Rules', 'rule_lb_leadtimebilling';




EXEC [ADD_NEW_SYNONYM] 'Docs', 'ta_template_applies';
EXEC [ADD_NEW_SYNONYM] 'Docs', 'tm_template';
EXEC [ADD_NEW_SYNONYM] 'Delta', 'STG_Commission_History';
EXEC [ADD_NEW_SYNONYM] 'Delta', 'STG_Policy_General';
EXEC [ADD_NEW_SYNONYM] 'Delta', 'STG_Policy_Restrictions';
EXEC [ADD_NEW_SYNONYM] 'Delta', 'STG_Risk';
EXEC [ADD_NEW_SYNONYM] 'Rules', 'rule_ts_TransactionScheduling';
EXEC [ADD_NEW_SYNONYM] 'Rules', 'rule_cgr_claim_group_rel';
EXEC [ADD_NEW_SYNONYM] 'Rules', 'rule_co_claim_component';
EXEC [ADD_NEW_SYNONYM] 'Rules', 'rule_ba_band';
EXEC [ADD_NEW_SYNONYM] 'Rules', 'rule_bt_band_table';
EXEC [ADD_NEW_SYNONYM] 'Rules', 'rule_stg_selection_table_generic';
EXEC [ADD_NEW_SYNONYM] 'Rules', 'rule_bag_basis_generic';
EXEC [ADD_NEW_SYNONYM] 'PDM', '__PDM_Life400_log';
EXEC [ADD_NEW_SYNONYM] 'Rules', 'rule_pd_productdistribution';
EXEC [ADD_NEW_SYNONYM] 'Rules', 'rule_stc_selection_table_charges';

 Print 'Updating System Control Version (Base)'
DECLARE @Version AS VARCHAR(10) = '20.4.0'

UPDATE [sc_system_control]
SET [sc_version_number]		= @Version,	
	[sc_last_updt_date]		= CONVERT(CHAR(8),GETDATE(),112), 
	[sc_last_updt_time]		= RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),
	[sc_last_updt_userid]	= 'DACPAC'



 Print 'Inserting PSSL entries (Base)'
--MG: Clear down this file when the release has been released to Production

--EXAMPLE:
--EXEC Add_PSSL_Log_Entry 'Detail of the Change', 'A Reference eg ALM1234', 'A Note eg Table/SP updated XXXX', @Version

--@Version is set in "UpdateVersion.sql"



 


-- Include Standing Data
-- EG: :r ..\Standing Data\ScriptName.sql
 

 
-- disable all constraints 
EXEC sp_MSForEachTable "ALTER TABLE ? NOCHECK CONSTRAINT all" 
 
 
-- Dat Files 
 
 
-- Scripts 
 
PRINT 'Include ac_account.sql' 
MERGE INTO [ac_account] AS [Target]
USING (VALUES
  (1,N'CSH',N'1232256389',N'1234',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'Van',N'20130101',N'I',N'ZAR AutoCash',N'',N'ZAR',N'0001',N'B',N'',N'',N'ZA',100000,1,0,N'Y',N'',0,N'',N'',N'',N'10000101',N'',0,N'',N'',N'',N'',N'',N'',N'',N'',N'',N'',N'',N'',-1,-1,0,'10000101',N'',N'',N'',N'')
 ,(1,N'CHQ',N'234567891',N'1234',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'Van',N'20130101',N'I',N'Rand A/C',N'',N'ZAR',N'0001',N'',N'',N'',N'ZA',100001,1,0,N'Y',N'',0,N'',N'',N'',N'10000101',N'',0,N'',N'',N'',N'',N'',N'',N'',N'',N'',N'',N'',N'',-1,-1,0,'10000101',N'',N'',N'',N'')
 ,(1,N'OIN',N'99999999',N'1234',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'Van',N'20130101',N'I',N'xxx xxx xxx x/x',N'',N'ZAR',N'9999',N'N',N'',N'',N'ZA',100002,1,0,N'Y',N'',0,N'',N'',N'',N'10000101',N'',0,N'',N'',N'',N'',N'',N'',N'',N'',N'',N'',N'',N'',-1,-1,0,'10000101',N'',N'',N'',N'')
 ,(0,N'EFT',N'12345678',N'632005',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'Van',N'20221019',N'I',N'xxxxxxxxxxxTest',N'',N'ZAR',N'',N'',N'',N'',N'UK',100004,1,1000000010,N'N',N'',0,N'ABSA',N'VISA',N'',N'20240101',N'',0,N'',N'',N'',N'',N'',N'',N'',N'',N'',N'SBA',N'',N'',1,-1,1,'10000101',N'CHQ',N'M',N'ReasonTest',N'alfman')
 ,(0,N'EFT',N'12345678',N'470010',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'Van',N'20221019',N'I',N'xxxxxxxx06Test',N'',N'ZAR',N'',N'',N'',N'',N'UK',100005,1,1000000006,N'N',N'',0,N'Capitec',N'VISA',N'',N'20240101',N'',0,N'',N'',N'',N'',N'',N'',N'',N'',N'',N'SBA',N'',N'',2,-1,2,'10000101',N'SAV',N'M',N'TestReason',N'alfman')
) AS [Source] ([ac_company_id],[ac_account_type],[ac_account_number],[bk_sort_code],[ac_create_date],[ac_last_updt_date],[ac_last_updt_time],[ac_last_updt_userid],[ac_business_date],[ac_record_status],[ac_account_description],[ac_sia_code],[ac_account_currency],[ac_bank_sun_code],[ac_autocash_enabled],[ac_iban],[ac_swift_code],[ac_country_code],[ac_account_id],[ac_version_number],[ct_client_id],[ac_approved],[pi_dc_method],[ac_last_payment_num],[ac_bank_name],[bl_credit_card_type],[bl_credit_card_verification_no],[bl_credit_card_expiry_date],[bl_account_no_check_digit],[ac_correspondent_account_id],[ac_dm_reference],[ac_bank_address1],[ac_bank_address2],[ac_bank_address3],[ac_bank_address4],[ac_bank_address5],[ac_bank_postcode],[ac_OIN],[ac_oin_description],[ac_account_source],[ac_bs_roll_number],[ac_account_external_ref],[sl_system_log_id],[po_transaction_id],[rule_bk_bank_id],[ac_approved_date],[ac_bank_account_type],[ac_account_approved_type],[ac_account_approved_status_text],[ac_account_approved_userid])
ON ([Target].[ac_account_id] = [Source].[ac_account_id] AND [Target].[ac_version_number] = [Source].[ac_version_number])
WHEN MATCHED AND (
	NULLIF([Source].[ac_company_id], [Target].[ac_company_id]) IS NOT NULL OR NULLIF([Target].[ac_company_id], [Source].[ac_company_id]) IS NOT NULL OR 
	NULLIF([Source].[ac_account_type], [Target].[ac_account_type]) IS NOT NULL OR NULLIF([Target].[ac_account_type], [Source].[ac_account_type]) IS NOT NULL OR 
	NULLIF([Source].[ac_account_number], [Target].[ac_account_number]) IS NOT NULL OR NULLIF([Target].[ac_account_number], [Source].[ac_account_number]) IS NOT NULL OR 
	NULLIF([Source].[bk_sort_code], [Target].[bk_sort_code]) IS NOT NULL OR NULLIF([Target].[bk_sort_code], [Source].[bk_sort_code]) IS NOT NULL OR 
	NULLIF([Source].[ac_last_updt_userid], [Target].[ac_last_updt_userid]) IS NOT NULL OR NULLIF([Target].[ac_last_updt_userid], [Source].[ac_last_updt_userid]) IS NOT NULL OR 
	NULLIF([Source].[ac_business_date], [Target].[ac_business_date]) IS NOT NULL OR NULLIF([Target].[ac_business_date], [Source].[ac_business_date]) IS NOT NULL OR 
	NULLIF([Source].[ac_record_status], [Target].[ac_record_status]) IS NOT NULL OR NULLIF([Target].[ac_record_status], [Source].[ac_record_status]) IS NOT NULL OR 
	NULLIF([Source].[ac_account_description], [Target].[ac_account_description]) IS NOT NULL OR NULLIF([Target].[ac_account_description], [Source].[ac_account_description]) IS NOT NULL OR 
	NULLIF([Source].[ac_sia_code], [Target].[ac_sia_code]) IS NOT NULL OR NULLIF([Target].[ac_sia_code], [Source].[ac_sia_code]) IS NOT NULL OR 
	NULLIF([Source].[ac_account_currency], [Target].[ac_account_currency]) IS NOT NULL OR NULLIF([Target].[ac_account_currency], [Source].[ac_account_currency]) IS NOT NULL OR 
	NULLIF([Source].[ac_bank_sun_code], [Target].[ac_bank_sun_code]) IS NOT NULL OR NULLIF([Target].[ac_bank_sun_code], [Source].[ac_bank_sun_code]) IS NOT NULL OR 
	NULLIF([Source].[ac_autocash_enabled], [Target].[ac_autocash_enabled]) IS NOT NULL OR NULLIF([Target].[ac_autocash_enabled], [Source].[ac_autocash_enabled]) IS NOT NULL OR 
	NULLIF([Source].[ac_iban], [Target].[ac_iban]) IS NOT NULL OR NULLIF([Target].[ac_iban], [Source].[ac_iban]) IS NOT NULL OR 
	NULLIF([Source].[ac_swift_code], [Target].[ac_swift_code]) IS NOT NULL OR NULLIF([Target].[ac_swift_code], [Source].[ac_swift_code]) IS NOT NULL OR 
	NULLIF([Source].[ac_country_code], [Target].[ac_country_code]) IS NOT NULL OR NULLIF([Target].[ac_country_code], [Source].[ac_country_code]) IS NOT NULL OR 
	NULLIF([Source].[ct_client_id], [Target].[ct_client_id]) IS NOT NULL OR NULLIF([Target].[ct_client_id], [Source].[ct_client_id]) IS NOT NULL OR 
	NULLIF([Source].[ac_approved], [Target].[ac_approved]) IS NOT NULL OR NULLIF([Target].[ac_approved], [Source].[ac_approved]) IS NOT NULL OR 
	NULLIF([Source].[pi_dc_method], [Target].[pi_dc_method]) IS NOT NULL OR NULLIF([Target].[pi_dc_method], [Source].[pi_dc_method]) IS NOT NULL OR 
	NULLIF([Source].[ac_last_payment_num], [Target].[ac_last_payment_num]) IS NOT NULL OR NULLIF([Target].[ac_last_payment_num], [Source].[ac_last_payment_num]) IS NOT NULL OR 
	NULLIF([Source].[ac_bank_name], [Target].[ac_bank_name]) IS NOT NULL OR NULLIF([Target].[ac_bank_name], [Source].[ac_bank_name]) IS NOT NULL OR 
	NULLIF([Source].[bl_credit_card_type], [Target].[bl_credit_card_type]) IS NOT NULL OR NULLIF([Target].[bl_credit_card_type], [Source].[bl_credit_card_type]) IS NOT NULL OR 
	NULLIF([Source].[bl_credit_card_verification_no], [Target].[bl_credit_card_verification_no]) IS NOT NULL OR NULLIF([Target].[bl_credit_card_verification_no], [Source].[bl_credit_card_verification_no]) IS NOT NULL OR 
	NULLIF([Source].[bl_credit_card_expiry_date], [Target].[bl_credit_card_expiry_date]) IS NOT NULL OR NULLIF([Target].[bl_credit_card_expiry_date], [Source].[bl_credit_card_expiry_date]) IS NOT NULL OR 
	NULLIF([Source].[bl_account_no_check_digit], [Target].[bl_account_no_check_digit]) IS NOT NULL OR NULLIF([Target].[bl_account_no_check_digit], [Source].[bl_account_no_check_digit]) IS NOT NULL OR 
	NULLIF([Source].[ac_correspondent_account_id], [Target].[ac_correspondent_account_id]) IS NOT NULL OR NULLIF([Target].[ac_correspondent_account_id], [Source].[ac_correspondent_account_id]) IS NOT NULL OR 
	NULLIF([Source].[ac_dm_reference], [Target].[ac_dm_reference]) IS NOT NULL OR NULLIF([Target].[ac_dm_reference], [Source].[ac_dm_reference]) IS NOT NULL OR 
	NULLIF([Source].[ac_bank_address1], [Target].[ac_bank_address1]) IS NOT NULL OR NULLIF([Target].[ac_bank_address1], [Source].[ac_bank_address1]) IS NOT NULL OR 
	NULLIF([Source].[ac_bank_address2], [Target].[ac_bank_address2]) IS NOT NULL OR NULLIF([Target].[ac_bank_address2], [Source].[ac_bank_address2]) IS NOT NULL OR 
	NULLIF([Source].[ac_bank_address3], [Target].[ac_bank_address3]) IS NOT NULL OR NULLIF([Target].[ac_bank_address3], [Source].[ac_bank_address3]) IS NOT NULL OR 
	NULLIF([Source].[ac_bank_address4], [Target].[ac_bank_address4]) IS NOT NULL OR NULLIF([Target].[ac_bank_address4], [Source].[ac_bank_address4]) IS NOT NULL OR 
	NULLIF([Source].[ac_bank_address5], [Target].[ac_bank_address5]) IS NOT NULL OR NULLIF([Target].[ac_bank_address5], [Source].[ac_bank_address5]) IS NOT NULL OR 
	NULLIF([Source].[ac_bank_postcode], [Target].[ac_bank_postcode]) IS NOT NULL OR NULLIF([Target].[ac_bank_postcode], [Source].[ac_bank_postcode]) IS NOT NULL OR 
	NULLIF([Source].[ac_OIN], [Target].[ac_OIN]) IS NOT NULL OR NULLIF([Target].[ac_OIN], [Source].[ac_OIN]) IS NOT NULL OR 
	NULLIF([Source].[ac_oin_description], [Target].[ac_oin_description]) IS NOT NULL OR NULLIF([Target].[ac_oin_description], [Source].[ac_oin_description]) IS NOT NULL OR 
	NULLIF([Source].[ac_account_source], [Target].[ac_account_source]) IS NOT NULL OR NULLIF([Target].[ac_account_source], [Source].[ac_account_source]) IS NOT NULL OR 
	NULLIF([Source].[ac_bs_roll_number], [Target].[ac_bs_roll_number]) IS NOT NULL OR NULLIF([Target].[ac_bs_roll_number], [Source].[ac_bs_roll_number]) IS NOT NULL OR 
	NULLIF([Source].[ac_account_external_ref], [Target].[ac_account_external_ref]) IS NOT NULL OR NULLIF([Target].[ac_account_external_ref], [Source].[ac_account_external_ref]) IS NOT NULL OR 
	NULLIF([Source].[sl_system_log_id], [Target].[sl_system_log_id]) IS NOT NULL OR NULLIF([Target].[sl_system_log_id], [Source].[sl_system_log_id]) IS NOT NULL OR 
	NULLIF([Source].[po_transaction_id], [Target].[po_transaction_id]) IS NOT NULL OR NULLIF([Target].[po_transaction_id], [Source].[po_transaction_id]) IS NOT NULL OR
	NULLIF([Source].[rule_bk_bank_id], [Target].[rule_bk_bank_id]) IS NOT NULL OR NULLIF([Target].[rule_bk_bank_id], [Source].[rule_bk_bank_id]) IS NOT NULL OR
	NULLIF([Source].[ac_approved_date], [Target].[ac_approved_date]) IS NOT NULL OR NULLIF([Target].[ac_approved_date], [Source].[ac_approved_date]) IS NOT NULL OR
	NULLIF([Source].[ac_bank_account_type], [Target].[ac_bank_account_type]) IS NOT NULL OR NULLIF([Target].[ac_bank_account_type], [Source].[ac_bank_account_type]) IS NOT NULL OR
	NULLIF([Source].[ac_account_approved_type], [Target].[ac_account_approved_type]) IS NOT NULL OR NULLIF([Target].[ac_account_approved_type], [Source].[ac_account_approved_type]) IS NOT NULL OR
	NULLIF([Source].[ac_account_approved_status_text], [Target].[ac_account_approved_status_text]) IS NOT NULL OR NULLIF([Target].[ac_account_approved_status_text], [Source].[ac_account_approved_status_text]) IS NOT NULL OR
	NULLIF([Source].[ac_account_approved_userid], [Target].[ac_account_approved_userid]) IS NOT NULL OR NULLIF([Target].[ac_account_approved_userid], [Source].[ac_account_approved_userid]) IS NOT NULL) THEN
 UPDATE SET
  [Target].[ac_company_id] = [Source].[ac_company_id], 
  [Target].[ac_account_type] = [Source].[ac_account_type], 
  [Target].[ac_account_number] = [Source].[ac_account_number], 
  [Target].[bk_sort_code] = [Source].[bk_sort_code], 
  [Target].[ac_last_updt_date] = [Source].[ac_last_updt_date], 
  [Target].[ac_last_updt_time] = [Source].[ac_last_updt_time], 
  [Target].[ac_last_updt_userid] = [Source].[ac_last_updt_userid], 
  [Target].[ac_business_date] = [Source].[ac_business_date], 
  [Target].[ac_record_status] = [Source].[ac_record_status], 
  [Target].[ac_account_description] = [Source].[ac_account_description], 
  [Target].[ac_sia_code] = [Source].[ac_sia_code], 
  [Target].[ac_account_currency] = [Source].[ac_account_currency], 
  [Target].[ac_bank_sun_code] = [Source].[ac_bank_sun_code], 
  [Target].[ac_autocash_enabled] = [Source].[ac_autocash_enabled], 
  [Target].[ac_iban] = [Source].[ac_iban], 
  [Target].[ac_swift_code] = [Source].[ac_swift_code], 
  [Target].[ac_country_code] = [Source].[ac_country_code], 
  [Target].[ct_client_id] = [Source].[ct_client_id], 
  [Target].[ac_approved] = [Source].[ac_approved], 
  [Target].[pi_dc_method] = [Source].[pi_dc_method], 
  [Target].[ac_last_payment_num] = [Source].[ac_last_payment_num], 
  [Target].[ac_bank_name] = [Source].[ac_bank_name], 
  [Target].[bl_credit_card_type] = [Source].[bl_credit_card_type], 
  [Target].[bl_credit_card_verification_no] = [Source].[bl_credit_card_verification_no], 
  [Target].[bl_credit_card_expiry_date] = [Source].[bl_credit_card_expiry_date], 
  [Target].[bl_account_no_check_digit] = [Source].[bl_account_no_check_digit], 
  [Target].[ac_correspondent_account_id] = [Source].[ac_correspondent_account_id], 
  [Target].[ac_dm_reference] = [Source].[ac_dm_reference], 
  [Target].[ac_bank_address1] = [Source].[ac_bank_address1], 
  [Target].[ac_bank_address2] = [Source].[ac_bank_address2], 
  [Target].[ac_bank_address3] = [Source].[ac_bank_address3], 
  [Target].[ac_bank_address4] = [Source].[ac_bank_address4], 
  [Target].[ac_bank_address5] = [Source].[ac_bank_address5], 
  [Target].[ac_bank_postcode] = [Source].[ac_bank_postcode], 
  [Target].[ac_OIN] = [Source].[ac_OIN], 
  [Target].[ac_oin_description] = [Source].[ac_oin_description], 
  [Target].[ac_account_source] = [Source].[ac_account_source], 
  [Target].[ac_bs_roll_number] = [Source].[ac_bs_roll_number], 
  [Target].[ac_account_external_ref] = [Source].[ac_account_external_ref], 
  [Target].[sl_system_log_id] = [Source].[sl_system_log_id], 
  [Target].[po_transaction_id] = [Source].[po_transaction_id],
  [Target].[rule_bk_bank_id] = [Source].[rule_bk_bank_id],
  [Target].[ac_approved_date] = [Source].[ac_approved_date],
  [Target].[ac_bank_account_type] = [Source].[ac_bank_account_type],
  [Target].[ac_account_approved_type] = [Source].[ac_account_approved_type],
  [Target].[ac_account_approved_status_text] = [Source].[ac_account_approved_status_text],
  [Target].[ac_account_approved_userid] = [Source].[ac_account_approved_userid]
WHEN NOT MATCHED BY TARGET THEN
 INSERT([ac_company_id],[ac_account_type],[ac_account_number],[bk_sort_code],[ac_create_date],[ac_last_updt_date],[ac_last_updt_time],[ac_last_updt_userid],[ac_business_date],[ac_record_status],[ac_account_description],[ac_sia_code],[ac_account_currency],[ac_bank_sun_code],[ac_autocash_enabled],[ac_iban],[ac_swift_code],[ac_country_code],[ac_account_id],[ac_version_number],[ct_client_id],[ac_approved],[pi_dc_method],[ac_last_payment_num],[ac_bank_name],[bl_credit_card_type],[bl_credit_card_verification_no],[bl_credit_card_expiry_date],[bl_account_no_check_digit],[ac_correspondent_account_id],[ac_dm_reference],[ac_bank_address1],[ac_bank_address2],[ac_bank_address3],[ac_bank_address4],[ac_bank_address5],[ac_bank_postcode],[ac_OIN],[ac_oin_description],[ac_account_source],[ac_bs_roll_number],[ac_account_external_ref],[sl_system_log_id],[po_transaction_id],[rule_bk_bank_id],[ac_approved_date],[ac_bank_account_type],[ac_account_approved_type],[ac_account_approved_status_text],[ac_account_approved_userid])
 VALUES([Source].[ac_company_id],[Source].[ac_account_type],[Source].[ac_account_number],[Source].[bk_sort_code],[Source].[ac_create_date],[Source].[ac_last_updt_date],[Source].[ac_last_updt_time],[Source].[ac_last_updt_userid],[Source].[ac_business_date],[Source].[ac_record_status],[Source].[ac_account_description],[Source].[ac_sia_code],[Source].[ac_account_currency],[Source].[ac_bank_sun_code],[Source].[ac_autocash_enabled],[Source].[ac_iban],[Source].[ac_swift_code],[Source].[ac_country_code],[Source].[ac_account_id],[Source].[ac_version_number],[Source].[ct_client_id],[Source].[ac_approved],[Source].[pi_dc_method],[Source].[ac_last_payment_num],[Source].[ac_bank_name],[Source].[bl_credit_card_type],[Source].[bl_credit_card_verification_no],[Source].[bl_credit_card_expiry_date],[Source].[bl_account_no_check_digit],[Source].[ac_correspondent_account_id],[Source].[ac_dm_reference],[Source].[ac_bank_address1],[Source].[ac_bank_address2],[Source].[ac_bank_address3],[Source].[ac_bank_address4],[Source].[ac_bank_address5],[Source].[ac_bank_postcode],[Source].[ac_OIN],[Source].[ac_oin_description],[Source].[ac_account_source],[Source].[ac_bs_roll_number],[Source].[ac_account_external_ref],[Source].[sl_system_log_id],[Source].[po_transaction_id],[Source].[rule_bk_bank_id],[Source].[ac_approved_date],[Source].[ac_bank_account_type],[Source].[ac_account_approved_type],[Source].[ac_account_approved_status_text],[Source].[ac_account_approved_userid]);
 
IF @mergeError != 0 
BEGIN 
PRINT 'ERROR OCCURRED IN MERGE FOR ac_account.sql. Rows affected: ' + CAST(@mergeCount AS VARCHAR(100)); -- SQL should always return zero rows affected 
END 
ELSE IF @mergeCount > 0 
BEGIN 
PRINT 'ac_account.sql rows affected by MERGE: ' + CAST(@mergeCount AS VARCHAR(100)); 
END 
 
PRINT 'Include ad_address.sql' 
MERGE INTO [ad_address] AS [Target]
USING (VALUES
  (1,1,CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'Van',N'20130101',N'I',N'C/O Demo 1',N'Her House',N'',N'Southampton',N'England',N'',N'A',N'GB',N'PRT',N'',1,N'2191',N'',N'',N'',N'',N'',N'',N'',N'',N'',N'',-1)
 ,(1000,1000,CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'JC',N'20230317',N'I',N'c/o Mrs W van der Merwe',N'PO Box 123',N'',N'',N'Midrand',N'',N'A',N'ZA',N'PRT',N'',1,N'2191',N'N',N'',N'N',N'10000101',N'N',N'',N'',N'+27 (0)11 5770620',N'',N'service@gray.co.za',-1)
 ,(1001,1001,CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'JC',N'20230317',N'I',N'c/o Ms Njala',N'PO Box 955',N'',N'',N'Sandton',N'',N'A',N'ZA',N'PRT',N'',1,N'2196',N'N',N'',N'N',N'10000101',N'N',N'',N'',N'+27 (0)11 5770620',N'',N'service@gray.co.za',-1)
 ,(1002,1002,CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'JC',N'20230317',N'I',N'c/o Miss T van Tonder',N'PO Box 1',N'Sanlamhof',N'',N'',N'',N'A',N'ZA',N'PRT',N'',1,N'7532',N'N',N'',N'N',N'10000101',N'N',N'',N'',N'+27(0)7786666',N'',N'service@sanlam.co.za',-1)
 ,(10000,10000,CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'JC',N'20230317',N'I',N'Dan van der Merwe',N'Postnet Suite 222',N'Private Bag X150',N'',N'',N'',N'A',N'ZA',N'PRT',N'',1,N'2196',N'N',N'',N'N',N'10000101',N'N',N'',N'+27(0)834415353',N'+27 (0)11 5770067',N'',N'',-1)
 ,(10001,10001,CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'JC',N'20230317',N'I',N'Lindiwe Khumalo',N'5th Floor',N'Francis Group Building',N'3 Gwen Lane',N'Sandton',N'',N'A',N'ZA',N'PRT',N'',1,N'2196',N'N',N'',N'N',N'10000101',N'N',N'',N'+27(0)834415333',N'+27 (0)11 4540001',N'',N'',-1)
 ,(10002,10002,CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'JC',N'20230317',N'I',N'Nada Ntuli',N'5th Floor',N'Francis Group Building',N'3 Gwen Lane',N'Sandton',N'',N'A',N'ZA',N'PRT',N'',1,N'2196',N'N',N'',N'N',N'10000101',N'N',N'',N'+27(0)834415777',N'+27 (0)11 5770067',N'',N'',-1)
 ,(10003,10003,CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'JC',N'20230317',N'I',N'Frank Moodley',N'5th Floor',N'Francis Group Building',N'3 Gwen Lane',N'Sandton',N'',N'A',N'ZA',N'PRT',N'',1,N'2196',N'N',N'',N'N',N'10000101',N'N',N'',N'+27(0)824424100',N'+27 (0)11 5770067',N'',N'',-1)
 ,(10004,10004,CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'JC',N'20230317',N'I',N'Chris Smith',N'5th Floor',N'Francis Group Building',N'3 Gwen Lane',N'Sandton',N'',N'A',N'ZA',N'PRT',N'',1,N'2196',N'N',N'',N'N',N'10000101',N'N',N'',N'+27(0)836754312',N'+27 (0)21 6540387',N'',N'',-1)
 ,(10005,10005,CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'JC',N'20230317',N'I',N'Jan Hofmeyer',N'5th Floor',N'Francis Group Building',N'3 Gwen Lane',N'Sandton',N'',N'A',N'ZA',N'PRT',N'',1,N'2196',N'N',N'',N'N',N'10000101',N'N',N'',N'+27(0)836733444',N'+27 (0)21 6540387',N'',N'',-1)
 ,(1000,10006,CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'JC',N'20230317',N'I',N'c/o Mrs W van der Merwe',N'137b Dunmaglass Road',N'Glenferness',N'',N'Midrand',N'',N'B',N'ZA',N'PRT',N'',1,N'2191',N'N',N'',N'N',N'10000101',N'N',N'',N'',N'+27 (0)11 4540015',N'',N'service@financialvision.co.za',-1)
 ,(1001,10007,CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'JC',N'20230317',N'I',N'c/o Ms Njala',N'5th Floor',N'Francis Group Building',N'3 Gwen Lane',N'Sandton',N'',N'B',N'ZA',N'PRT',N'',1,N'2196',N'N',N'',N'N',N'10000101',N'N',N'',N'',N'+27 (0)11 5770620',N'',N'service@gray.co.za',-1)
 ,(1002,10008,CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'JC',N'20230317',N'I',N'c/o Miss T van Tonder',N'2 Strand Road',N'Bellville',N'',N'Cape Town',N'',N'B',N'ZA',N'PRT',N'',1,N'7530',N'N',N'',N'N',N'10000101',N'N',N'',N'',N'+27(0)7786666',N'',N'service@sanlam.co.za',-1)
 ,(1000000000,100000,CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'Guser',N'20211112',N'I',N'My Name',N'A House',N'',N'',N'',N'',N'A',N'UK',N'PRT',N'',1,N'SW17',N'N',N'1000000000',N'N',N'10000101',N'N',N'Not Supplied',N'Not Supplied',N'Not Supplied',N'',N'',172)
 ,(1000000001,100001,CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'Van',N'20150629',N'I',N'Jason',N'464 Back Nile St 61',N'',N'',N'Hertford',N'',N'A',N'ZA',N'PRT',N'',1,N'2196',N'N',N'1000000001',N'N',N'10000101',N'N',N'',N'',N'',N'',N'',-1)
 ,(1000000002,100002,CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'Van',N'20150629',N'I',N'Matthew',N'29 Greenleaf St',N'',N'',N'Salisbury',N'',N'A',N'ZA',N'PRT',N'',1,N'2196',N'N',N'1000000002',N'N',N'10000101',N'N',N'',N'',N'',N'',N'',-1)
 ,(1000000003,100003,CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'Van',N'20150629',N'I',N'Ivan',N'8 Taylor St',N'',N'',N'Seaham',N'',N'A',N'ZA',N'PRT',N'',1,N'2196',N'N',N'1000000003',N'N',N'10000101',N'N',N'',N'',N'',N'',N'',-1)
 ,(1000000004,100004,CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'Van',N'20150629',N'I',N'Benjamin',N'94 Villars St',N'',N'',N'Great Yarmouth',N'',N'A',N'ZA',N'PRT',N'',1,N'2196',N'N',N'1000000004',N'N',N'10000101',N'N',N'',N'',N'',N'',N'',-1)
 ,(1000000005,100005,CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'Van',N'20150629',N'I',N'Johnathon',N'529 Stalmine Rd',N'',N'',N'York',N'',N'A',N'ZA',N'PRT',N'',1,N'2196',N'N',N'1000000005',N'N',N'10000101',N'N',N'',N'',N'',N'',N'',-1)
 ,(1000000006,100006,CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'Van',N'20150629',N'I',N'Jack',N'2 Park Rd Walton',N'',N'',N'',N'',N'A',N'ZA',N'PRT',N'',1,N'2196',N'N',N'1000000006',N'N',N'10000101',N'N',N'',N'',N'',N'',N'',-1)
 ,(1000000007,100007,CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'Van',N'20150629',N'I',N'Alexander',N'33 Vipond St',N'',N'',N'Brentwood',N'',N'A',N'ZA',N'PRT',N'',1,N'2196',N'N',N'1000000007',N'N',N'10000101',N'N',N'',N'',N'',N'',N'',-1)
 ,(1000000008,100008,CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'Van',N'20150629',N'I',N'Wilson',N'636 Portland Place',N'',N'',N'Dover',N'',N'A',N'ZA',N'PRT',N'',1,N'2196',N'N',N'1000000008',N'N',N'10000101',N'N',N'',N'',N'',N'',N'',-1)
 ,(1000000009,100009,CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'Van',N'20150629',N'I',N'Alexander',N'1267 Alderson Rd',N'',N'',N'',N'',N'A',N'ZA',N'PRT',N'',1,N'2196',N'N',N'1000000009',N'N',N'10000101',N'N',N'',N'',N'',N'',N'',-1)
 ,(1000000010,100010,CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'DMTEAM',N'20150629',N'I',N'Charles',N'45 Bradfield St 1',N'',N'',N'Harpenden',N'',N'A',N'ZA',N'PRT',N'',1,N'5555',N'N',N'1000000010',N'N',N'10000101',N'N',N'',N'',N'',N'',N'',-1)
 ,(1000000011,100011,CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'Van',N'20150629',N'I',N'Daniel',N'8092 Firdale Rd',N'',N'',N'',N'',N'A',N'ZA',N'PRT',N'',1,N'2196',N'N',N'1000000011',N'N',N'10000101',N'N',N'',N'',N'',N'',N'',-1)
 ,(1000000012,100012,CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'Van',N'20150629',N'I',N'Charlie',N'30 Marine Parade',N'',N'',N'',N'',N'A',N'ZA',N'PRT',N'',1,N'2196',N'N',N'1000000012',N'N',N'10000101',N'N',N'',N'',N'',N'',N'',-1)
 ,(1000000013,100013,CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'Van',N'20150629',N'I',N'David',N'714 Fonthill Rd',N'',N'',N'Sutton',N'',N'A',N'ZA',N'PRT',N'',1,N'2196',N'N',N'1000000013',N'N',N'10000101',N'N',N'',N'',N'',N'',N'',-1)
 ,(1000000014,100014,CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'Van',N'20150629',N'I',N'Timothy',N'5 Shakspeare St',N'',N'',N'Torquay',N'',N'A',N'ZA',N'PRT',N'',1,N'2196',N'N',N'1000000014',N'N',N'10000101',N'N',N'',N'',N'',N'',N'',-1)
 ,(1000000015,100015,CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'Van',N'20150629',N'I',N'Phillip',N'4 Peach St 511',N'',N'',N'Halesowen',N'',N'A',N'ZA',N'PRT',N'',1,N'2196',N'N',N'1000000015',N'N',N'10000101',N'N',N'',N'',N'',N'',N'',-1)
 ,(1000000016,100016,CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'Van',N'20150629',N'I',N'Terry',N'5382 Redfern St',N'',N'',N'Woking-Byfleet',N'',N'A',N'ZA',N'PRT',N'',1,N'2196',N'N',N'1000000016',N'N',N'10000101',N'N',N'',N'',N'',N'',N'',-1)
 ,(1000000017,100017,CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'Van',N'20150629',N'I',N'Dominic',N'87 Pownall Sq',N'',N'',N'',N'',N'A',N'ZA',N'PRT',N'',1,N'2196',N'N',N'1000000017',N'N',N'10000101',N'N',N'',N'',N'',N'',N'',-1)
 ,(1000000018,100018,CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'Van',N'20150629',N'I',N'Jon',N'6061 Back Nile St',N'',N'',N'',N'',N'A',N'ZA',N'PRT',N'',1,N'2196',N'N',N'1000000018',N'Y',N'20150628',N'N',N'',N'',N'',N'',N'',-1)
 ,(1000000019,100019,CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'Van',N'20150629',N'I',N'Ronald',N'9283 Ruth St',N'',N'',N'Esher',N'',N'A',N'ZA',N'PRT',N'',1,N'2196',N'N',N'1000000019',N'N',N'10000101',N'N',N'',N'',N'',N'',N'',-1)
) AS [Source] ([ct_client_id],[ad_address_id],[ad_create_date],[ad_last_updt_date],[ad_last_updt_time],[ad_last_updt_userid],[ad_business_date],[ad_record_status],[ad_addressee],[ad_address1],[ad_address2],[ad_address3],[ad_address4],[ad_address5],[ad_address_type],[ad_country_code],[ad_dispatch_method],[ad_region],[ad_version_number],[ad_postcode],[ad_addressee_indicator],[ad_dm_reference],[ad_gone_away],[ad_gone_away_date],[ad_returned_correspondence],[ad_home_phone],[ad_mobile_phone],[ad_work_phone],[ad_fax],[ad_internet_address],[sl_system_log_id])
ON ([Target].[ad_address_id] = [Source].[ad_address_id] AND [Target].[ad_version_number] = [Source].[ad_version_number] AND [Target].[ct_client_id] = [Source].[ct_client_id])
WHEN MATCHED AND (
	NULLIF([Source].[ad_last_updt_userid], [Target].[ad_last_updt_userid]) IS NOT NULL OR NULLIF([Target].[ad_last_updt_userid], [Source].[ad_last_updt_userid]) IS NOT NULL OR 
	NULLIF([Source].[ad_business_date], [Target].[ad_business_date]) IS NOT NULL OR NULLIF([Target].[ad_business_date], [Source].[ad_business_date]) IS NOT NULL OR 
	NULLIF([Source].[ad_record_status], [Target].[ad_record_status]) IS NOT NULL OR NULLIF([Target].[ad_record_status], [Source].[ad_record_status]) IS NOT NULL OR 
	NULLIF([Source].[ad_addressee], [Target].[ad_addressee]) IS NOT NULL OR NULLIF([Target].[ad_addressee], [Source].[ad_addressee]) IS NOT NULL OR 
	NULLIF([Source].[ad_address1], [Target].[ad_address1]) IS NOT NULL OR NULLIF([Target].[ad_address1], [Source].[ad_address1]) IS NOT NULL OR 
	NULLIF([Source].[ad_address2], [Target].[ad_address2]) IS NOT NULL OR NULLIF([Target].[ad_address2], [Source].[ad_address2]) IS NOT NULL OR 
	NULLIF([Source].[ad_address3], [Target].[ad_address3]) IS NOT NULL OR NULLIF([Target].[ad_address3], [Source].[ad_address3]) IS NOT NULL OR 
	NULLIF([Source].[ad_address4], [Target].[ad_address4]) IS NOT NULL OR NULLIF([Target].[ad_address4], [Source].[ad_address4]) IS NOT NULL OR 
	NULLIF([Source].[ad_address5], [Target].[ad_address5]) IS NOT NULL OR NULLIF([Target].[ad_address5], [Source].[ad_address5]) IS NOT NULL OR 
	NULLIF([Source].[ad_address_type], [Target].[ad_address_type]) IS NOT NULL OR NULLIF([Target].[ad_address_type], [Source].[ad_address_type]) IS NOT NULL OR 
	NULLIF([Source].[ad_country_code], [Target].[ad_country_code]) IS NOT NULL OR NULLIF([Target].[ad_country_code], [Source].[ad_country_code]) IS NOT NULL OR 
	NULLIF([Source].[ad_dispatch_method], [Target].[ad_dispatch_method]) IS NOT NULL OR NULLIF([Target].[ad_dispatch_method], [Source].[ad_dispatch_method]) IS NOT NULL OR 
	NULLIF([Source].[ad_region], [Target].[ad_region]) IS NOT NULL OR NULLIF([Target].[ad_region], [Source].[ad_region]) IS NOT NULL OR 
	NULLIF([Source].[ad_postcode], [Target].[ad_postcode]) IS NOT NULL OR NULLIF([Target].[ad_postcode], [Source].[ad_postcode]) IS NOT NULL OR 
	NULLIF([Source].[ad_addressee_indicator], [Target].[ad_addressee_indicator]) IS NOT NULL OR NULLIF([Target].[ad_addressee_indicator], [Source].[ad_addressee_indicator]) IS NOT NULL OR 
	NULLIF([Source].[ad_dm_reference], [Target].[ad_dm_reference]) IS NOT NULL OR NULLIF([Target].[ad_dm_reference], [Source].[ad_dm_reference]) IS NOT NULL OR 
	NULLIF([Source].[ad_gone_away], [Target].[ad_gone_away]) IS NOT NULL OR NULLIF([Target].[ad_gone_away], [Source].[ad_gone_away]) IS NOT NULL OR 
	NULLIF([Source].[ad_gone_away_date], [Target].[ad_gone_away_date]) IS NOT NULL OR NULLIF([Target].[ad_gone_away_date], [Source].[ad_gone_away_date]) IS NOT NULL OR 
	NULLIF([Source].[ad_returned_correspondence], [Target].[ad_returned_correspondence]) IS NOT NULL OR NULLIF([Target].[ad_returned_correspondence], [Source].[ad_returned_correspondence]) IS NOT NULL OR 
	NULLIF([Source].[ad_home_phone], [Target].[ad_home_phone]) IS NOT NULL OR NULLIF([Target].[ad_home_phone], [Source].[ad_home_phone]) IS NOT NULL OR 
	NULLIF([Source].[ad_mobile_phone], [Target].[ad_mobile_phone]) IS NOT NULL OR NULLIF([Target].[ad_mobile_phone], [Source].[ad_mobile_phone]) IS NOT NULL OR 
	NULLIF([Source].[ad_work_phone], [Target].[ad_work_phone]) IS NOT NULL OR NULLIF([Target].[ad_work_phone], [Source].[ad_work_phone]) IS NOT NULL OR 
	NULLIF([Source].[ad_fax], [Target].[ad_fax]) IS NOT NULL OR NULLIF([Target].[ad_fax], [Source].[ad_fax]) IS NOT NULL OR 
	NULLIF([Source].[ad_internet_address], [Target].[ad_internet_address]) IS NOT NULL OR NULLIF([Target].[ad_internet_address], [Source].[ad_internet_address]) IS NOT NULL OR 
	NULLIF([Source].[sl_system_log_id], [Target].[sl_system_log_id]) IS NOT NULL OR NULLIF([Target].[sl_system_log_id], [Source].[sl_system_log_id]) IS NOT NULL) THEN
 UPDATE SET
  [Target].[ad_last_updt_date] = [Source].[ad_last_updt_date], 
  [Target].[ad_last_updt_time] = [Source].[ad_last_updt_time], 
  [Target].[ad_last_updt_userid] = [Source].[ad_last_updt_userid], 
  [Target].[ad_business_date] = [Source].[ad_business_date], 
  [Target].[ad_record_status] = [Source].[ad_record_status], 
  [Target].[ad_addressee] = [Source].[ad_addressee], 
  [Target].[ad_address1] = [Source].[ad_address1], 
  [Target].[ad_address2] = [Source].[ad_address2], 
  [Target].[ad_address3] = [Source].[ad_address3], 
  [Target].[ad_address4] = [Source].[ad_address4], 
  [Target].[ad_address5] = [Source].[ad_address5], 
  [Target].[ad_address_type] = [Source].[ad_address_type], 
  [Target].[ad_country_code] = [Source].[ad_country_code], 
  [Target].[ad_dispatch_method] = [Source].[ad_dispatch_method], 
  [Target].[ad_region] = [Source].[ad_region], 
  [Target].[ad_postcode] = [Source].[ad_postcode], 
  [Target].[ad_addressee_indicator] = [Source].[ad_addressee_indicator], 
  [Target].[ad_dm_reference] = [Source].[ad_dm_reference], 
  [Target].[ad_gone_away] = [Source].[ad_gone_away], 
  [Target].[ad_gone_away_date] = [Source].[ad_gone_away_date], 
  [Target].[ad_returned_correspondence] = [Source].[ad_returned_correspondence], 
  [Target].[ad_home_phone] = [Source].[ad_home_phone], 
  [Target].[ad_mobile_phone] = [Source].[ad_mobile_phone], 
  [Target].[ad_work_phone] = [Source].[ad_work_phone], 
  [Target].[ad_fax] = [Source].[ad_fax], 
  [Target].[ad_internet_address] = [Source].[ad_internet_address], 
  [Target].[sl_system_log_id] = [Source].[sl_system_log_id]
WHEN NOT MATCHED BY TARGET THEN
 INSERT([ct_client_id],[ad_address_id],[ad_create_date],[ad_last_updt_date],[ad_last_updt_time],[ad_last_updt_userid],[ad_business_date],[ad_record_status],[ad_addressee],[ad_address1],[ad_address2],[ad_address3],[ad_address4],[ad_address5],[ad_address_type],[ad_country_code],[ad_dispatch_method],[ad_region],[ad_version_number],[ad_postcode],[ad_addressee_indicator],[ad_dm_reference],[ad_gone_away],[ad_gone_away_date],[ad_returned_correspondence],[ad_home_phone],[ad_mobile_phone],[ad_work_phone],[ad_fax],[ad_internet_address],[sl_system_log_id])
 VALUES([Source].[ct_client_id],[Source].[ad_address_id],[Source].[ad_create_date],[Source].[ad_last_updt_date],[Source].[ad_last_updt_time],[Source].[ad_last_updt_userid],[Source].[ad_business_date],[Source].[ad_record_status],[Source].[ad_addressee],[Source].[ad_address1],[Source].[ad_address2],[Source].[ad_address3],[Source].[ad_address4],[Source].[ad_address5],[Source].[ad_address_type],[Source].[ad_country_code],[Source].[ad_dispatch_method],[Source].[ad_region],[Source].[ad_version_number],[Source].[ad_postcode],[Source].[ad_addressee_indicator],[Source].[ad_dm_reference],[Source].[ad_gone_away],[Source].[ad_gone_away_date],[Source].[ad_returned_correspondence],[Source].[ad_home_phone],[Source].[ad_mobile_phone],[Source].[ad_work_phone],[Source].[ad_fax],[Source].[ad_internet_address],[Source].[sl_system_log_id]);
 
IF @mergeError != 0 
BEGIN 
PRINT 'ERROR OCCURRED IN MERGE FOR ad_address.sql. Rows affected: ' + CAST(@mergeCount AS VARCHAR(100)); -- SQL should always return zero rows affected 
END 
ELSE IF @mergeCount > 0 
BEGIN 
PRINT 'ad_address.sql rows affected by MERGE: ' + CAST(@mergeCount AS VARCHAR(100)); 
END 
 
PRINT 'Include ao_accounting_period.sql' 
MERGE INTO [ao_accounting_period] AS [Target]
USING (VALUES
  (N'201904',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'Script',N'20190624',N'I',N'Y',N'10000101',N'99991231')
 ,(N'201905',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'Script',N'20190624',N'I',N'Y',N'10000101',N'99991231')
 ,(N'201906',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'Script',N'20190624',N'I',N'Y',N'10000101',N'99991231')
 ,(N'201907',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'Script',N'20190624',N'I',N'Y',N'10000101',N'99991231')
 ,(N'201908',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'Script',N'20190624',N'I',N'Y',N'10000101',N'99991231')
 ,(N'201909',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'Script',N'20190624',N'I',N'Y',N'10000101',N'99991231')
 ,(N'201910',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'Script',N'20190624',N'I',N'Y',N'10000101',N'99991231')
 ,(N'201911',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'Script',N'20190624',N'I',N'Y',N'10000101',N'99991231')
 ,(N'201912',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'Script',N'20190624',N'I',N'Y',N'10000101',N'99991231')
 ,(N'202001',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'Script',N'20190624',N'I',N'Y',N'10000101',N'99991231')
 ,(N'202002',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'Script',N'20190624',N'I',N'Y',N'10000101',N'99991231')
 ,(N'202003',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'Script',N'20190624',N'I',N'Y',N'10000101',N'99991231')
 ,(N'202004',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'Script',N'20190624',N'I',N'Y',N'10000101',N'99991231')
 ,(N'202005',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'Script',N'20190624',N'I',N'Y',N'10000101',N'99991231')
 ,(N'202006',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'Script',N'20190624',N'I',N'Y',N'10000101',N'99991231')
 ,(N'202007',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'Script',N'20190624',N'I',N'Y',N'10000101',N'99991231')
 ,(N'202008',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'Script',N'20190624',N'I',N'Y',N'10000101',N'99991231')
 ,(N'202009',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'Script',N'20190624',N'I',N'Y',N'10000101',N'99991231')
 ,(N'202010',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'Script',N'20190624',N'I',N'Y',N'10000101',N'99991231')
 ,(N'202011',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'Script',N'20190624',N'I',N'Y',N'10000101',N'99991231')
 ,(N'202012',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'Script',N'20190624',N'I',N'Y',N'10000101',N'99991231')
 ,(N'202101',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'Script',N'20190624',N'I',N'Y',N'10000101',N'99991231')
 ,(N'202102',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'Script',N'20190624',N'I',N'Y',N'10000101',N'99991231')
 ,(N'202103',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'Script',N'20190624',N'I',N'Y',N'10000101',N'99991231')
 ,(N'202104',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'Script',N'20190624',N'I',N'Y',N'10000101',N'99991231')
 ,(N'202105',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'Script',N'20190624',N'I',N'Y',N'10000101',N'99991231')
 ,(N'202106',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'Script',N'20190624',N'I',N'Y',N'10000101',N'99991231')
 ,(N'202107',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'Script',N'20190624',N'I',N'Y',N'10000101',N'99991231')
 ,(N'202108',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'Script',N'20190624',N'I',N'Y',N'10000101',N'99991231')
 ,(N'202109',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'Script',N'20190624',N'I',N'Y',N'10000101',N'99991231')
 ,(N'202110',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'Script',N'20190624',N'I',N'Y',N'10000101',N'99991231')
 ,(N'202111',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'Script',N'20190624',N'I',N'Y',N'10000101',N'99991231')
 ,(N'202112',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'Script',N'20190624',N'I',N'Y',N'10000101',N'99991231')
 ,(N'202201',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'Script',N'20190624',N'I',N'Y',N'10000101',N'99991231')
 ,(N'202202',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'Script',N'20190624',N'I',N'Y',N'10000101',N'99991231')
 ,(N'202203',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'Script',N'20190624',N'I',N'Y',N'10000101',N'99991231')
 ,(N'202204',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'Script',N'20190624',N'I',N'Y',N'10000101',N'99991231')
 ,(N'202205',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'Script',N'20190624',N'I',N'Y',N'10000101',N'99991231')
 ,(N'202206',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'Script',N'20190624',N'I',N'Y',N'10000101',N'99991231')
 ,(N'202207',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'Script',N'20190624',N'I',N'Y',N'10000101',N'99991231')
 ,(N'202208',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'Script',N'20190624',N'I',N'Y',N'10000101',N'99991231')
 ,(N'202209',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'Script',N'20190624',N'I',N'Y',N'10000101',N'99991231')
 ,(N'202210',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'Script',N'20190624',N'I',N'Y',N'10000101',N'99991231')
 ,(N'202211',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'Script',N'20190624',N'I',N'Y',N'10000101',N'99991231')
 ,(N'202212',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'Script',N'20190624',N'I',N'Y',N'10000101',N'99991231')
 ,(N'202301',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'Script',N'20190624',N'I',N'Y',N'10000101',N'99991231')
 ,(N'202302',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'Script',N'20190624',N'I',N'Y',N'10000101',N'99991231')
 ,(N'202303',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'Script',N'20190624',N'I',N'Y',N'10000101',N'99991231')
 ,(N'202304',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'Script',N'20190624',N'I',N'Y',N'10000101',N'99991231')
 ,(N'202305',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'Script',N'20190624',N'I',N'Y',N'10000101',N'99991231')
 ,(N'202306',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'Script',N'20190624',N'I',N'Y',N'10000101',N'99991231')
 ,(N'202307',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'Script',N'20190624',N'I',N'Y',N'10000101',N'99991231')
 ,(N'202308',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'Script',N'20190624',N'I',N'Y',N'10000101',N'99991231')
 ,(N'202309',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'Script',N'20190624',N'I',N'Y',N'10000101',N'99991231')
 ,(N'202310',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'Script',N'20190624',N'I',N'Y',N'10000101',N'99991231')
 ,(N'202311',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'Script',N'20190624',N'I',N'Y',N'10000101',N'99991231')
 ,(N'202312',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'Script',N'20190624',N'I',N'Y',N'10000101',N'99991231')
 ,(N'202401',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'Script',N'20190624',N'I',N'Y',N'10000101',N'99991231')
 ,(N'202402',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'Script',N'20190624',N'I',N'Y',N'10000101',N'99991231')
 ,(N'202403',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'Script',N'20190624',N'I',N'Y',N'10000101',N'99991231')
 ,(N'202404',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'Script',N'20190624',N'I',N'Y',N'10000101',N'99991231')
 ,(N'202405',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'Script',N'20190624',N'I',N'Y',N'10000101',N'99991231')
 ,(N'202406',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'Script',N'20190624',N'I',N'Y',N'10000101',N'99991231')
 ,(N'202407',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'Script',N'20190624',N'I',N'Y',N'10000101',N'99991231')
 ,(N'202408',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'Script',N'20190624',N'I',N'Y',N'10000101',N'99991231')
 ,(N'202409',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'Script',N'20190624',N'I',N'Y',N'10000101',N'99991231')
 ,(N'202410',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'Script',N'20190624',N'I',N'Y',N'10000101',N'99991231')
 ,(N'202411',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'Script',N'20190624',N'I',N'Y',N'10000101',N'99991231')
 ,(N'202412',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'Script',N'20190624',N'I',N'Y',N'10000101',N'99991231')
) AS [Source] ([ao_accounting_period],[ao_create_date],[ao_last_updt_date],[ao_last_updt_time],[ao_last_updt_userid],[ao_business_date],[ao_record_status],[ao_open],[ao_open_date],[ao_closed_date])
ON ([Target].[ao_accounting_period] = [Source].[ao_accounting_period])
WHEN MATCHED AND (
	NULLIF([Source].[ao_create_date], [Target].[ao_create_date]) IS NOT NULL OR NULLIF([Target].[ao_create_date], [Source].[ao_create_date]) IS NOT NULL OR 
	NULLIF([Source].[ao_last_updt_date], [Target].[ao_last_updt_date]) IS NOT NULL OR NULLIF([Target].[ao_last_updt_date], [Source].[ao_last_updt_date]) IS NOT NULL OR 
	NULLIF([Source].[ao_last_updt_time], [Target].[ao_last_updt_time]) IS NOT NULL OR NULLIF([Target].[ao_last_updt_time], [Source].[ao_last_updt_time]) IS NOT NULL OR 
	NULLIF([Source].[ao_last_updt_userid], [Target].[ao_last_updt_userid]) IS NOT NULL OR NULLIF([Target].[ao_last_updt_userid], [Source].[ao_last_updt_userid]) IS NOT NULL OR 
	NULLIF([Source].[ao_business_date], [Target].[ao_business_date]) IS NOT NULL OR NULLIF([Target].[ao_business_date], [Source].[ao_business_date]) IS NOT NULL OR 
	NULLIF([Source].[ao_record_status], [Target].[ao_record_status]) IS NOT NULL OR NULLIF([Target].[ao_record_status], [Source].[ao_record_status]) IS NOT NULL OR 
	NULLIF([Source].[ao_open], [Target].[ao_open]) IS NOT NULL OR NULLIF([Target].[ao_open], [Source].[ao_open]) IS NOT NULL OR 
	NULLIF([Source].[ao_open_date], [Target].[ao_open_date]) IS NOT NULL OR NULLIF([Target].[ao_open_date], [Source].[ao_open_date]) IS NOT NULL OR 
	NULLIF([Source].[ao_closed_date], [Target].[ao_closed_date]) IS NOT NULL OR NULLIF([Target].[ao_closed_date], [Source].[ao_closed_date]) IS NOT NULL) THEN
 UPDATE SET
  [Target].[ao_create_date] = [Source].[ao_create_date], 
  [Target].[ao_last_updt_date] = [Source].[ao_last_updt_date], 
  [Target].[ao_last_updt_time] = [Source].[ao_last_updt_time], 
  [Target].[ao_last_updt_userid] = [Source].[ao_last_updt_userid], 
  [Target].[ao_business_date] = [Source].[ao_business_date], 
  [Target].[ao_record_status] = [Source].[ao_record_status], 
  [Target].[ao_open] = [Source].[ao_open], 
  [Target].[ao_open_date] = [Source].[ao_open_date], 
  [Target].[ao_closed_date] = [Source].[ao_closed_date]
WHEN NOT MATCHED BY TARGET THEN
 INSERT([ao_accounting_period],[ao_create_date],[ao_last_updt_date],[ao_last_updt_time],[ao_last_updt_userid],[ao_business_date],[ao_record_status],[ao_open],[ao_open_date],[ao_closed_date])
 VALUES([Source].[ao_accounting_period],[Source].[ao_create_date],[Source].[ao_last_updt_date],[Source].[ao_last_updt_time],[Source].[ao_last_updt_userid],[Source].[ao_business_date],[Source].[ao_record_status],[Source].[ao_open],[Source].[ao_open_date],[Source].[ao_closed_date]);
 
IF @mergeError != 0 
BEGIN 
PRINT 'ERROR OCCURRED IN MERGE FOR ao_accounting_period.sql. Rows affected: ' + CAST(@mergeCount AS VARCHAR(100)); -- SQL should always return zero rows affected 
END 
ELSE IF @mergeCount > 0 
BEGIN 
PRINT 'ao_accounting_period.sql rows affected by MERGE: ' + CAST(@mergeCount AS VARCHAR(100)); 
END 
 
PRINT 'Include cta_client_additional.sql' 
MERGE INTO [cta_client_additional] AS [Target]
USING (VALUES
  (1000,N'CCPREF',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'JC',N'20230213',N'I',N'SP',N'20230213',N'99991231',5)
 ,(1001,N'CCPREF',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'JC',N'20230213',N'I',N'SP',N'20230213',N'99991231',8)
 ,(1002,N'CCPREF',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'JC',N'20230213',N'I',N'SP',N'20230213',N'99991231',11)
 ,(10001,N'CCPREF',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'JC',N'20230213',N'I',N'SP',N'20230213',N'99991231',14)
 ,(10002,N'CCPREF',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'JC',N'20230213',N'I',N'SP',N'20230213',N'99991231',17)
 ,(10003,N'CCPREF',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'JC',N'20230213',N'I',N'SP',N'20230213',N'99991231',20)
 ,(10004,N'CCPREF',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'JC',N'20230213',N'I',N'SP',N'20230213',N'99991231',23)
 ,(10005,N'CCPREF',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'JC',N'20230213',N'I',N'SP',N'20230213',N'99991231',26)
 ,(1000000010,N'NATLIST',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'MG',N'20240219',N'I',N'<Data><Nationality>ZA</Nationality><NationalId>6108135800089</NationalId><PRIMARY>Y</PRIMARY></Data>',N'20220219',N'99991231',27)
) AS [Source] ([ct_client_id],[cta_data_type],[cta_create_date],[cta_last_updt_date],[cta_last_updt_time],[cta_last_updt_userid],[cta_business_date],[cta_record_status],[cta_data_value],[cta_effective_from_date],[cta_effective_to_date],[sl_system_log_id])
ON ([Target].[ct_client_id] = [Source].[ct_client_id] AND [Target].[cta_data_type] = [Source].[cta_data_type])
WHEN MATCHED AND (
	NULLIF([Source].[cta_business_date], [Target].[cta_business_date]) IS NOT NULL OR NULLIF([Target].[cta_business_date], [Source].[cta_business_date]) IS NOT NULL OR 
	NULLIF([Source].[cta_record_status], [Target].[cta_record_status]) IS NOT NULL OR NULLIF([Target].[cta_record_status], [Source].[cta_record_status]) IS NOT NULL OR 
	NULLIF([Source].[cta_data_value], [Target].[cta_data_value]) IS NOT NULL OR NULLIF([Target].[cta_data_value], [Source].[cta_data_value]) IS NOT NULL OR 
	NULLIF([Source].[cta_effective_from_date], [Target].[cta_effective_from_date]) IS NOT NULL OR NULLIF([Target].[cta_effective_from_date], [Source].[cta_effective_from_date]) IS NOT NULL OR 
	NULLIF([Source].[cta_effective_to_date], [Target].[cta_effective_to_date]) IS NOT NULL OR NULLIF([Target].[cta_effective_to_date], [Source].[cta_effective_to_date]) IS NOT NULL OR 
	NULLIF([Source].[sl_system_log_id], [Target].[sl_system_log_id]) IS NOT NULL OR NULLIF([Target].[sl_system_log_id], [Source].[sl_system_log_id]) IS NOT NULL) THEN
 UPDATE SET
  [Target].[cta_last_updt_date] = CONVERT(CHAR(8),GETDATE(),112), 
  [Target].[cta_last_updt_time] = RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')), 
  [Target].[cta_last_updt_userid] = [Source].[cta_last_updt_userid], 
  [Target].[cta_business_date] = [Source].[cta_business_date], 
  [Target].[cta_record_status] = [Source].[cta_record_status], 
  [Target].[cta_data_value] = [Source].[cta_data_value], 
  [Target].[cta_effective_from_date] = [Source].[cta_effective_from_date], 
  [Target].[cta_effective_to_date] = [Source].[cta_effective_to_date], 
  [Target].[sl_system_log_id] = [Source].[sl_system_log_id]
WHEN NOT MATCHED BY TARGET THEN
 INSERT([ct_client_id],[cta_data_type],[cta_create_date],[cta_last_updt_date],[cta_last_updt_time],[cta_last_updt_userid],[cta_business_date],[cta_record_status],[cta_data_value],[cta_effective_from_date],[cta_effective_to_date],[sl_system_log_id])
 VALUES([Source].[ct_client_id],[Source].[cta_data_type],CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),[Source].[cta_last_updt_userid],[Source].[cta_business_date],[Source].[cta_record_status],[Source].[cta_data_value],[Source].[cta_effective_from_date],[Source].[cta_effective_to_date],[Source].[sl_system_log_id]);

SELECT @mergeError = @@ERROR, @mergeCount = @@ROWCOUNT

 
IF @mergeError != 0 
BEGIN 
PRINT 'ERROR OCCURRED IN MERGE FOR cta_client_additional.sql. Rows affected: ' + CAST(@mergeCount AS VARCHAR(100)); -- SQL should always return zero rows affected 
END 
ELSE IF @mergeCount > 0 
BEGIN 
PRINT 'cta_client_additional.sql rows affected by MERGE: ' + CAST(@mergeCount AS VARCHAR(100)); 
END 
 
PRINT 'Include ct_client.sql' 
MERGE INTO [ct_client] AS [Target]
USING (VALUES
  (1,CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'Van',N'20130101',N'I',N'',N'Glacier Financial Solutions (Pty) Ltd',N'',N'',N'10000101',N'',N'',N'',N'B',N'',N'',N'',N'',N'',N'6153',N'',N'xxxxxx0087',N'',N'',N'',N'',N'',N'',N'',N'10000101',N'',N'',N'10000101',N'L',N'',N'',N'N',N'N',N'B',N'',N'N',N'',N'N',N'',N'',N'',N'',N'',N'',N'',N'',N'',N'',N'',N'',N'',N'',N'',N'',N'',N'',N'',0,0.000000000000000e+000,N'',N'',N'',N'1',N'',N'N',N'',-1,-1)
 ,(1000,CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'JC',N'20190430',N'I',N'',N'Financial Vision (Pty) Ltd',N'',N'',N'10000101',N'',N'',N'',N'P',N'',N'Y',N'',N'',N'',N'6153',N'',N'N/A',N'',N'',N'Mrs W van der Merwe',N'',N'',N'',N'1000',N'10000101',N'',N'',N'10000101',N'L',N'',N'',N'N',N'N',N'B',N'',N'N',N'',N'N',N'',N'',N'',N'',N'',N'',N'',N'',N'',N'10000101',N'',N'',N'',N'+27 (0)11 4540015',N'',N'',N'service@financialvision.co.za',N'0023',N'0001',0,0.000000000000000e+000,N'NONE',N'10000101',N'10000101',N'1000',N'service@financialvision.co.za',N'N',N'N',61,0)
 ,(1001,CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'JC',N'20190430',N'I',N'',N'Gray Capital (Pty) Ltd',N'',N'',N'10000101',N'',N'',N'',N'P',N'',N'Y',N'',N'',N'',N'6153',N'',N'N/A',N'',N'',N'Ms Njala',N'',N'',N'',N'1001',N'10000101',N'',N'',N'10000101',N'L',N'',N'',N'N',N'N',N'B',N'',N'N',N'',N'N',N'',N'',N'',N'',N'',N'',N'',N'',N'',N'10000101',N'',N'',N'',N'+27 (0)11 5770620',N'',N'',N'service@gray.co.za',N'0023',N'0001',0,0.000000000000000e+000,N'NONE',N'10000101',N'10000101',N'1001',N'service@gray.co.za',N'N',N'N',57,0)
 ,(1002,CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'JC',N'20190430',N'I',N'',N'Sanlam Private Wealth (Pty) Ltd',N'',N'',N'10000101',N'',N'',N'',N'P',N'',N'Y',N'',N'',N'',N'6153',N'',N'N/A',N'',N'',N'Miss T van Tonder',N'',N'',N'',N'1002',N'10000101',N'',N'',N'10000101',N'L',N'',N'',N'N',N'N',N'B',N'',N'N',N'',N'N',N'',N'',N'',N'',N'',N'',N'',N'',N'',N'10000101',N'',N'',N'',N'+27(0)7786666',N'',N'',N'service@sanlam.co.za',N'0023',N'0001',0,0.000000000000000e+000,N'NONE',N'10000101',N'10000101',N'1002',N'service@sanlam.co.za',N'N',N'N',63,0)
 ,(10000,CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'JC',N'20190430',N'I',N'MR',N'van der Merwe',N'Dan',N'',N'19870114',N'',N'',N'M',N'P',N'A',N'N',N'',N'',N'ZA',N'6153',N'N',N'8701145800087',N'',N'',N'',N'',N'',N'',N'10000',N'10000101',N'',N'',N'10000101',N'',N'',N'',N'N',N'N',N'C',N'',N'N',N'',N'N',N'ZA',N'G',N'B',N'B',N'',N'',N'',N'',N'',N'10000101',N'',N'ZA',N'',N'+27 (0)11 4540001',N'+27(0)834415333',N'',N'',N'0023',N'0001',0,0.000000000000000e+000,N'',N'10000101',N'10000101',N'10000',N'',N'N',N'N',71,0)
 ,(10001,CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'JC',N'20190430',N'I',N'MRS',N'Khumalo',N'Lindiwe',N'',N'19970619',N'',N'',N'F',N'P',N'A',N'N',N'',N'',N'ZA',N'6153',N'N',N'9106194800088',N'',N'',N'',N'',N'',N'',N'10001',N'10000101',N'',N'',N'10000101',N'',N'',N'',N'N',N'N',N'C',N'',N'N',N'',N'N',N'ZA',N'G',N'B',N'B',N'',N'',N'',N'',N'',N'10000101',N'',N'ZA',N'',N'+27 (0)11 5770067',N'+27(0)834415353',N'',N'',N'0023',N'0001',0,0.000000000000000e+000,N'',N'10000101',N'10000101',N'10001',N'',N'N',N'N',69,0)
 ,(10002,CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'JC',N'20190430',N'I',N'MS',N'Ntuli',N'Nada',N'',N'19950714',N'',N'',N'F',N'P',N'A',N'N',N'',N'',N'ZA',N'6153',N'N',N'9507144800088',N'',N'',N'',N'',N'',N'',N'10002',N'10000101',N'',N'',N'10000101',N'',N'',N'',N'N',N'N',N'C',N'',N'N',N'',N'N',N'ZA',N'G',N'B',N'B',N'',N'',N'',N'',N'',N'10000101',N'',N'ZA',N'',N'+27 (0)11 5770067',N'+27(0)834415777',N'',N'',N'0023',N'0001',0,0.000000000000000e+000,N'',N'10000101',N'10000101',N'10002',N'',N'N',N'N',73,0)
 ,(10003,CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'JC',N'20190430',N'I',N'MR',N'Moodley',N'Frank',N'',N'19761104',N'',N'',N'M',N'P',N'A',N'N',N'',N'',N'ZA',N'6153',N'N',N'7611045800080',N'',N'',N'',N'',N'',N'',N'10003',N'10000101',N'',N'',N'10000101',N'',N'',N'',N'N',N'N',N'C',N'',N'N',N'',N'N',N'ZA',N'G',N'B',N'B',N'',N'',N'',N'',N'',N'10000101',N'',N'ZA',N'',N'+27 (0)11 5770067',N'+27(0)824424100',N'',N'',N'0023',N'0001',0,0.000000000000000e+000,N'',N'10000101',N'10000101',N'10002',N'',N'N',N'N',76,0)
 ,(10004,CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'JC',N'20190430',N'I',N'MR',N'Smith',N'Chris',N'',N'19610809',N'',N'',N'M',N'P',N'A',N'N',N'',N'',N'ZA',N'6153',N'N',N'6108095800087',N'',N'',N'',N'',N'',N'',N'10004',N'10000101',N'',N'',N'10000101',N'',N'',N'',N'N',N'N',N'C',N'',N'N',N'',N'N',N'ZA',N'G',N'B',N'B',N'',N'',N'',N'',N'',N'10000101',N'',N'ZA',N'',N'+27 (0)21 6540387',N'+27(0)836754312',N'',N'',N'0023',N'0001',0,0.000000000000000e+000,N'',N'10000101',N'10000101',N'10002',N'',N'N',N'N',78,0)
 ,(10005,CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'JC',N'20190430',N'I',N'MR',N'Hofmeyer',N'Jan',N'',N'19670507',N'',N'',N'M',N'P',N'A',N'N',N'',N'',N'ZA',N'6153',N'N',N'6705075800084',N'',N'',N'',N'',N'',N'',N'10005',N'10000101',N'',N'',N'10000101',N'',N'',N'',N'N',N'N',N'C',N'',N'N',N'',N'N',N'ZA',N'G',N'B',N'B',N'',N'',N'',N'',N'',N'10000101',N'',N'ZA',N'',N'+27 (0)21 6540387',N'+27(0)836733444',N'',N'',N'0023',N'0001',0,0.000000000000000e+000,N'',N'10000101',N'10000101',N'10002',N'',N'N',N'N',80,0)
 ,(1000000000,CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'Guser',N'20211112',N'I',N'MR',N'Xemo',N'Ice',N'',N'19710101',N'',N'',N'M',N'P',N'A',N'N',N'',N'',N'ZA',N'6153',N'',N'',N'',N'',N'',N'',N'',N'',N'1000000000',N'10000101',N'',N'',N'10000101',N'',N'',N'',N'N',N'N',N'C',N'',N'N',N'',N'N',N'ZA',N'G',N'B',N'B',N'',N'',N'',N'',N'',N'10000101',N'',N'UK',N'',N'',N'',N'',N'',N'0006',N'0001',0,0.000000000000000e+000,N'',N'10000101',N'10000101',N'1000000000',N'',N'N',N'N',179,0)
 ,(1000000001,CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'DMTEAM',N'20150629',N'I',N'MISS',N'Oropeza',N'Lisbeth',N'N',N'19730109',N'',N'',N'M',N'P',N'A',N'N',N'',N'',N'ZA',N'6153',N'N',N'AB578457D',N'',N'',N'',N'',N'',N'',N'1000000001',N'10000101',N'',N'',N'',N'',N'',N'',N'N',N'N',N'C',N'',N'N',N'',N'U',N'ZA',N'G',N'E',N'B',N'',N'',N'',N'',N'',N'10000101',N'',N'',N'',N'',N'',N'',N'',N'0015',N'0001',0,0.000000000000000e+000,N'',N'10000101',N'10000101',N'1000000001',N'',N'N',N'Y',-1,-1)
 ,(1000000002,CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'DMTEAM',N'20150629',N'I',N'MS',N'Saltman',N'Phillip',N'P',N'19561008',N'',N'',N'M',N'P',N'A',N'N',N'',N'',N'ZA',N'6153',N'M',N'AB155609C',N'',N'',N'',N'',N'',N'',N'1000000002',N'10000101',N'',N'',N'',N'',N'',N'',N'N',N'N',N'C',N'',N'N',N'',N'U',N'ZA',N'G',N'O',N'B',N'',N'',N'',N'',N'',N'10000101',N'',N'',N'',N'',N'',N'',N'',N'0015',N'0001',0,0.000000000000000e+000,N'',N'10000101',N'10000101',N'1000000002',N'',N'N',N'Y',-1,-1)
 ,(1000000003,CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'DMTEAM',N'20150629',N'I',N'',N'Flamino',N'Erasmo',N'A',N'19701110',N'',N'',N'M',N'P',N'A',N'N',N'',N'',N'ZA',N'6153',N'N',N'AB137457B',N'',N'',N'',N'',N'',N'',N'1000000003',N'10000101',N'',N'',N'',N'',N'',N'',N'N',N'N',N'C',N'',N'N',N'',N'U',N'ZA',N'G',N'E',N'B',N'',N'',N'',N'',N'',N'10000101',N'',N'',N'',N'',N'',N'',N'Leonie.Ferre.dummy@home.com',N'0015',N'0001',0,0.000000000000000e+000,N'',N'10000101',N'10000101',N'1000000003',N'',N'N',N'Y',-1,-1)
 ,(1000000004,CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'DMTEAM',N'20150629',N'I',N'MS',N'Stueber',N'Erasmo',N'L',N'19610603',N'',N'',N'F',N'P',N'A',N'N',N'',N'',N'ZA',N'6153',N'W',N'',N'',N'',N'',N'',N'',N'',N'1000000004',N'10000101',N'',N'',N'',N'',N'',N'',N'N',N'N',N'C',N'',N'N',N'',N'U',N'ZA',N'G',N'O',N'B',N'',N'',N'',N'',N'',N'10000101',N'',N'',N'',N'',N'1632646718',N'',N'Louvenia.Tarry.dummy@home.com',N'0015',N'0001',0,0.000000000000000e+000,N'',N'10000101',N'10000101',N'1000000004',N'',N'N',N'N',-1,-1)
 ,(1000000005,CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'DMTEAM',N'20150629',N'I',N'',N'Fredrikson',N'Pilar',N'H',N'19610206',N'',N'',N'M',N'P',N'A',N'N',N'',N'',N'ZA',N'6153',N'U',N'',N'',N'',N'',N'',N'',N'',N'1000000005',N'19861201',N'',N'',N'',N'',N'',N'',N'N',N'N',N'C',N'',N'N',N'',N'U',N'ZA',N'G',N'O',N'B',N'',N'',N'',N'',N'',N'10000101',N'',N'',N'',N'',N'',N'',N'',N'0015',N'0001',0,0.000000000000000e+000,N'',N'10000101',N'10000101',N'1000000005',N'',N'N',N'N',-1,-1)
 ,(1000000006,CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'DMTEAM',N'20150629',N'I',N'Van',N'Fiorino',N'Alverta',N'T',N'19591103',N'',N'',N'M',N'P',N'A',N'N',N'',N'',N'ZA',N'6153',N'S',N'5903115800088',N'',N'',N'',N'',N'',N'',N'1000000006',N'10000101',N'',N'',N'',N'',N'',N'',N'N',N'N',N'C',N'',N'N',N'',N'U',N'ZA',N'G',N'O',N'B',N'',N'',N'',N'',N'',N'10000101',N'',N'',N'',N'',N'',N'',N'',N'0015',N'0001',0,0.000000000000000e+000,N'',N'10000101',N'10000101',N'1000000006',N'',N'N',N'N',-1,-1)
 ,(1000000007,CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'DMTEAM',N'20150629',N'I',N'MISS',N'Smethers',N'Keneth',N'F',N'19450920',N'',N'',N'M',N'P',N'A',N'N',N'',N'',N'ZA',N'6153',N'M',N'',N'',N'',N'',N'',N'',N'',N'1000000007',N'10000101',N'',N'',N'',N'',N'',N'',N'N',N'N',N'C',N'',N'N',N'',N'U',N'ZA',N'G',N'O',N'B',N'',N'',N'',N'',N'',N'10000101',N'',N'',N'',N'',N'',N'',N'',N'0015',N'0001',0,0.000000000000000e+000,N'',N'10000101',N'10000101',N'1000000007',N'',N'N',N'N',-1,-1)
 ,(1000000008,CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'DMTEAM',N'20150629',N'I',N'',N'Vanhooser',N'Lelia',N'E',N'19460819',N'',N'',N'F',N'P',N'A',N'N',N'',N'',N'ZA',N'6153',N'M',N'',N'',N'',N'',N'',N'',N'',N'1000000008',N'10000101',N'',N'',N'',N'',N'',N'',N'N',N'N',N'C',N'',N'N',N'',N'U',N'ZA',N'G',N'O',N'B',N'',N'',N'',N'',N'',N'10000101',N'',N'',N'',N'',N'',N'',N'',N'0015',N'0001',0,0.000000000000000e+000,N'',N'10000101',N'10000101',N'1000000008',N'',N'N',N'N',-1,-1)
 ,(1000000009,CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'DMTEAM',N'20150629',N'I',N'MRS',N'Peay',N'Dominic',N'I',N'19500409',N'',N'',N'M',N'P',N'A',N'N',N'',N'',N'ZA',N'6153',N'M',N'',N'',N'',N'',N'',N'',N'',N'1000000009',N'10000101',N'',N'',N'',N'',N'',N'',N'N',N'N',N'C',N'',N'N',N'',N'U',N'ZA',N'G',N'O',N'B',N'',N'',N'',N'',N'',N'10000101',N'',N'',N'',N'',N'',N'',N'',N'0015',N'0001',0,0.000000000000000e+000,N'',N'10000101',N'10000101',N'1000000009',N'',N'N',N'N',-1,-1)
 ,(1000000010,CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'DMTEAM',N'20150629',N'I',N'MRS',N'Dormanen',N'Eleonora',N'',N'19610813',N'',N'',N'M',N'P',N'A',N'N',N'',N'',N'ZA',N'6153',N'M',N'6108135800089',N'',N'',N'',N'',N'',N'',N'1000000010',N'10000101',N'',N'',N'',N'',N'',N'',N'N',N'N',N'C',N'',N'N',N'',N'U',N'ZA',N'G',N'S',N'B',N'',N'',N'',N'',N'',N'10000101',N'',N'',N'',N'',N'',N'',N'',N'0015',N'0001',0,0.000000000000000e+000,N'',N'10000101',N'10000101',N'1000000010',N'',N'N',N'Y',-1,-1)
 ,(1000000011,CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'DMTEAM',N'20150629',N'I',N'',N'Nesset',N'Horace',N'',N'19240316',N'',N'',N'M',N'P',N'A',N'N',N'',N'',N'ZA',N'6153',N'M',N'',N'',N'',N'',N'',N'',N'',N'1000000011',N'10000101',N'',N'',N'',N'',N'',N'',N'N',N'N',N'C',N'',N'N',N'',N'U',N'ZA',N'G',N'O',N'B',N'',N'',N'',N'',N'',N'10000101',N'',N'',N'',N'',N'',N'',N'',N'0015',N'0001',0,0.000000000000000e+000,N'',N'10000101',N'10000101',N'1000000011',N'',N'N',N'N',-1,-1)
 ,(1000000012,CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'DMTEAM',N'20150629',N'I',N'',N'Lunger',N'Walton',N'I',N'19241215',N'',N'',N'F',N'P',N'A',N'N',N'',N'',N'ZA',N'6153',N'M',N'',N'',N'',N'',N'',N'',N'',N'1000000012',N'10000101',N'',N'',N'',N'',N'',N'',N'N',N'N',N'C',N'',N'N',N'',N'U',N'ZA',N'G',N'O',N'B',N'',N'',N'',N'',N'',N'10000101',N'',N'',N'',N'',N'',N'',N'',N'0015',N'0001',0,0.000000000000000e+000,N'',N'10000101',N'10000101',N'1000000012',N'',N'N',N'N',-1,-1)
 ,(1000000013,CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'DMTEAM',N'20150629',N'I',N'MR',N'Glasford',N'Juliana',N'N',N'19550910',N'',N'',N'M',N'P',N'A',N'N',N'',N'',N'ZA',N'6153',N'D',N'',N'',N'',N'',N'',N'',N'',N'1000000013',N'10000101',N'',N'',N'',N'',N'',N'',N'N',N'N',N'C',N'',N'N',N'',N'U',N'ZA',N'G',N'O',N'B',N'',N'',N'',N'',N'',N'10000101',N'',N'',N'',N'',N'',N'',N'',N'0015',N'0001',0,0.000000000000000e+000,N'',N'10000101',N'10000101',N'1000000013',N'',N'N',N'N',-1,-1)
 ,(1000000014,CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'DMTEAM',N'20150629',N'I',N'',N'Smeby',N'Octavio',N'J',N'19610206',N'',N'',N'M',N'P',N'A',N'N',N'',N'',N'ZA',N'6153',N'M',N'',N'',N'',N'',N'',N'',N'',N'1000000014',N'20001101',N'',N'',N'',N'',N'',N'',N'N',N'N',N'C',N'',N'N',N'',N'U',N'ZA',N'G',N'O',N'B',N'',N'',N'',N'',N'',N'10000101',N'',N'',N'',N'',N'',N'',N'',N'0015',N'0001',0,0.000000000000000e+000,N'',N'10000101',N'10000101',N'1000000014',N'',N'N',N'N',-1,-1)
 ,(1000000015,CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'DMTEAM',N'20150629',N'I',N'',N'Rohaley',N'Eric',N'O',N'19621004',N'',N'',N'F',N'P',N'A',N'N',N'',N'',N'ZA',N'6153',N'M',N'',N'',N'',N'',N'',N'',N'',N'1000000015',N'20001101',N'',N'',N'',N'',N'',N'',N'N',N'N',N'C',N'',N'N',N'',N'U',N'ZA',N'G',N'O',N'B',N'',N'',N'',N'',N'',N'10000101',N'',N'',N'',N'',N'',N'',N'',N'0015',N'0001',0,0.000000000000000e+000,N'',N'10000101',N'10000101',N'1000000015',N'',N'N',N'N',-1,-1)
 ,(1000000016,CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'DMTEAM',N'20150629',N'I',N'MRS',N'Spinello',N'Ronnie',N'V',N'19610206',N'',N'',N'M',N'P',N'A',N'N',N'',N'',N'ZA',N'6153',N'M',N'AB513552A',N'',N'',N'',N'',N'',N'',N'1000000016',N'10000101',N'',N'',N'',N'',N'',N'',N'N',N'N',N'C',N'',N'N',N'',N'U',N'ZA',N'G',N'O',N'B',N'',N'',N'',N'',N'',N'10000101',N'',N'',N'',N'',N'',N'',N'',N'0015',N'0001',0,0.000000000000000e+000,N'',N'10000101',N'10000101',N'1000000016',N'',N'N',N'Y',-1,-1)
 ,(1000000017,CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'DMTEAM',N'20150629',N'I',N'',N'Maricle',N'Michell',N'N',N'19700223',N'',N'',N'M',N'P',N'A',N'N',N'',N'',N'ZA',N'6153',N'N',N'AB886173B',N'',N'',N'',N'',N'',N'',N'1000000017',N'10000101',N'',N'',N'',N'',N'',N'',N'N',N'N',N'C',N'',N'N',N'',N'U',N'ZA',N'G',N'O',N'B',N'',N'',N'',N'',N'',N'10000101',N'',N'',N'',N'',N'',N'',N'',N'0015',N'0001',0,0.000000000000000e+000,N'',N'10000101',N'10000101',N'1000000017',N'',N'N',N'Y',-1,-1)
 ,(1000000018,CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'DMTEAM',N'20150629',N'I',N'MS',N'Leadbeater',N'Edwin',N'D',N'19621214',N'',N'',N'M',N'P',N'A',N'N',N'',N'',N'ZA',N'6153',N'N',N'',N'',N'',N'',N'',N'',N'',N'1000000018',N'10000101',N'',N'',N'',N'',N'',N'',N'N',N'N',N'C',N'',N'N',N'',N'U',N'ZA',N'G',N'O',N'B',N'',N'',N'',N'',N'',N'10000101',N'',N'',N'',N'',N'',N'',N'',N'0015',N'0001',0,0.000000000000000e+000,N'',N'10000101',N'10000101',N'1000000018',N'',N'N',N'Y',-1,-1)
 ,(1000000019,CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'DMTEAM',N'20150629',N'I',N'MRS',N'Mchughes',N'Dustin',N'',N'19630316',N'',N'',N'F',N'P',N'A',N'N',N'',N'',N'ZA',N'6153',N'N',N'AB385813B',N'',N'',N'',N'',N'',N'',N'1000000019',N'10000101',N'',N'',N'',N'',N'',N'',N'N',N'N',N'C',N'',N'N',N'',N'U',N'ZA',N'G',N'E',N'B',N'',N'',N'',N'',N'',N'10000101',N'',N'',N'',N'',N'',N'',N'',N'0015',N'0001',0,0.000000000000000e+000,N'',N'10000101',N'10000101',N'1000000019',N'',N'N',N'Y',-1,-1)
) AS [Source] ([ct_client_id],[ct_create_date],[ct_last_updt_date],[ct_last_updt_time],[ct_last_updt_userid],[ct_business_date],[ct_record_status],[ct_title],[ct_surname],[ct_firstname],[ct_middlename],[ct_dob],[ct_soundex_surname],[ct_soundex_firstname],[ct_sex],[ct_type],[ct_status],[ct_mail],[ct_identified],[ct_main_occupation],[ct_nationality],[ct_main_language],[ct_marital_status],[ct_national_id],[ct_place_of_birth],[ct_legal_representative],[ct_contact_correspondence_name],[ct_contact_position],[ct_registered_office_town],[ct_province],[ct_external_reference],[ct_age_admitted_date],[ct_extra_info],[ct_web_uid],[ct_non_resident_date],[ct_company_type],[ct_tax_no],[ct_maiden_name],[ct_web_access],[ct_web_doc_signed],[ct_web_user_level],[ct_web_password],[ct_exempt_from_tax],[ct_validation],[ct_politically_exposed_person],[ct_residence],[ct_territory],[ct_employment_status],[ct_ir_compliance_code],[ct_management_company],[ct_suffix],[ct_other_names],[ct_correspondence_salutation],[ct_correspondence_name],[ct_date_of_death],[ct_estate_name],[ct_country_of_birth],[ct_home_phone],[ct_business_phone],[ct_mobile_phone],[ct_fax],[ct_email],[ct_aml_status],[ct_aml_category],[ct_sequence_id],[ct_pensionable_income],[ct_employer_status],[ct_death_certificate_received_date],[ct_date_death_notified],[ct_fsu_reference],[ct_work_email],[ct_web_invited],[ct_smoker],[sl_system_log_id],[po_transaction_id])
ON ([Target].[ct_client_id] = [Source].[ct_client_id])
WHEN MATCHED AND (
	NULLIF([Source].[ct_last_updt_userid], [Target].[ct_last_updt_userid]) IS NOT NULL OR NULLIF([Target].[ct_last_updt_userid], [Source].[ct_last_updt_userid]) IS NOT NULL OR 
	NULLIF([Source].[ct_business_date], [Target].[ct_business_date]) IS NOT NULL OR NULLIF([Target].[ct_business_date], [Source].[ct_business_date]) IS NOT NULL OR 
	NULLIF([Source].[ct_record_status], [Target].[ct_record_status]) IS NOT NULL OR NULLIF([Target].[ct_record_status], [Source].[ct_record_status]) IS NOT NULL OR 
	NULLIF([Source].[ct_title], [Target].[ct_title]) IS NOT NULL OR NULLIF([Target].[ct_title], [Source].[ct_title]) IS NOT NULL OR 
	NULLIF([Source].[ct_surname], [Target].[ct_surname]) IS NOT NULL OR NULLIF([Target].[ct_surname], [Source].[ct_surname]) IS NOT NULL OR 
	NULLIF([Source].[ct_firstname], [Target].[ct_firstname]) IS NOT NULL OR NULLIF([Target].[ct_firstname], [Source].[ct_firstname]) IS NOT NULL OR 
	NULLIF([Source].[ct_middlename], [Target].[ct_middlename]) IS NOT NULL OR NULLIF([Target].[ct_middlename], [Source].[ct_middlename]) IS NOT NULL OR 
	NULLIF([Source].[ct_dob], [Target].[ct_dob]) IS NOT NULL OR NULLIF([Target].[ct_dob], [Source].[ct_dob]) IS NOT NULL OR 
	NULLIF([Source].[ct_soundex_surname], [Target].[ct_soundex_surname]) IS NOT NULL OR NULLIF([Target].[ct_soundex_surname], [Source].[ct_soundex_surname]) IS NOT NULL OR 
	NULLIF([Source].[ct_soundex_firstname], [Target].[ct_soundex_firstname]) IS NOT NULL OR NULLIF([Target].[ct_soundex_firstname], [Source].[ct_soundex_firstname]) IS NOT NULL OR 
	NULLIF([Source].[ct_sex], [Target].[ct_sex]) IS NOT NULL OR NULLIF([Target].[ct_sex], [Source].[ct_sex]) IS NOT NULL OR 
	NULLIF([Source].[ct_type], [Target].[ct_type]) IS NOT NULL OR NULLIF([Target].[ct_type], [Source].[ct_type]) IS NOT NULL OR 
	NULLIF([Source].[ct_status], [Target].[ct_status]) IS NOT NULL OR NULLIF([Target].[ct_status], [Source].[ct_status]) IS NOT NULL OR 
	NULLIF([Source].[ct_mail], [Target].[ct_mail]) IS NOT NULL OR NULLIF([Target].[ct_mail], [Source].[ct_mail]) IS NOT NULL OR 
	NULLIF([Source].[ct_identified], [Target].[ct_identified]) IS NOT NULL OR NULLIF([Target].[ct_identified], [Source].[ct_identified]) IS NOT NULL OR 
	NULLIF([Source].[ct_main_occupation], [Target].[ct_main_occupation]) IS NOT NULL OR NULLIF([Target].[ct_main_occupation], [Source].[ct_main_occupation]) IS NOT NULL OR 
	NULLIF([Source].[ct_nationality], [Target].[ct_nationality]) IS NOT NULL OR NULLIF([Target].[ct_nationality], [Source].[ct_nationality]) IS NOT NULL OR 
	NULLIF([Source].[ct_main_language], [Target].[ct_main_language]) IS NOT NULL OR NULLIF([Target].[ct_main_language], [Source].[ct_main_language]) IS NOT NULL OR 
	NULLIF([Source].[ct_marital_status], [Target].[ct_marital_status]) IS NOT NULL OR NULLIF([Target].[ct_marital_status], [Source].[ct_marital_status]) IS NOT NULL OR 
	NULLIF([Source].[ct_national_id], [Target].[ct_national_id]) IS NOT NULL OR NULLIF([Target].[ct_national_id], [Source].[ct_national_id]) IS NOT NULL OR 
	NULLIF([Source].[ct_place_of_birth], [Target].[ct_place_of_birth]) IS NOT NULL OR NULLIF([Target].[ct_place_of_birth], [Source].[ct_place_of_birth]) IS NOT NULL OR 
	NULLIF([Source].[ct_legal_representative], [Target].[ct_legal_representative]) IS NOT NULL OR NULLIF([Target].[ct_legal_representative], [Source].[ct_legal_representative]) IS NOT NULL OR 
	NULLIF([Source].[ct_contact_correspondence_name], [Target].[ct_contact_correspondence_name]) IS NOT NULL OR NULLIF([Target].[ct_contact_correspondence_name], [Source].[ct_contact_correspondence_name]) IS NOT NULL OR 
	NULLIF([Source].[ct_contact_position], [Target].[ct_contact_position]) IS NOT NULL OR NULLIF([Target].[ct_contact_position], [Source].[ct_contact_position]) IS NOT NULL OR 
	NULLIF([Source].[ct_registered_office_town], [Target].[ct_registered_office_town]) IS NOT NULL OR NULLIF([Target].[ct_registered_office_town], [Source].[ct_registered_office_town]) IS NOT NULL OR 
	NULLIF([Source].[ct_province], [Target].[ct_province]) IS NOT NULL OR NULLIF([Target].[ct_province], [Source].[ct_province]) IS NOT NULL OR 
	NULLIF([Source].[ct_external_reference], [Target].[ct_external_reference]) IS NOT NULL OR NULLIF([Target].[ct_external_reference], [Source].[ct_external_reference]) IS NOT NULL OR 
	NULLIF([Source].[ct_age_admitted_date], [Target].[ct_age_admitted_date]) IS NOT NULL OR NULLIF([Target].[ct_age_admitted_date], [Source].[ct_age_admitted_date]) IS NOT NULL OR 
	NULLIF([Source].[ct_extra_info], [Target].[ct_extra_info]) IS NOT NULL OR NULLIF([Target].[ct_extra_info], [Source].[ct_extra_info]) IS NOT NULL OR 
	NULLIF([Source].[ct_web_uid], [Target].[ct_web_uid]) IS NOT NULL OR NULLIF([Target].[ct_web_uid], [Source].[ct_web_uid]) IS NOT NULL OR 
	NULLIF([Source].[ct_non_resident_date], [Target].[ct_non_resident_date]) IS NOT NULL OR NULLIF([Target].[ct_non_resident_date], [Source].[ct_non_resident_date]) IS NOT NULL OR 
	NULLIF([Source].[ct_company_type], [Target].[ct_company_type]) IS NOT NULL OR NULLIF([Target].[ct_company_type], [Source].[ct_company_type]) IS NOT NULL OR 
	NULLIF([Source].[ct_tax_no], [Target].[ct_tax_no]) IS NOT NULL OR NULLIF([Target].[ct_tax_no], [Source].[ct_tax_no]) IS NOT NULL OR 
	NULLIF([Source].[ct_maiden_name], [Target].[ct_maiden_name]) IS NOT NULL OR NULLIF([Target].[ct_maiden_name], [Source].[ct_maiden_name]) IS NOT NULL OR 
	NULLIF([Source].[ct_web_access], [Target].[ct_web_access]) IS NOT NULL OR NULLIF([Target].[ct_web_access], [Source].[ct_web_access]) IS NOT NULL OR 
	NULLIF([Source].[ct_web_doc_signed], [Target].[ct_web_doc_signed]) IS NOT NULL OR NULLIF([Target].[ct_web_doc_signed], [Source].[ct_web_doc_signed]) IS NOT NULL OR 
	NULLIF([Source].[ct_web_user_level], [Target].[ct_web_user_level]) IS NOT NULL OR NULLIF([Target].[ct_web_user_level], [Source].[ct_web_user_level]) IS NOT NULL OR 
	NULLIF([Source].[ct_web_password], [Target].[ct_web_password]) IS NOT NULL OR NULLIF([Target].[ct_web_password], [Source].[ct_web_password]) IS NOT NULL OR 
	NULLIF([Source].[ct_exempt_from_tax], [Target].[ct_exempt_from_tax]) IS NOT NULL OR NULLIF([Target].[ct_exempt_from_tax], [Source].[ct_exempt_from_tax]) IS NOT NULL OR 
	NULLIF([Source].[ct_validation], [Target].[ct_validation]) IS NOT NULL OR NULLIF([Target].[ct_validation], [Source].[ct_validation]) IS NOT NULL OR 
	NULLIF([Source].[ct_politically_exposed_person], [Target].[ct_politically_exposed_person]) IS NOT NULL OR NULLIF([Target].[ct_politically_exposed_person], [Source].[ct_politically_exposed_person]) IS NOT NULL OR 
	NULLIF([Source].[ct_residence], [Target].[ct_residence]) IS NOT NULL OR NULLIF([Target].[ct_residence], [Source].[ct_residence]) IS NOT NULL OR 
	NULLIF([Source].[ct_territory], [Target].[ct_territory]) IS NOT NULL OR NULLIF([Target].[ct_territory], [Source].[ct_territory]) IS NOT NULL OR 
	NULLIF([Source].[ct_employment_status], [Target].[ct_employment_status]) IS NOT NULL OR NULLIF([Target].[ct_employment_status], [Source].[ct_employment_status]) IS NOT NULL OR 
	NULLIF([Source].[ct_ir_compliance_code], [Target].[ct_ir_compliance_code]) IS NOT NULL OR NULLIF([Target].[ct_ir_compliance_code], [Source].[ct_ir_compliance_code]) IS NOT NULL OR 
	NULLIF([Source].[ct_management_company], [Target].[ct_management_company]) IS NOT NULL OR NULLIF([Target].[ct_management_company], [Source].[ct_management_company]) IS NOT NULL OR 
	NULLIF([Source].[ct_suffix], [Target].[ct_suffix]) IS NOT NULL OR NULLIF([Target].[ct_suffix], [Source].[ct_suffix]) IS NOT NULL OR 
	NULLIF([Source].[ct_other_names], [Target].[ct_other_names]) IS NOT NULL OR NULLIF([Target].[ct_other_names], [Source].[ct_other_names]) IS NOT NULL OR 
	NULLIF([Source].[ct_correspondence_salutation], [Target].[ct_correspondence_salutation]) IS NOT NULL OR NULLIF([Target].[ct_correspondence_salutation], [Source].[ct_correspondence_salutation]) IS NOT NULL OR 
	NULLIF([Source].[ct_correspondence_name], [Target].[ct_correspondence_name]) IS NOT NULL OR NULLIF([Target].[ct_correspondence_name], [Source].[ct_correspondence_name]) IS NOT NULL OR 
	NULLIF([Source].[ct_date_of_death], [Target].[ct_date_of_death]) IS NOT NULL OR NULLIF([Target].[ct_date_of_death], [Source].[ct_date_of_death]) IS NOT NULL OR 
	NULLIF([Source].[ct_estate_name], [Target].[ct_estate_name]) IS NOT NULL OR NULLIF([Target].[ct_estate_name], [Source].[ct_estate_name]) IS NOT NULL OR 
	NULLIF([Source].[ct_country_of_birth], [Target].[ct_country_of_birth]) IS NOT NULL OR NULLIF([Target].[ct_country_of_birth], [Source].[ct_country_of_birth]) IS NOT NULL OR 
	NULLIF([Source].[ct_home_phone], [Target].[ct_home_phone]) IS NOT NULL OR NULLIF([Target].[ct_home_phone], [Source].[ct_home_phone]) IS NOT NULL OR 
	NULLIF([Source].[ct_business_phone], [Target].[ct_business_phone]) IS NOT NULL OR NULLIF([Target].[ct_business_phone], [Source].[ct_business_phone]) IS NOT NULL OR 
	NULLIF([Source].[ct_mobile_phone], [Target].[ct_mobile_phone]) IS NOT NULL OR NULLIF([Target].[ct_mobile_phone], [Source].[ct_mobile_phone]) IS NOT NULL OR 
	NULLIF([Source].[ct_fax], [Target].[ct_fax]) IS NOT NULL OR NULLIF([Target].[ct_fax], [Source].[ct_fax]) IS NOT NULL OR 
	NULLIF([Source].[ct_email], [Target].[ct_email]) IS NOT NULL OR NULLIF([Target].[ct_email], [Source].[ct_email]) IS NOT NULL OR 
	NULLIF([Source].[ct_aml_status], [Target].[ct_aml_status]) IS NOT NULL OR NULLIF([Target].[ct_aml_status], [Source].[ct_aml_status]) IS NOT NULL OR 
	NULLIF([Source].[ct_aml_category], [Target].[ct_aml_category]) IS NOT NULL OR NULLIF([Target].[ct_aml_category], [Source].[ct_aml_category]) IS NOT NULL OR 
	NULLIF([Source].[ct_sequence_id], [Target].[ct_sequence_id]) IS NOT NULL OR NULLIF([Target].[ct_sequence_id], [Source].[ct_sequence_id]) IS NOT NULL OR 
	NULLIF([Source].[ct_pensionable_income], [Target].[ct_pensionable_income]) IS NOT NULL OR NULLIF([Target].[ct_pensionable_income], [Source].[ct_pensionable_income]) IS NOT NULL OR 
	NULLIF([Source].[ct_employer_status], [Target].[ct_employer_status]) IS NOT NULL OR NULLIF([Target].[ct_employer_status], [Source].[ct_employer_status]) IS NOT NULL OR 
	NULLIF([Source].[ct_death_certificate_received_date], [Target].[ct_death_certificate_received_date]) IS NOT NULL OR NULLIF([Target].[ct_death_certificate_received_date], [Source].[ct_death_certificate_received_date]) IS NOT NULL OR 
	NULLIF([Source].[ct_date_death_notified], [Target].[ct_date_death_notified]) IS NOT NULL OR NULLIF([Target].[ct_date_death_notified], [Source].[ct_date_death_notified]) IS NOT NULL OR 
	NULLIF([Source].[ct_fsu_reference], [Target].[ct_fsu_reference]) IS NOT NULL OR NULLIF([Target].[ct_fsu_reference], [Source].[ct_fsu_reference]) IS NOT NULL OR 
	NULLIF([Source].[ct_work_email], [Target].[ct_work_email]) IS NOT NULL OR NULLIF([Target].[ct_work_email], [Source].[ct_work_email]) IS NOT NULL OR 
	NULLIF([Source].[ct_web_invited], [Target].[ct_web_invited]) IS NOT NULL OR NULLIF([Target].[ct_web_invited], [Source].[ct_web_invited]) IS NOT NULL OR 
	NULLIF([Source].[ct_smoker], [Target].[ct_smoker]) IS NOT NULL OR NULLIF([Target].[ct_smoker], [Source].[ct_smoker]) IS NOT NULL OR 
	NULLIF([Source].[sl_system_log_id], [Target].[sl_system_log_id]) IS NOT NULL OR NULLIF([Target].[sl_system_log_id], [Source].[sl_system_log_id]) IS NOT NULL OR 
	NULLIF([Source].[po_transaction_id], [Target].[po_transaction_id]) IS NOT NULL OR NULLIF([Target].[po_transaction_id], [Source].[po_transaction_id]) IS NOT NULL) THEN
 UPDATE SET
  [Target].[ct_last_updt_date] = [Source].[ct_last_updt_date], 
  [Target].[ct_last_updt_time] = [Source].[ct_last_updt_time], 
  [Target].[ct_last_updt_userid] = [Source].[ct_last_updt_userid], 
  [Target].[ct_business_date] = [Source].[ct_business_date], 
  [Target].[ct_record_status] = [Source].[ct_record_status], 
  [Target].[ct_title] = [Source].[ct_title], 
  [Target].[ct_surname] = [Source].[ct_surname], 
  [Target].[ct_firstname] = [Source].[ct_firstname], 
  [Target].[ct_middlename] = [Source].[ct_middlename], 
  [Target].[ct_dob] = [Source].[ct_dob], 
  [Target].[ct_soundex_surname] = [Source].[ct_soundex_surname], 
  [Target].[ct_soundex_firstname] = [Source].[ct_soundex_firstname], 
  [Target].[ct_sex] = [Source].[ct_sex], 
  [Target].[ct_type] = [Source].[ct_type], 
  [Target].[ct_status] = [Source].[ct_status], 
  [Target].[ct_mail] = [Source].[ct_mail], 
  [Target].[ct_identified] = [Source].[ct_identified], 
  [Target].[ct_main_occupation] = [Source].[ct_main_occupation], 
  [Target].[ct_nationality] = [Source].[ct_nationality], 
  [Target].[ct_main_language] = [Source].[ct_main_language], 
  [Target].[ct_marital_status] = [Source].[ct_marital_status], 
  [Target].[ct_national_id] = [Source].[ct_national_id], 
  [Target].[ct_place_of_birth] = [Source].[ct_place_of_birth], 
  [Target].[ct_legal_representative] = [Source].[ct_legal_representative], 
  [Target].[ct_contact_correspondence_name] = [Source].[ct_contact_correspondence_name], 
  [Target].[ct_contact_position] = [Source].[ct_contact_position], 
  [Target].[ct_registered_office_town] = [Source].[ct_registered_office_town], 
  [Target].[ct_province] = [Source].[ct_province], 
  [Target].[ct_external_reference] = [Source].[ct_external_reference], 
  [Target].[ct_age_admitted_date] = [Source].[ct_age_admitted_date], 
  [Target].[ct_extra_info] = [Source].[ct_extra_info], 
  [Target].[ct_web_uid] = [Source].[ct_web_uid], 
  [Target].[ct_non_resident_date] = [Source].[ct_non_resident_date], 
  [Target].[ct_company_type] = [Source].[ct_company_type], 
  [Target].[ct_tax_no] = [Source].[ct_tax_no], 
  [Target].[ct_maiden_name] = [Source].[ct_maiden_name], 
  [Target].[ct_web_access] = [Source].[ct_web_access], 
  [Target].[ct_web_doc_signed] = [Source].[ct_web_doc_signed], 
  [Target].[ct_web_user_level] = [Source].[ct_web_user_level], 
  [Target].[ct_web_password] = [Source].[ct_web_password], 
  [Target].[ct_exempt_from_tax] = [Source].[ct_exempt_from_tax], 
  [Target].[ct_validation] = [Source].[ct_validation], 
  [Target].[ct_politically_exposed_person] = [Source].[ct_politically_exposed_person], 
  [Target].[ct_residence] = [Source].[ct_residence], 
  [Target].[ct_territory] = [Source].[ct_territory], 
  [Target].[ct_employment_status] = [Source].[ct_employment_status], 
  [Target].[ct_ir_compliance_code] = [Source].[ct_ir_compliance_code], 
  [Target].[ct_management_company] = [Source].[ct_management_company], 
  [Target].[ct_suffix] = [Source].[ct_suffix], 
  [Target].[ct_other_names] = [Source].[ct_other_names], 
  [Target].[ct_correspondence_salutation] = [Source].[ct_correspondence_salutation], 
  [Target].[ct_correspondence_name] = [Source].[ct_correspondence_name], 
  [Target].[ct_date_of_death] = [Source].[ct_date_of_death], 
  [Target].[ct_estate_name] = [Source].[ct_estate_name], 
  [Target].[ct_country_of_birth] = [Source].[ct_country_of_birth], 
  [Target].[ct_home_phone] = [Source].[ct_home_phone], 
  [Target].[ct_business_phone] = [Source].[ct_business_phone], 
  [Target].[ct_mobile_phone] = [Source].[ct_mobile_phone], 
  [Target].[ct_fax] = [Source].[ct_fax], 
  [Target].[ct_email] = [Source].[ct_email], 
  [Target].[ct_aml_status] = [Source].[ct_aml_status], 
  [Target].[ct_aml_category] = [Source].[ct_aml_category], 
  [Target].[ct_sequence_id] = [Source].[ct_sequence_id], 
  [Target].[ct_pensionable_income] = [Source].[ct_pensionable_income], 
  [Target].[ct_employer_status] = [Source].[ct_employer_status], 
  [Target].[ct_death_certificate_received_date] = [Source].[ct_death_certificate_received_date], 
  [Target].[ct_date_death_notified] = [Source].[ct_date_death_notified], 
  [Target].[ct_fsu_reference] = [Source].[ct_fsu_reference], 
  [Target].[ct_work_email] = [Source].[ct_work_email], 
  [Target].[ct_web_invited] = [Source].[ct_web_invited], 
  [Target].[ct_smoker] = [Source].[ct_smoker], 
  [Target].[sl_system_log_id] = [Source].[sl_system_log_id], 
  [Target].[po_transaction_id] = [Source].[po_transaction_id]
WHEN NOT MATCHED BY TARGET THEN
 INSERT([ct_client_id],[ct_create_date],[ct_last_updt_date],[ct_last_updt_time],[ct_last_updt_userid],[ct_business_date],[ct_record_status],[ct_title],[ct_surname],[ct_firstname],[ct_middlename],[ct_dob],[ct_soundex_surname],[ct_soundex_firstname],[ct_sex],[ct_type],[ct_status],[ct_mail],[ct_identified],[ct_main_occupation],[ct_nationality],[ct_main_language],[ct_marital_status],[ct_national_id],[ct_place_of_birth],[ct_legal_representative],[ct_contact_correspondence_name],[ct_contact_position],[ct_registered_office_town],[ct_province],[ct_external_reference],[ct_age_admitted_date],[ct_extra_info],[ct_web_uid],[ct_non_resident_date],[ct_company_type],[ct_tax_no],[ct_maiden_name],[ct_web_access],[ct_web_doc_signed],[ct_web_user_level],[ct_web_password],[ct_exempt_from_tax],[ct_validation],[ct_politically_exposed_person],[ct_residence],[ct_territory],[ct_employment_status],[ct_ir_compliance_code],[ct_management_company],[ct_suffix],[ct_other_names],[ct_correspondence_salutation],[ct_correspondence_name],[ct_date_of_death],[ct_estate_name],[ct_country_of_birth],[ct_home_phone],[ct_business_phone],[ct_mobile_phone],[ct_fax],[ct_email],[ct_aml_status],[ct_aml_category],[ct_sequence_id],[ct_pensionable_income],[ct_employer_status],[ct_death_certificate_received_date],[ct_date_death_notified],[ct_fsu_reference],[ct_work_email],[ct_web_invited],[ct_smoker],[sl_system_log_id],[po_transaction_id])
 VALUES([Source].[ct_client_id],[Source].[ct_create_date],[Source].[ct_last_updt_date],[Source].[ct_last_updt_time],[Source].[ct_last_updt_userid],[Source].[ct_business_date],[Source].[ct_record_status],[Source].[ct_title],[Source].[ct_surname],[Source].[ct_firstname],[Source].[ct_middlename],[Source].[ct_dob],[Source].[ct_soundex_surname],[Source].[ct_soundex_firstname],[Source].[ct_sex],[Source].[ct_type],[Source].[ct_status],[Source].[ct_mail],[Source].[ct_identified],[Source].[ct_main_occupation],[Source].[ct_nationality],[Source].[ct_main_language],[Source].[ct_marital_status],[Source].[ct_national_id],[Source].[ct_place_of_birth],[Source].[ct_legal_representative],[Source].[ct_contact_correspondence_name],[Source].[ct_contact_position],[Source].[ct_registered_office_town],[Source].[ct_province],[Source].[ct_external_reference],[Source].[ct_age_admitted_date],[Source].[ct_extra_info],[Source].[ct_web_uid],[Source].[ct_non_resident_date],[Source].[ct_company_type],[Source].[ct_tax_no],[Source].[ct_maiden_name],[Source].[ct_web_access],[Source].[ct_web_doc_signed],[Source].[ct_web_user_level],[Source].[ct_web_password],[Source].[ct_exempt_from_tax],[Source].[ct_validation],[Source].[ct_politically_exposed_person],[Source].[ct_residence],[Source].[ct_territory],[Source].[ct_employment_status],[Source].[ct_ir_compliance_code],[Source].[ct_management_company],[Source].[ct_suffix],[Source].[ct_other_names],[Source].[ct_correspondence_salutation],[Source].[ct_correspondence_name],[Source].[ct_date_of_death],[Source].[ct_estate_name],[Source].[ct_country_of_birth],[Source].[ct_home_phone],[Source].[ct_business_phone],[Source].[ct_mobile_phone],[Source].[ct_fax],[Source].[ct_email],[Source].[ct_aml_status],[Source].[ct_aml_category],[Source].[ct_sequence_id],[Source].[ct_pensionable_income],[Source].[ct_employer_status],[Source].[ct_death_certificate_received_date],[Source].[ct_date_death_notified],[Source].[ct_fsu_reference],[Source].[ct_work_email],[Source].[ct_web_invited],[Source].[ct_smoker],[Source].[sl_system_log_id],[Source].[po_transaction_id]);
 
IF @mergeError != 0 
BEGIN 
PRINT 'ERROR OCCURRED IN MERGE FOR ct_client.sql. Rows affected: ' + CAST(@mergeCount AS VARCHAR(100)); -- SQL should always return zero rows affected 
END 
ELSE IF @mergeCount > 0 
BEGIN 
PRINT 'ct_client.sql rows affected by MERGE: ' + CAST(@mergeCount AS VARCHAR(100)); 
END 
 
PRINT 'Include cy_company.sql' 
MERGE INTO [cy_company] AS [Target]
USING (VALUES
  (1,CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'Oval',N'20130101',N'I',1,1)
) AS [Source] ([cy_company_id],[cy_create_date],[cy_last_updt_date],[cy_last_updt_time],[cy_last_updt_userid],[cy_business_date],[cy_record_status],[ct_client_id],[ad_address_id])
ON ([Target].[cy_company_id] = [Source].[cy_company_id])
WHEN MATCHED AND (
	NULLIF([Source].[cy_last_updt_userid], [Target].[cy_last_updt_userid]) IS NOT NULL OR NULLIF([Target].[cy_last_updt_userid], [Source].[cy_last_updt_userid]) IS NOT NULL OR 
	NULLIF([Source].[cy_business_date], [Target].[cy_business_date]) IS NOT NULL OR NULLIF([Target].[cy_business_date], [Source].[cy_business_date]) IS NOT NULL OR 
	NULLIF([Source].[cy_record_status], [Target].[cy_record_status]) IS NOT NULL OR NULLIF([Target].[cy_record_status], [Source].[cy_record_status]) IS NOT NULL OR 
	NULLIF([Source].[ct_client_id], [Target].[ct_client_id]) IS NOT NULL OR NULLIF([Target].[ct_client_id], [Source].[ct_client_id]) IS NOT NULL OR 
	NULLIF([Source].[ad_address_id], [Target].[ad_address_id]) IS NOT NULL OR NULLIF([Target].[ad_address_id], [Source].[ad_address_id]) IS NOT NULL) THEN
 UPDATE SET
  [Target].[cy_last_updt_date] = [Source].[cy_last_updt_date], 
  [Target].[cy_last_updt_time] = [Source].[cy_last_updt_time], 
  [Target].[cy_last_updt_userid] = [Source].[cy_last_updt_userid], 
  [Target].[cy_business_date] = [Source].[cy_business_date], 
  [Target].[cy_record_status] = [Source].[cy_record_status], 
  [Target].[ct_client_id] = [Source].[ct_client_id], 
  [Target].[ad_address_id] = [Source].[ad_address_id]
WHEN NOT MATCHED BY TARGET THEN
 INSERT([cy_company_id],[cy_create_date],[cy_last_updt_date],[cy_last_updt_time],[cy_last_updt_userid],[cy_business_date],[cy_record_status],[ct_client_id],[ad_address_id])
 VALUES([Source].[cy_company_id],[Source].[cy_create_date],[Source].[cy_last_updt_date],[Source].[cy_last_updt_time],[Source].[cy_last_updt_userid],[Source].[cy_business_date],[Source].[cy_record_status],[Source].[ct_client_id],[Source].[ad_address_id]);
 
IF @mergeError != 0 
BEGIN 
PRINT 'ERROR OCCURRED IN MERGE FOR cy_company.sql. Rows affected: ' + CAST(@mergeCount AS VARCHAR(100)); -- SQL should always return zero rows affected 
END 
ELSE IF @mergeCount > 0 
BEGIN 
PRINT 'cy_company.sql rows affected by MERGE: ' + CAST(@mergeCount AS VARCHAR(100)); 
END 
 
PRINT 'Include fd_fund.sql' 
MERGE INTO [fd_fund] AS [Target]
USING (VALUES
  (N'1',N'A',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'sysman',N'20120904',N'I',1,1,N'20221019',N'20221020',0.000000000000,N'000000',N'000000',N'20221019',N'20221019',N'ZAR',0.000000000000,0.000000000000,N'N',N'1',N'10000101',N'10000101',N'10000101',N'20120427',N'10000101',0.000000000000,N'E',N'DEF',0.000000000000000e+000,0,0.000000000000000e+000,N'',0,N'',N'99991231')
) AS [Source] ([fd_fund_id],[fd_fund_type],[fd_create_date],[fd_last_updt_date],[fd_last_updt_time],[fd_last_updt_userid],[fd_business_date],[fd_record_status],[fd_last_bid_price],[fd_last_offer_price],[fd_last_price_date],[fd_next_price_date],[fd_total_no_units],[fd_last_price_time],[fd_next_price_time],[fd_last_expected_price_date],[fd_last_expected_sell_price_date],[fd_currency],[fd_last_asset_offer_price],[fd_last_asset_bid_price],[rule_fu_whole_units],[fd_rule_fund_id],[fd_freq_change_next_price_date],[fd_next_trade_cutoff_date],[fd_next_disinvestment_notice_date],[fd_last_trade_cutoff_date],[fd_last_disinvestment_notice_date],[fd_nominal_no_of_units],[fd_rule_fund_group],[fd_fund_classification],[fd_portfolio_cash],[fd_portfolio_num_assets],[fd_portfolio_last_value],[fd_portfolio_external_id],[fd_portfolio_num_accounts],[fd_fu_gl_code],[fd_closed_date])
ON ([Target].[fd_fund_id] = [Source].[fd_fund_id] AND [Target].[fd_fund_type] = [Source].[fd_fund_type])
WHEN MATCHED AND (
	NULLIF([Source].[fd_last_updt_userid], [Target].[fd_last_updt_userid]) IS NOT NULL OR NULLIF([Target].[fd_last_updt_userid], [Source].[fd_last_updt_userid]) IS NOT NULL OR 
	NULLIF([Source].[fd_business_date], [Target].[fd_business_date]) IS NOT NULL OR NULLIF([Target].[fd_business_date], [Source].[fd_business_date]) IS NOT NULL OR 
	NULLIF([Source].[fd_record_status], [Target].[fd_record_status]) IS NOT NULL OR NULLIF([Target].[fd_record_status], [Source].[fd_record_status]) IS NOT NULL OR 
	NULLIF([Source].[fd_last_bid_price], [Target].[fd_last_bid_price]) IS NOT NULL OR NULLIF([Target].[fd_last_bid_price], [Source].[fd_last_bid_price]) IS NOT NULL OR 
	NULLIF([Source].[fd_last_offer_price], [Target].[fd_last_offer_price]) IS NOT NULL OR NULLIF([Target].[fd_last_offer_price], [Source].[fd_last_offer_price]) IS NOT NULL OR 
	NULLIF([Source].[fd_last_price_date], [Target].[fd_last_price_date]) IS NOT NULL OR NULLIF([Target].[fd_last_price_date], [Source].[fd_last_price_date]) IS NOT NULL OR 
	NULLIF([Source].[fd_next_price_date], [Target].[fd_next_price_date]) IS NOT NULL OR NULLIF([Target].[fd_next_price_date], [Source].[fd_next_price_date]) IS NOT NULL OR 
	NULLIF([Source].[fd_total_no_units], [Target].[fd_total_no_units]) IS NOT NULL OR NULLIF([Target].[fd_total_no_units], [Source].[fd_total_no_units]) IS NOT NULL OR 
	NULLIF([Source].[fd_last_price_time], [Target].[fd_last_price_time]) IS NOT NULL OR NULLIF([Target].[fd_last_price_time], [Source].[fd_last_price_time]) IS NOT NULL OR 
	NULLIF([Source].[fd_next_price_time], [Target].[fd_next_price_time]) IS NOT NULL OR NULLIF([Target].[fd_next_price_time], [Source].[fd_next_price_time]) IS NOT NULL OR 
	NULLIF([Source].[fd_last_expected_price_date], [Target].[fd_last_expected_price_date]) IS NOT NULL OR NULLIF([Target].[fd_last_expected_price_date], [Source].[fd_last_expected_price_date]) IS NOT NULL OR 
	NULLIF([Source].[fd_last_expected_sell_price_date], [Target].[fd_last_expected_sell_price_date]) IS NOT NULL OR NULLIF([Target].[fd_last_expected_sell_price_date], [Source].[fd_last_expected_sell_price_date]) IS NOT NULL OR 
	NULLIF([Source].[fd_currency], [Target].[fd_currency]) IS NOT NULL OR NULLIF([Target].[fd_currency], [Source].[fd_currency]) IS NOT NULL OR 
	NULLIF([Source].[fd_last_asset_offer_price], [Target].[fd_last_asset_offer_price]) IS NOT NULL OR NULLIF([Target].[fd_last_asset_offer_price], [Source].[fd_last_asset_offer_price]) IS NOT NULL OR 
	NULLIF([Source].[fd_last_asset_bid_price], [Target].[fd_last_asset_bid_price]) IS NOT NULL OR NULLIF([Target].[fd_last_asset_bid_price], [Source].[fd_last_asset_bid_price]) IS NOT NULL OR 
	NULLIF([Source].[rule_fu_whole_units], [Target].[rule_fu_whole_units]) IS NOT NULL OR NULLIF([Target].[rule_fu_whole_units], [Source].[rule_fu_whole_units]) IS NOT NULL OR 
	NULLIF([Source].[fd_rule_fund_id], [Target].[fd_rule_fund_id]) IS NOT NULL OR NULLIF([Target].[fd_rule_fund_id], [Source].[fd_rule_fund_id]) IS NOT NULL OR 
	NULLIF([Source].[fd_freq_change_next_price_date], [Target].[fd_freq_change_next_price_date]) IS NOT NULL OR NULLIF([Target].[fd_freq_change_next_price_date], [Source].[fd_freq_change_next_price_date]) IS NOT NULL OR 
	NULLIF([Source].[fd_next_trade_cutoff_date], [Target].[fd_next_trade_cutoff_date]) IS NOT NULL OR NULLIF([Target].[fd_next_trade_cutoff_date], [Source].[fd_next_trade_cutoff_date]) IS NOT NULL OR 
	NULLIF([Source].[fd_next_disinvestment_notice_date], [Target].[fd_next_disinvestment_notice_date]) IS NOT NULL OR NULLIF([Target].[fd_next_disinvestment_notice_date], [Source].[fd_next_disinvestment_notice_date]) IS NOT NULL OR 
	NULLIF([Source].[fd_last_trade_cutoff_date], [Target].[fd_last_trade_cutoff_date]) IS NOT NULL OR NULLIF([Target].[fd_last_trade_cutoff_date], [Source].[fd_last_trade_cutoff_date]) IS NOT NULL OR 
	NULLIF([Source].[fd_last_disinvestment_notice_date], [Target].[fd_last_disinvestment_notice_date]) IS NOT NULL OR NULLIF([Target].[fd_last_disinvestment_notice_date], [Source].[fd_last_disinvestment_notice_date]) IS NOT NULL OR 
	NULLIF([Source].[fd_nominal_no_of_units], [Target].[fd_nominal_no_of_units]) IS NOT NULL OR NULLIF([Target].[fd_nominal_no_of_units], [Source].[fd_nominal_no_of_units]) IS NOT NULL OR 
	NULLIF([Source].[fd_rule_fund_group], [Target].[fd_rule_fund_group]) IS NOT NULL OR NULLIF([Target].[fd_rule_fund_group], [Source].[fd_rule_fund_group]) IS NOT NULL OR 
	NULLIF([Source].[fd_fund_classification], [Target].[fd_fund_classification]) IS NOT NULL OR NULLIF([Target].[fd_fund_classification], [Source].[fd_fund_classification]) IS NOT NULL OR 
	NULLIF([Source].[fd_portfolio_cash], [Target].[fd_portfolio_cash]) IS NOT NULL OR NULLIF([Target].[fd_portfolio_cash], [Source].[fd_portfolio_cash]) IS NOT NULL OR 
	NULLIF([Source].[fd_portfolio_num_assets], [Target].[fd_portfolio_num_assets]) IS NOT NULL OR NULLIF([Target].[fd_portfolio_num_assets], [Source].[fd_portfolio_num_assets]) IS NOT NULL OR 
	NULLIF([Source].[fd_portfolio_last_value], [Target].[fd_portfolio_last_value]) IS NOT NULL OR NULLIF([Target].[fd_portfolio_last_value], [Source].[fd_portfolio_last_value]) IS NOT NULL OR 
	NULLIF([Source].[fd_portfolio_external_id], [Target].[fd_portfolio_external_id]) IS NOT NULL OR NULLIF([Target].[fd_portfolio_external_id], [Source].[fd_portfolio_external_id]) IS NOT NULL OR 
	NULLIF([Source].[fd_portfolio_num_accounts], [Target].[fd_portfolio_num_accounts]) IS NOT NULL OR NULLIF([Target].[fd_portfolio_num_accounts], [Source].[fd_portfolio_num_accounts]) IS NOT NULL OR 
	NULLIF([Source].[fd_fu_gl_code], [Target].[fd_fu_gl_code]) IS NOT NULL OR NULLIF([Target].[fd_fu_gl_code], [Source].[fd_fu_gl_code]) IS NOT NULL OR 
	NULLIF([Source].[fd_closed_date], [Target].[fd_closed_date]) IS NOT NULL OR NULLIF([Target].[fd_closed_date], [Source].[fd_closed_date]) IS NOT NULL) THEN
 UPDATE SET
  [Target].[fd_last_updt_date] = CONVERT(CHAR(8),GETDATE(),112), 
  [Target].[fd_last_updt_time] = RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')), 
  [Target].[fd_last_updt_userid] = [Source].[fd_last_updt_userid], 
  [Target].[fd_business_date] = [Source].[fd_business_date], 
  [Target].[fd_record_status] = [Source].[fd_record_status], 
  [Target].[fd_last_bid_price] = [Source].[fd_last_bid_price], 
  [Target].[fd_last_offer_price] = [Source].[fd_last_offer_price], 
  [Target].[fd_last_price_date] = [Source].[fd_last_price_date], 
  [Target].[fd_next_price_date] = [Source].[fd_next_price_date], 
  [Target].[fd_total_no_units] = [Source].[fd_total_no_units], 
  [Target].[fd_last_price_time] = [Source].[fd_last_price_time], 
  [Target].[fd_next_price_time] = [Source].[fd_next_price_time], 
  [Target].[fd_last_expected_price_date] = [Source].[fd_last_expected_price_date], 
  [Target].[fd_last_expected_sell_price_date] = [Source].[fd_last_expected_sell_price_date], 
  [Target].[fd_currency] = [Source].[fd_currency], 
  [Target].[fd_last_asset_offer_price] = [Source].[fd_last_asset_offer_price], 
  [Target].[fd_last_asset_bid_price] = [Source].[fd_last_asset_bid_price], 
  [Target].[rule_fu_whole_units] = [Source].[rule_fu_whole_units], 
  [Target].[fd_rule_fund_id] = [Source].[fd_rule_fund_id], 
  [Target].[fd_freq_change_next_price_date] = [Source].[fd_freq_change_next_price_date], 
  [Target].[fd_next_trade_cutoff_date] = [Source].[fd_next_trade_cutoff_date], 
  [Target].[fd_next_disinvestment_notice_date] = [Source].[fd_next_disinvestment_notice_date], 
  [Target].[fd_last_trade_cutoff_date] = [Source].[fd_last_trade_cutoff_date], 
  [Target].[fd_last_disinvestment_notice_date] = [Source].[fd_last_disinvestment_notice_date], 
  [Target].[fd_nominal_no_of_units] = [Source].[fd_nominal_no_of_units], 
  [Target].[fd_rule_fund_group] = [Source].[fd_rule_fund_group], 
  [Target].[fd_fund_classification] = [Source].[fd_fund_classification], 
  [Target].[fd_portfolio_cash] = [Source].[fd_portfolio_cash], 
  [Target].[fd_portfolio_num_assets] = [Source].[fd_portfolio_num_assets], 
  [Target].[fd_portfolio_last_value] = [Source].[fd_portfolio_last_value], 
  [Target].[fd_portfolio_external_id] = [Source].[fd_portfolio_external_id], 
  [Target].[fd_portfolio_num_accounts] = [Source].[fd_portfolio_num_accounts], 
  [Target].[fd_fu_gl_code] = [Source].[fd_fu_gl_code], 
  [Target].[fd_closed_date] = [Source].[fd_closed_date]
WHEN NOT MATCHED BY TARGET THEN
 INSERT([fd_fund_id],[fd_fund_type],[fd_create_date],[fd_last_updt_date],[fd_last_updt_time],[fd_last_updt_userid],[fd_business_date],[fd_record_status],[fd_last_bid_price],[fd_last_offer_price],[fd_last_price_date],[fd_next_price_date],[fd_total_no_units],[fd_last_price_time],[fd_next_price_time],[fd_last_expected_price_date],[fd_last_expected_sell_price_date],[fd_currency],[fd_last_asset_offer_price],[fd_last_asset_bid_price],[rule_fu_whole_units],[fd_rule_fund_id],[fd_freq_change_next_price_date],[fd_next_trade_cutoff_date],[fd_next_disinvestment_notice_date],[fd_last_trade_cutoff_date],[fd_last_disinvestment_notice_date],[fd_nominal_no_of_units],[fd_rule_fund_group],[fd_fund_classification],[fd_portfolio_cash],[fd_portfolio_num_assets],[fd_portfolio_last_value],[fd_portfolio_external_id],[fd_portfolio_num_accounts],[fd_fu_gl_code],[fd_closed_date])
 VALUES([Source].[fd_fund_id],[Source].[fd_fund_type],CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),[Source].[fd_last_updt_userid],[Source].[fd_business_date],[Source].[fd_record_status],[Source].[fd_last_bid_price],[Source].[fd_last_offer_price],[Source].[fd_last_price_date],[Source].[fd_next_price_date],[Source].[fd_total_no_units],[Source].[fd_last_price_time],[Source].[fd_next_price_time],[Source].[fd_last_expected_price_date],[Source].[fd_last_expected_sell_price_date],[Source].[fd_currency],[Source].[fd_last_asset_offer_price],[Source].[fd_last_asset_bid_price],[Source].[rule_fu_whole_units],[Source].[fd_rule_fund_id],[Source].[fd_freq_change_next_price_date],[Source].[fd_next_trade_cutoff_date],[Source].[fd_next_disinvestment_notice_date],[Source].[fd_last_trade_cutoff_date],[Source].[fd_last_disinvestment_notice_date],[Source].[fd_nominal_no_of_units],[Source].[fd_rule_fund_group],[Source].[fd_fund_classification],[Source].[fd_portfolio_cash],[Source].[fd_portfolio_num_assets],[Source].[fd_portfolio_last_value],[Source].[fd_portfolio_external_id],[Source].[fd_portfolio_num_accounts],[Source].[fd_fu_gl_code],[Source].[fd_closed_date]);



 
IF @mergeError != 0 
BEGIN 
PRINT 'ERROR OCCURRED IN MERGE FOR fd_fund.sql. Rows affected: ' + CAST(@mergeCount AS VARCHAR(100)); -- SQL should always return zero rows affected 
END 
ELSE IF @mergeCount > 0 
BEGIN 
PRINT 'fd_fund.sql rows affected by MERGE: ' + CAST(@mergeCount AS VARCHAR(100)); 
END 
 
PRINT 'Include fp_fund_price.sql' 
MERGE INTO [fp_fund_price] AS [Target]
USING (VALUES
  (N'1',N'A',N'20221019',N'000000',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'sysman',N'20221019',N'I',1,1,N'20221019',N'20221019',N'20221018',N'20221020',N'P',0.000000000000,0.000000000000,N'0',-1,-1)
) AS [Source] ([fd_fund_id],[fd_fund_type],[fp_pricing_date],[fp_pricing_time],[fp_create_date],[fp_last_updt_date],[fp_last_updt_time],[fp_last_updt_userid],[fp_business_date],[fp_record_status],[fp_offer_price],[fp_bid_price],[fp_applies_from_date],[fp_applies_to_date],[fp_previous_price_date],[fp_next_price_date],[fp_record_type],[fp_asset_offer_price],[fp_asset_bid_price],[fp_price_purpose],[fp_fund_price_id],[sl_system_log_id])
ON ([Target].[fd_fund_id] = [Source].[fd_fund_id] AND [Target].[fd_fund_type] = [Source].[fd_fund_type] AND [Target].[fp_pricing_date] = [Source].[fp_pricing_date])
WHEN MATCHED AND (
	NULLIF([Source].[fp_pricing_time], [Target].[fp_pricing_time]) IS NOT NULL OR NULLIF([Target].[fp_pricing_time], [Source].[fp_pricing_time]) IS NOT NULL OR 
	NULLIF([Source].[fp_last_updt_userid], [Target].[fp_last_updt_userid]) IS NOT NULL OR NULLIF([Target].[fp_last_updt_userid], [Source].[fp_last_updt_userid]) IS NOT NULL OR 
	NULLIF([Source].[fp_business_date], [Target].[fp_business_date]) IS NOT NULL OR NULLIF([Target].[fp_business_date], [Source].[fp_business_date]) IS NOT NULL OR 
	NULLIF([Source].[fp_record_status], [Target].[fp_record_status]) IS NOT NULL OR NULLIF([Target].[fp_record_status], [Source].[fp_record_status]) IS NOT NULL OR 
	NULLIF([Source].[fp_offer_price], [Target].[fp_offer_price]) IS NOT NULL OR NULLIF([Target].[fp_offer_price], [Source].[fp_offer_price]) IS NOT NULL OR 
	NULLIF([Source].[fp_bid_price], [Target].[fp_bid_price]) IS NOT NULL OR NULLIF([Target].[fp_bid_price], [Source].[fp_bid_price]) IS NOT NULL OR 
	NULLIF([Source].[fp_applies_from_date], [Target].[fp_applies_from_date]) IS NOT NULL OR NULLIF([Target].[fp_applies_from_date], [Source].[fp_applies_from_date]) IS NOT NULL OR 
	NULLIF([Source].[fp_applies_to_date], [Target].[fp_applies_to_date]) IS NOT NULL OR NULLIF([Target].[fp_applies_to_date], [Source].[fp_applies_to_date]) IS NOT NULL OR 
	NULLIF([Source].[fp_previous_price_date], [Target].[fp_previous_price_date]) IS NOT NULL OR NULLIF([Target].[fp_previous_price_date], [Source].[fp_previous_price_date]) IS NOT NULL OR 
	NULLIF([Source].[fp_next_price_date], [Target].[fp_next_price_date]) IS NOT NULL OR NULLIF([Target].[fp_next_price_date], [Source].[fp_next_price_date]) IS NOT NULL OR 
	NULLIF([Source].[fp_record_type], [Target].[fp_record_type]) IS NOT NULL OR NULLIF([Target].[fp_record_type], [Source].[fp_record_type]) IS NOT NULL OR 
	NULLIF([Source].[fp_asset_offer_price], [Target].[fp_asset_offer_price]) IS NOT NULL OR NULLIF([Target].[fp_asset_offer_price], [Source].[fp_asset_offer_price]) IS NOT NULL OR 
	NULLIF([Source].[fp_asset_bid_price], [Target].[fp_asset_bid_price]) IS NOT NULL OR NULLIF([Target].[fp_asset_bid_price], [Source].[fp_asset_bid_price]) IS NOT NULL OR 
	NULLIF([Source].[fp_price_purpose], [Target].[fp_price_purpose]) IS NOT NULL OR NULLIF([Target].[fp_price_purpose], [Source].[fp_price_purpose]) IS NOT NULL OR 
	NULLIF([Source].[fp_fund_price_id], [Target].[fp_fund_price_id]) IS NOT NULL OR NULLIF([Target].[fp_fund_price_id], [Source].[fp_fund_price_id]) IS NOT NULL OR 
	NULLIF([Source].[sl_system_log_id], [Target].[sl_system_log_id]) IS NOT NULL OR NULLIF([Target].[sl_system_log_id], [Source].[sl_system_log_id]) IS NOT NULL) THEN
 UPDATE SET
  [Target].[fp_pricing_time] = [Source].[fp_pricing_time], 
  [Target].[fp_last_updt_date] = CONVERT(CHAR(8),GETDATE(),112), 
  [Target].[fp_last_updt_time] = RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')), 
  [Target].[fp_last_updt_userid] = [Source].[fp_last_updt_userid], 
  [Target].[fp_business_date] = [Source].[fp_business_date], 
  [Target].[fp_record_status] = [Source].[fp_record_status], 
  [Target].[fp_offer_price] = [Source].[fp_offer_price], 
  [Target].[fp_bid_price] = [Source].[fp_bid_price], 
  [Target].[fp_applies_from_date] = [Source].[fp_applies_from_date], 
  [Target].[fp_applies_to_date] = [Source].[fp_applies_to_date], 
  [Target].[fp_previous_price_date] = [Source].[fp_previous_price_date], 
  [Target].[fp_next_price_date] = [Source].[fp_next_price_date], 
  [Target].[fp_record_type] = [Source].[fp_record_type], 
  [Target].[fp_asset_offer_price] = [Source].[fp_asset_offer_price], 
  [Target].[fp_asset_bid_price] = [Source].[fp_asset_bid_price], 
  [Target].[fp_price_purpose] = [Source].[fp_price_purpose], 
  [Target].[fp_fund_price_id] = [Source].[fp_fund_price_id], 
  [Target].[sl_system_log_id] = [Source].[sl_system_log_id]
WHEN NOT MATCHED BY TARGET THEN
 INSERT([fd_fund_id],[fd_fund_type],[fp_pricing_date],[fp_pricing_time],[fp_create_date],[fp_last_updt_date],[fp_last_updt_time],[fp_last_updt_userid],[fp_business_date],[fp_record_status],[fp_offer_price],[fp_bid_price],[fp_applies_from_date],[fp_applies_to_date],[fp_previous_price_date],[fp_next_price_date],[fp_record_type],[fp_asset_offer_price],[fp_asset_bid_price],[fp_price_purpose],[fp_fund_price_id],[sl_system_log_id])
 VALUES([Source].[fd_fund_id],[Source].[fd_fund_type],[Source].[fp_pricing_date],[Source].[fp_pricing_time],CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),[Source].[fp_last_updt_userid],[Source].[fp_business_date],[Source].[fp_record_status],[Source].[fp_offer_price],[Source].[fp_bid_price],[Source].[fp_applies_from_date],[Source].[fp_applies_to_date],[Source].[fp_previous_price_date],[Source].[fp_next_price_date],[Source].[fp_record_type],[Source].[fp_asset_offer_price],[Source].[fp_asset_bid_price],[Source].[fp_price_purpose],[Source].[fp_fund_price_id],[Source].[sl_system_log_id]);



 
IF @mergeError != 0 
BEGIN 
PRINT 'ERROR OCCURRED IN MERGE FOR fp_fund_price.sql. Rows affected: ' + CAST(@mergeCount AS VARCHAR(100)); -- SQL should always return zero rows affected 
END 
ELSE IF @mergeCount > 0 
BEGIN 
PRINT 'fp_fund_price.sql rows affected by MERGE: ' + CAST(@mergeCount AS VARCHAR(100)); 
END 
 
PRINT 'Include it_intermediary_additional.sql' 
MERGE INTO [it_intermediary_additional] AS [Target]
USING (VALUES
  (1000,N'AUTHCOD',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'duser',N'20221019',N'I',N'FCA',N'20221019',N'99991231')
 ,(1001,N'AUTHCOD',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'duser',N'20221019',N'I',N'FCA',N'20221019',N'99991231')
 ,(1002,N'AUTHCOD',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'duser',N'20221019',N'I',N'FCA',N'20221019',N'99991231')
 ,(10000,N'AUTHCOD',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'duser',N'20221019',N'I',N'FCA',N'20221019',N'99991231')
 ,(10001,N'AUTHCOD',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'duser',N'20221019',N'I',N'FCA',N'20221019',N'99991231')
 ,(10002,N'AUTHCOD',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'duser',N'20221019',N'I',N'FCA',N'20221019',N'99991231')
 ,(10003,N'AUTHCOD',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'duser',N'20221019',N'I',N'FCA',N'20221019',N'99991231')
 ,(10004,N'AUTHCOD',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'duser',N'20221019',N'I',N'FCA',N'20221019',N'99991231')
 ,(10005,N'AUTHCOD',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'duser',N'20221019',N'I',N'FCA',N'20221019',N'99991231')
 ,(1000,N'EDIMAIL',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'duser',N'20221019',N'I',N'',N'20221019',N'99991231')
 ,(1001,N'EDIMAIL',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'duser',N'20221019',N'I',N'',N'20221019',N'99991231')
 ,(1002,N'EDIMAIL',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'duser',N'20221019',N'I',N'',N'20221019',N'99991231')
 ,(10000,N'EDIMAIL',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'duser',N'20221019',N'I',N'',N'20221019',N'99991231')
 ,(10001,N'EDIMAIL',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'duser',N'20221019',N'I',N'',N'20221019',N'99991231')
 ,(10002,N'EDIMAIL',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'duser',N'20221019',N'I',N'',N'20221019',N'99991231')
 ,(10003,N'EDIMAIL',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'duser',N'20221019',N'I',N'',N'20221019',N'99991231')
 ,(10004,N'EDIMAIL',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'duser',N'20221019',N'I',N'',N'20221019',N'99991231')
 ,(10005,N'EDIMAIL',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'duser',N'20221019',N'I',N'',N'20221019',N'99991231')
 ,(1000,N'IDMNIFD',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'duser',N'20221019',N'I',N'N',N'20221019',N'99991231')
 ,(1001,N'IDMNIFD',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'duser',N'20221019',N'I',N'N',N'20221019',N'99991231')
 ,(1002,N'IDMNIFD',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'duser',N'20221019',N'I',N'N',N'20221019',N'99991231')
 ,(10000,N'IDMNIFD',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'duser',N'20221019',N'I',N'N',N'20221019',N'99991231')
 ,(10001,N'IDMNIFD',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'duser',N'20221019',N'I',N'N',N'20221019',N'99991231')
 ,(10002,N'IDMNIFD',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'duser',N'20221019',N'I',N'N',N'20221019',N'99991231')
 ,(10003,N'IDMNIFD',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'duser',N'20221019',N'I',N'N',N'20221019',N'99991231')
 ,(10004,N'IDMNIFD',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'duser',N'20221019',N'I',N'N',N'20221019',N'99991231')
 ,(10005,N'IDMNIFD',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'duser',N'20221019',N'I',N'N',N'20221019',N'99991231')
 ,(1000,N'INITPRD',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'duser',N'20221019',N'I',N'48',N'20221019',N'99991231')
 ,(1001,N'INITPRD',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'duser',N'20221019',N'I',N'48',N'20221019',N'99991231')
 ,(1002,N'INITPRD',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'duser',N'20221019',N'I',N'48',N'20221019',N'99991231')
 ,(10000,N'INITPRD',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'duser',N'20221019',N'I',N'48',N'20221019',N'99991231')
 ,(10001,N'INITPRD',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'duser',N'20221019',N'I',N'48',N'20221019',N'99991231')
 ,(10002,N'INITPRD',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'duser',N'20221019',N'I',N'48',N'20221019',N'99991231')
 ,(10003,N'INITPRD',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'duser',N'20221019',N'I',N'48',N'20221019',N'99991231')
 ,(10004,N'INITPRD',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'duser',N'20221019',N'I',N'48',N'20221019',N'99991231')
 ,(10005,N'INITPRD',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'duser',N'20221019',N'I',N'48',N'20221019',N'99991231')
 ,(1000,N'ORPHAN',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'duser',N'20221019',N'I',N'N',N'20221019',N'99991231')
 ,(1001,N'ORPHAN',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'duser',N'20221019',N'I',N'N',N'20221019',N'99991231')
 ,(1002,N'ORPHAN',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'duser',N'20221019',N'I',N'N',N'20221019',N'99991231')
 ,(10000,N'ORPHAN',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'duser',N'20221019',N'I',N'N',N'20221019',N'99991231')
 ,(10001,N'ORPHAN',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'duser',N'20221019',N'I',N'N',N'20221019',N'99991231')
 ,(10002,N'ORPHAN',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'duser',N'20221019',N'I',N'N',N'20221019',N'99991231')
 ,(10003,N'ORPHAN',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'duser',N'20221019',N'I',N'N',N'20221019',N'99991231')
 ,(10004,N'ORPHAN',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'duser',N'20221019',N'I',N'N',N'20221019',N'99991231')
 ,(10005,N'ORPHAN',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'duser',N'20221019',N'I',N'N',N'20221019',N'99991231')
 ,(1000,N'OUTOO',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'duser',N'20221019',N'I',N'N',N'20221019',N'99991231')
 ,(1001,N'OUTOO',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'duser',N'20221019',N'I',N'N',N'20221019',N'99991231')
 ,(1002,N'OUTOO',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'duser',N'20221019',N'I',N'N',N'20221019',N'99991231')
 ,(10000,N'OUTOO',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'duser',N'20221019',N'I',N'N',N'20221019',N'99991231')
 ,(10001,N'OUTOO',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'duser',N'20221019',N'I',N'N',N'20221019',N'99991231')
 ,(10002,N'OUTOO',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'duser',N'20221019',N'I',N'N',N'20221019',N'99991231')
 ,(10003,N'OUTOO',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'duser',N'20221019',N'I',N'N',N'20221019',N'99991231')
 ,(10004,N'OUTOO',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'duser',N'20221019',N'I',N'N',N'20221019',N'99991231')
 ,(10005,N'OUTOO',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'duser',N'20221019',N'I',N'N',N'20221019',N'99991231')
 ,(1000,N'SIMLCOD',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'duser',N'20221019',N'I',N'',N'20221019',N'99991231')
 ,(1001,N'SIMLCOD',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'duser',N'20221019',N'I',N'',N'20221019',N'99991231')
 ,(1002,N'SIMLCOD',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'duser',N'20221019',N'I',N'',N'20221019',N'99991231')
 ,(10000,N'SIMLCOD',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'duser',N'20221019',N'I',N'',N'20221019',N'99991231')
 ,(10001,N'SIMLCOD',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'duser',N'20221019',N'I',N'',N'20221019',N'99991231')
 ,(10002,N'SIMLCOD',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'duser',N'20221019',N'I',N'',N'20221019',N'99991231')
 ,(10003,N'SIMLCOD',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'duser',N'20221019',N'I',N'',N'20221019',N'99991231')
 ,(10004,N'SIMLCOD',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'duser',N'20221019',N'I',N'',N'20221019',N'99991231')
 ,(10005,N'SIMLCOD',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'duser',N'20221019',N'I',N'',N'20221019',N'99991231')
 ,(1000,N'IYPRCAT',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'HB',N'20221019',N'I',N'PRCAT1',N'20221019',N'99991231')
 ,(1001,N'IYPRCAT',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'HB',N'20221019',N'I',N'PRCAT2',N'20221019',N'99991231')
 ,(1002,N'IYPRCAT',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'HB',N'20221019',N'I',N'PRCAT1',N'20221019',N'99991231')
 ,(10000,N'IYPRCAT',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'HB',N'20221019',N'I',N'PRCAT2',N'20221019',N'99991231')
 ,(10001,N'IYPRCAT',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'HB',N'20221019',N'I',N'PRCAT1',N'20221019',N'99991231')
 ,(10002,N'IYPRCAT',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'HB',N'20221019',N'I',N'PRCAT2',N'20221019',N'99991231')
 ,(10003,N'IYPRCAT',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'HB',N'20221019',N'I',N'PRCAT1',N'20221019',N'99991231')
 ,(10004,N'IYPRCAT',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'HB',N'20221019',N'I',N'PRCAT2',N'20221019',N'99991231')
 ,(10005,N'IYPRCAT',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'HB',N'20221019',N'I',N'PRCAT1',N'20221019',N'99991231')
) AS [Source] ([iy_intermediary_id],[it_data_type],[it_create_date],[it_last_updt_date],[it_last_updt_time],[it_last_updt_userid],[it_business_date],[it_record_status],[it_data_value],[it_effective_from_date],[it_effective_to_date])
ON ([Target].[it_data_type] = [Source].[it_data_type] AND [Target].[iy_intermediary_id] = [Source].[iy_intermediary_id])
WHEN MATCHED AND (
	NULLIF([Source].[it_last_updt_userid], [Target].[it_last_updt_userid]) IS NOT NULL OR NULLIF([Target].[it_last_updt_userid], [Source].[it_last_updt_userid]) IS NOT NULL OR 
	NULLIF([Source].[it_business_date], [Target].[it_business_date]) IS NOT NULL OR NULLIF([Target].[it_business_date], [Source].[it_business_date]) IS NOT NULL OR 
	NULLIF([Source].[it_record_status], [Target].[it_record_status]) IS NOT NULL OR NULLIF([Target].[it_record_status], [Source].[it_record_status]) IS NOT NULL OR 
	NULLIF([Source].[it_data_value], [Target].[it_data_value]) IS NOT NULL OR NULLIF([Target].[it_data_value], [Source].[it_data_value]) IS NOT NULL OR 
	NULLIF([Source].[it_effective_from_date], [Target].[it_effective_from_date]) IS NOT NULL OR NULLIF([Target].[it_effective_from_date], [Source].[it_effective_from_date]) IS NOT NULL OR 
	NULLIF([Source].[it_effective_to_date], [Target].[it_effective_to_date]) IS NOT NULL OR NULLIF([Target].[it_effective_to_date], [Source].[it_effective_to_date]) IS NOT NULL) THEN
 UPDATE SET
  [Target].[it_last_updt_date] = [Source].[it_last_updt_date], 
  [Target].[it_last_updt_time] = [Source].[it_last_updt_time], 
  [Target].[it_last_updt_userid] = [Source].[it_last_updt_userid], 
  [Target].[it_business_date] = [Source].[it_business_date], 
  [Target].[it_record_status] = [Source].[it_record_status], 
  [Target].[it_data_value] = [Source].[it_data_value], 
  [Target].[it_effective_from_date] = [Source].[it_effective_from_date], 
  [Target].[it_effective_to_date] = [Source].[it_effective_to_date]
WHEN NOT MATCHED BY TARGET THEN
 INSERT([iy_intermediary_id],[it_data_type],[it_create_date],[it_last_updt_date],[it_last_updt_time],[it_last_updt_userid],[it_business_date],[it_record_status],[it_data_value],[it_effective_from_date],[it_effective_to_date])
 VALUES([Source].[iy_intermediary_id],[Source].[it_data_type],[Source].[it_create_date],[Source].[it_last_updt_date],[Source].[it_last_updt_time],[Source].[it_last_updt_userid],[Source].[it_business_date],[Source].[it_record_status],[Source].[it_data_value],[Source].[it_effective_from_date],[Source].[it_effective_to_date]);

 SELECT @mergeError = @@ERROR, @mergeCount = @@ROWCOUNT

 
IF @mergeError != 0 
BEGIN 
PRINT 'ERROR OCCURRED IN MERGE FOR it_intermediary_additional.sql. Rows affected: ' + CAST(@mergeCount AS VARCHAR(100)); -- SQL should always return zero rows affected 
END 
ELSE IF @mergeCount > 0 
BEGIN 
PRINT 'it_intermediary_additional.sql rows affected by MERGE: ' + CAST(@mergeCount AS VARCHAR(100)); 
END 
 
PRINT 'Include iy_intermediary.sql' 
MERGE INTO [iy_intermediary] AS [Target]
USING (VALUES
  (1,CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'AR',N'20240111',N'I',N'19800101',N'99991231',N'0',N'TOB',N'A01',1,1,N'',52,N'',N'CHQ',N'',N'',N'',N'',N'N',N'N',N'',N'0',N'',0.000000000000000e+000,N'',1,N'',N'Y',N'',N'',N'UK',N'',N'',N'S',N'N',N'',N'',N'N',N'script',N'10000101',N'CHQ',-1)
 ,(1000,CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'script',N'20190430',N'I',N'19800101',N'99991231',N'3',N'TOB',N'A01',1000,1000,N'2008/021179/07',52,N'',N'CHQ',N'',N'',N'',N'',N'N',N'N',N'',N'1000',N'',0.000000000000000e+000,N'',1,N'',N'Y',N'',N'',N'UK',N'',N'',N'S',N'N',N'',N'',N'N',N'script',N'10000101',N'CHQ',-1)
 ,(1001,CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'script',N'20190430',N'I',N'19800101',N'99991231',N'3',N'TOB',N'A01',1001,1001,N'1973/010798/07',52,N'',N'CHQ',N'',N'',N'',N'',N'N',N'N',N'',N'1001',N'',0.000000000000000e+000,N'',1,N'',N'Y',N'',N'',N'UK',N'',N'',N'S',N'N',N'',N'',N'N',N'script',N'10000101',N'CHQ',-1)
 ,(1002,CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'script',N'20190430',N'I',N'19800101',N'99991231',N'3',N'TOB',N'A01',1002,1002,N'2000/005267/07',52,N'',N'CHQ',N'',N'',N'',N'',N'N',N'N',N'',N'1002',N'',0.000000000000000e+000,N'',1,N'',N'Y',N'',N'',N'UK',N'',N'',N'S',N'N',N'',N'',N'N',N'script',N'10000101',N'CHQ',-1)
 ,(10000,CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'script',N'20190430',N'I',N'19800101',N'99991231',N'0',N'IFA',N'A01',10000,10000,N'',52,N'',N'CHQ',N'',N'',N'',N'',N'N',N'N',N'',N'10000',N'',0.000000000000000e+000,N'',1,N'',N'Y',N'',N'',N'UK',N'',N'',N'S',N'N',N'',N'',N'N',N'script',N'10000101',N'CHQ',-1)
 ,(10001,CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'script',N'20190430',N'I',N'19800101',N'99991231',N'0',N'IFA',N'A01',10001,10001,N'',52,N'',N'CHQ',N'',N'',N'',N'',N'N',N'N',N'',N'10001',N'',0.000000000000000e+000,N'',1,N'',N'Y',N'',N'',N'UK',N'',N'',N'S',N'N',N'',N'',N'N',N'script',N'10000101',N'CHQ',-1)
 ,(10002,CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'script',N'20190430',N'I',N'19800101',N'99991231',N'0',N'IFA',N'A01',10002,10002,N'',52,N'',N'CHQ',N'',N'',N'',N'',N'N',N'N',N'',N'10002',N'',0.000000000000000e+000,N'',1,N'',N'Y',N'',N'',N'UK',N'',N'',N'S',N'N',N'',N'',N'N',N'script',N'10000101',N'CHQ',-1)
 ,(10003,CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'script',N'20190430',N'I',N'19800101',N'99991231',N'0',N'IFA',N'A01',10003,10003,N'',52,N'',N'CHQ',N'',N'',N'',N'',N'N',N'N',N'',N'10003',N'',0.000000000000000e+000,N'',1,N'',N'Y',N'',N'',N'UK',N'',N'',N'S',N'N',N'',N'',N'N',N'script',N'10000101',N'CHQ',-1)
 ,(10004,CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'HB',N'20190430',N'I',N'19800101',N'99991231',N'0',N'IFA',N'A01',10004,10004,N'',52,N'',N'CHQ',N'',N'',N'',N'',N'N',N'N',N'',N'10004',N'',0.000000000000000e+000,N'',1,N'',N'Y',N'',N'',N'UK',N'',N'',N'S',N'N',N'',N'',N'N',N'script',N'10000101',N'CHQ',-1)
 ,(10005,CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'HB',N'20190430',N'I',N'19800101',N'99991231',N'0',N'IFA',N'A01',10005,10005,N'',52,N'',N'CHQ',N'',N'',N'',N'',N'N',N'N',N'',N'10005',N'',0.000000000000000e+000,N'',1,N'',N'Y',N'',N'',N'UK',N'',N'',N'S',N'N',N'',N'',N'N',N'script',N'10000101',N'CHQ',-1)
) AS [Source] ([iy_intermediary_id],[iy_create_date],[iy_last_updt_date],[iy_last_updt_time],[iy_last_updt_userid],[iy_business_date],[iy_record_status],[iy_start_date],[iy_end_date],[iy_type],[iy_category],[iy_sub_category],[ct_client_id],[ad_address_id],[iy_registration_no],[iy_statement_freq],[iy_last_statement_date],[iy_payment_method],[iy_currency],[iy_payment_day],[iy_payment_day2],[iy_last_payment_date],[iy_payment_stop],[iy_mail],[iy_currency_conversion_type],[iy_external_id],[iy_statement_due_date],[iy_commission_hold_balance_amount],[iy_commission_hold_balance_currency],[ad_version_number],[iy_branch_code],[iy_payment_intermediary],[iy_print_statement],[iy_currency_method],[iy_country_code],[iy_sales_group],[iy_liaison_register_id],[iy_ics_key_account_type],[iy_dummy_branch],[iy_commission_contact],[iy_next_payment_date],[iy_agency_agreement],[iy_create_userid],[iy_advance_payment_date],[iy_advance_payment_method],[sl_system_log_id])
ON ([Target].[iy_intermediary_id] = [Source].[iy_intermediary_id])
WHEN MATCHED AND (
	NULLIF([Source].[iy_create_date], [Target].[iy_create_date]) IS NOT NULL OR NULLIF([Target].[iy_create_date], [Source].[iy_create_date]) IS NOT NULL OR 
	NULLIF([Source].[iy_last_updt_date], [Target].[iy_last_updt_date]) IS NOT NULL OR NULLIF([Target].[iy_last_updt_date], [Source].[iy_last_updt_date]) IS NOT NULL OR 
	NULLIF([Source].[iy_last_updt_time], [Target].[iy_last_updt_time]) IS NOT NULL OR NULLIF([Target].[iy_last_updt_time], [Source].[iy_last_updt_time]) IS NOT NULL OR 
	NULLIF([Source].[iy_last_updt_userid], [Target].[iy_last_updt_userid]) IS NOT NULL OR NULLIF([Target].[iy_last_updt_userid], [Source].[iy_last_updt_userid]) IS NOT NULL OR 
	NULLIF([Source].[iy_business_date], [Target].[iy_business_date]) IS NOT NULL OR NULLIF([Target].[iy_business_date], [Source].[iy_business_date]) IS NOT NULL OR 
	NULLIF([Source].[iy_record_status], [Target].[iy_record_status]) IS NOT NULL OR NULLIF([Target].[iy_record_status], [Source].[iy_record_status]) IS NOT NULL OR 
	NULLIF([Source].[iy_start_date], [Target].[iy_start_date]) IS NOT NULL OR NULLIF([Target].[iy_start_date], [Source].[iy_start_date]) IS NOT NULL OR 
	NULLIF([Source].[iy_end_date], [Target].[iy_end_date]) IS NOT NULL OR NULLIF([Target].[iy_end_date], [Source].[iy_end_date]) IS NOT NULL OR 
	NULLIF([Source].[iy_type], [Target].[iy_type]) IS NOT NULL OR NULLIF([Target].[iy_type], [Source].[iy_type]) IS NOT NULL OR 
	NULLIF([Source].[iy_category], [Target].[iy_category]) IS NOT NULL OR NULLIF([Target].[iy_category], [Source].[iy_category]) IS NOT NULL OR 
	NULLIF([Source].[iy_sub_category], [Target].[iy_sub_category]) IS NOT NULL OR NULLIF([Target].[iy_sub_category], [Source].[iy_sub_category]) IS NOT NULL OR 
	NULLIF([Source].[ct_client_id], [Target].[ct_client_id]) IS NOT NULL OR NULLIF([Target].[ct_client_id], [Source].[ct_client_id]) IS NOT NULL OR 
	NULLIF([Source].[ad_address_id], [Target].[ad_address_id]) IS NOT NULL OR NULLIF([Target].[ad_address_id], [Source].[ad_address_id]) IS NOT NULL OR 
	NULLIF([Source].[iy_registration_no], [Target].[iy_registration_no]) IS NOT NULL OR NULLIF([Target].[iy_registration_no], [Source].[iy_registration_no]) IS NOT NULL OR 
	NULLIF([Source].[iy_statement_freq], [Target].[iy_statement_freq]) IS NOT NULL OR NULLIF([Target].[iy_statement_freq], [Source].[iy_statement_freq]) IS NOT NULL OR 
	NULLIF([Source].[iy_last_statement_date], [Target].[iy_last_statement_date]) IS NOT NULL OR NULLIF([Target].[iy_last_statement_date], [Source].[iy_last_statement_date]) IS NOT NULL OR 
	NULLIF([Source].[iy_payment_method], [Target].[iy_payment_method]) IS NOT NULL OR NULLIF([Target].[iy_payment_method], [Source].[iy_payment_method]) IS NOT NULL OR 
	NULLIF([Source].[iy_currency], [Target].[iy_currency]) IS NOT NULL OR NULLIF([Target].[iy_currency], [Source].[iy_currency]) IS NOT NULL OR 
	NULLIF([Source].[iy_payment_day], [Target].[iy_payment_day]) IS NOT NULL OR NULLIF([Target].[iy_payment_day], [Source].[iy_payment_day]) IS NOT NULL OR 
	NULLIF([Source].[iy_payment_day2], [Target].[iy_payment_day2]) IS NOT NULL OR NULLIF([Target].[iy_payment_day2], [Source].[iy_payment_day2]) IS NOT NULL OR 
	NULLIF([Source].[iy_last_payment_date], [Target].[iy_last_payment_date]) IS NOT NULL OR NULLIF([Target].[iy_last_payment_date], [Source].[iy_last_payment_date]) IS NOT NULL OR 
	NULLIF([Source].[iy_payment_stop], [Target].[iy_payment_stop]) IS NOT NULL OR NULLIF([Target].[iy_payment_stop], [Source].[iy_payment_stop]) IS NOT NULL OR 
	NULLIF([Source].[iy_mail], [Target].[iy_mail]) IS NOT NULL OR NULLIF([Target].[iy_mail], [Source].[iy_mail]) IS NOT NULL OR 
	NULLIF([Source].[iy_currency_conversion_type], [Target].[iy_currency_conversion_type]) IS NOT NULL OR NULLIF([Target].[iy_currency_conversion_type], [Source].[iy_currency_conversion_type]) IS NOT NULL OR 
	NULLIF([Source].[iy_external_id], [Target].[iy_external_id]) IS NOT NULL OR NULLIF([Target].[iy_external_id], [Source].[iy_external_id]) IS NOT NULL OR 
	NULLIF([Source].[iy_statement_due_date], [Target].[iy_statement_due_date]) IS NOT NULL OR NULLIF([Target].[iy_statement_due_date], [Source].[iy_statement_due_date]) IS NOT NULL OR 
	NULLIF([Source].[iy_commission_hold_balance_amount], [Target].[iy_commission_hold_balance_amount]) IS NOT NULL OR NULLIF([Target].[iy_commission_hold_balance_amount], [Source].[iy_commission_hold_balance_amount]) IS NOT NULL OR 
	NULLIF([Source].[iy_commission_hold_balance_currency], [Target].[iy_commission_hold_balance_currency]) IS NOT NULL OR NULLIF([Target].[iy_commission_hold_balance_currency], [Source].[iy_commission_hold_balance_currency]) IS NOT NULL OR 
	NULLIF([Source].[ad_version_number], [Target].[ad_version_number]) IS NOT NULL OR NULLIF([Target].[ad_version_number], [Source].[ad_version_number]) IS NOT NULL OR 
	NULLIF([Source].[iy_branch_code], [Target].[iy_branch_code]) IS NOT NULL OR NULLIF([Target].[iy_branch_code], [Source].[iy_branch_code]) IS NOT NULL OR 
	NULLIF([Source].[iy_payment_intermediary], [Target].[iy_payment_intermediary]) IS NOT NULL OR NULLIF([Target].[iy_payment_intermediary], [Source].[iy_payment_intermediary]) IS NOT NULL OR 
	NULLIF([Source].[iy_print_statement], [Target].[iy_print_statement]) IS NOT NULL OR NULLIF([Target].[iy_print_statement], [Source].[iy_print_statement]) IS NOT NULL OR 
	NULLIF([Source].[iy_currency_method], [Target].[iy_currency_method]) IS NOT NULL OR NULLIF([Target].[iy_currency_method], [Source].[iy_currency_method]) IS NOT NULL OR 
	NULLIF([Source].[iy_country_code], [Target].[iy_country_code]) IS NOT NULL OR NULLIF([Target].[iy_country_code], [Source].[iy_country_code]) IS NOT NULL OR 
	NULLIF([Source].[iy_sales_group], [Target].[iy_sales_group]) IS NOT NULL OR NULLIF([Target].[iy_sales_group], [Source].[iy_sales_group]) IS NOT NULL OR 
	NULLIF([Source].[iy_liaison_register_id], [Target].[iy_liaison_register_id]) IS NOT NULL OR NULLIF([Target].[iy_liaison_register_id], [Source].[iy_liaison_register_id]) IS NOT NULL OR 
	NULLIF([Source].[iy_ics_key_account_type], [Target].[iy_ics_key_account_type]) IS NOT NULL OR NULLIF([Target].[iy_ics_key_account_type], [Source].[iy_ics_key_account_type]) IS NOT NULL OR 
	NULLIF([Source].[iy_dummy_branch], [Target].[iy_dummy_branch]) IS NOT NULL OR NULLIF([Target].[iy_dummy_branch], [Source].[iy_dummy_branch]) IS NOT NULL OR 
	NULLIF([Source].[iy_commission_contact], [Target].[iy_commission_contact]) IS NOT NULL OR NULLIF([Target].[iy_commission_contact], [Source].[iy_commission_contact]) IS NOT NULL OR 
	NULLIF([Source].[iy_next_payment_date], [Target].[iy_next_payment_date]) IS NOT NULL OR NULLIF([Target].[iy_next_payment_date], [Source].[iy_next_payment_date]) IS NOT NULL OR 
	NULLIF([Source].[iy_agency_agreement], [Target].[iy_agency_agreement]) IS NOT NULL OR NULLIF([Target].[iy_agency_agreement], [Source].[iy_agency_agreement]) IS NOT NULL OR 
	NULLIF([Source].[iy_create_userid], [Target].[iy_create_userid]) IS NOT NULL OR NULLIF([Target].[iy_create_userid], [Source].[iy_create_userid]) IS NOT NULL OR 
	NULLIF([Source].[iy_advance_payment_date], [Target].[iy_advance_payment_date]) IS NOT NULL OR NULLIF([Target].[iy_advance_payment_date], [Source].[iy_advance_payment_date]) IS NOT NULL OR 
	NULLIF([Source].[iy_advance_payment_method], [Target].[iy_advance_payment_method]) IS NOT NULL OR NULLIF([Target].[iy_advance_payment_method], [Source].[iy_advance_payment_method]) IS NOT NULL OR 
	NULLIF([Source].[sl_system_log_id], [Target].[sl_system_log_id]) IS NOT NULL OR NULLIF([Target].[sl_system_log_id], [Source].[sl_system_log_id]) IS NOT NULL) THEN
 UPDATE SET
  [Target].[iy_create_date] = [Source].[iy_create_date], 
  [Target].[iy_last_updt_date] = [Source].[iy_last_updt_date], 
  [Target].[iy_last_updt_time] = [Source].[iy_last_updt_time], 
  [Target].[iy_last_updt_userid] = [Source].[iy_last_updt_userid], 
  [Target].[iy_business_date] = [Source].[iy_business_date], 
  [Target].[iy_record_status] = [Source].[iy_record_status], 
  [Target].[iy_start_date] = [Source].[iy_start_date], 
  [Target].[iy_end_date] = [Source].[iy_end_date], 
  [Target].[iy_type] = [Source].[iy_type], 
  [Target].[iy_category] = [Source].[iy_category], 
  [Target].[iy_sub_category] = [Source].[iy_sub_category], 
  [Target].[ct_client_id] = [Source].[ct_client_id], 
  [Target].[ad_address_id] = [Source].[ad_address_id], 
  [Target].[iy_registration_no] = [Source].[iy_registration_no], 
  [Target].[iy_statement_freq] = [Source].[iy_statement_freq], 
  [Target].[iy_last_statement_date] = [Source].[iy_last_statement_date], 
  [Target].[iy_payment_method] = [Source].[iy_payment_method], 
  [Target].[iy_currency] = [Source].[iy_currency], 
  [Target].[iy_payment_day] = [Source].[iy_payment_day], 
  [Target].[iy_payment_day2] = [Source].[iy_payment_day2], 
  [Target].[iy_last_payment_date] = [Source].[iy_last_payment_date], 
  [Target].[iy_payment_stop] = [Source].[iy_payment_stop], 
  [Target].[iy_mail] = [Source].[iy_mail], 
  [Target].[iy_currency_conversion_type] = [Source].[iy_currency_conversion_type], 
  [Target].[iy_external_id] = [Source].[iy_external_id], 
  [Target].[iy_statement_due_date] = [Source].[iy_statement_due_date], 
  [Target].[iy_commission_hold_balance_amount] = [Source].[iy_commission_hold_balance_amount], 
  [Target].[iy_commission_hold_balance_currency] = [Source].[iy_commission_hold_balance_currency], 
  [Target].[ad_version_number] = [Source].[ad_version_number], 
  [Target].[iy_branch_code] = [Source].[iy_branch_code], 
  [Target].[iy_payment_intermediary] = [Source].[iy_payment_intermediary], 
  [Target].[iy_print_statement] = [Source].[iy_print_statement], 
  [Target].[iy_currency_method] = [Source].[iy_currency_method], 
  [Target].[iy_country_code] = [Source].[iy_country_code], 
  [Target].[iy_sales_group] = [Source].[iy_sales_group], 
  [Target].[iy_liaison_register_id] = [Source].[iy_liaison_register_id], 
  [Target].[iy_ics_key_account_type] = [Source].[iy_ics_key_account_type], 
  [Target].[iy_dummy_branch] = [Source].[iy_dummy_branch], 
  [Target].[iy_commission_contact] = [Source].[iy_commission_contact], 
  [Target].[iy_next_payment_date] = [Source].[iy_next_payment_date], 
  [Target].[iy_agency_agreement] = [Source].[iy_agency_agreement], 
  [Target].[iy_create_userid] = [Source].[iy_create_userid], 
  [Target].[iy_advance_payment_date] = [Source].[iy_advance_payment_date], 
  [Target].[iy_advance_payment_method] = [Source].[iy_advance_payment_method], 
  [Target].[sl_system_log_id] = [Source].[sl_system_log_id]
WHEN NOT MATCHED BY TARGET THEN
 INSERT([iy_intermediary_id],[iy_create_date],[iy_last_updt_date],[iy_last_updt_time],[iy_last_updt_userid],[iy_business_date],[iy_record_status],[iy_start_date],[iy_end_date],[iy_type],[iy_category],[iy_sub_category],[ct_client_id],[ad_address_id],[iy_registration_no],[iy_statement_freq],[iy_last_statement_date],[iy_payment_method],[iy_currency],[iy_payment_day],[iy_payment_day2],[iy_last_payment_date],[iy_payment_stop],[iy_mail],[iy_currency_conversion_type],[iy_external_id],[iy_statement_due_date],[iy_commission_hold_balance_amount],[iy_commission_hold_balance_currency],[ad_version_number],[iy_branch_code],[iy_payment_intermediary],[iy_print_statement],[iy_currency_method],[iy_country_code],[iy_sales_group],[iy_liaison_register_id],[iy_ics_key_account_type],[iy_dummy_branch],[iy_commission_contact],[iy_next_payment_date],[iy_agency_agreement],[iy_create_userid],[iy_advance_payment_date],[iy_advance_payment_method],[sl_system_log_id])
 VALUES([Source].[iy_intermediary_id],[Source].[iy_create_date],[Source].[iy_last_updt_date],[Source].[iy_last_updt_time],[Source].[iy_last_updt_userid],[Source].[iy_business_date],[Source].[iy_record_status],[Source].[iy_start_date],[Source].[iy_end_date],[Source].[iy_type],[Source].[iy_category],[Source].[iy_sub_category],[Source].[ct_client_id],[Source].[ad_address_id],[Source].[iy_registration_no],[Source].[iy_statement_freq],[Source].[iy_last_statement_date],[Source].[iy_payment_method],[Source].[iy_currency],[Source].[iy_payment_day],[Source].[iy_payment_day2],[Source].[iy_last_payment_date],[Source].[iy_payment_stop],[Source].[iy_mail],[Source].[iy_currency_conversion_type],[Source].[iy_external_id],[Source].[iy_statement_due_date],[Source].[iy_commission_hold_balance_amount],[Source].[iy_commission_hold_balance_currency],[Source].[ad_version_number],[Source].[iy_branch_code],[Source].[iy_payment_intermediary],[Source].[iy_print_statement],[Source].[iy_currency_method],[Source].[iy_country_code],[Source].[iy_sales_group],[Source].[iy_liaison_register_id],[Source].[iy_ics_key_account_type],[Source].[iy_dummy_branch],[Source].[iy_commission_contact],[Source].[iy_next_payment_date],[Source].[iy_agency_agreement],[Source].[iy_create_userid],[Source].[iy_advance_payment_date],[Source].[iy_advance_payment_method],[Source].[sl_system_log_id]);
 
IF @mergeError != 0 
BEGIN 
PRINT 'ERROR OCCURRED IN MERGE FOR iy_intermediary.sql. Rows affected: ' + CAST(@mergeCount AS VARCHAR(100)); -- SQL should always return zero rows affected 
END 
ELSE IF @mergeCount > 0 
BEGIN 
PRINT 'iy_intermediary.sql rows affected by MERGE: ' + CAST(@mergeCount AS VARCHAR(100)); 
END 
 
PRINT 'Include nw_non_working_date.sql' 
MERGE INTO [nw_non_working_date] AS [Target]
USING (VALUES
 (N'ZA',N'20180101',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'HB',N'20221019',N'I')
 ,(N'ZA',N'20180321',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'HB',N'20221019',N'I')
 ,(N'ZA',N'20180330',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'HB',N'20221019',N'I')
 ,(N'ZA',N'20180402',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'HB',N'20221019',N'I')
 ,(N'ZA',N'20180427',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'HB',N'20221019',N'I')
 ,(N'ZA',N'20180501',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'HB',N'20221019',N'I')
 ,(N'ZA',N'20180616',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'HB',N'20221019',N'I')
 ,(N'ZA',N'20180809',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'HB',N'20221019',N'I')
 ,(N'ZA',N'20180924',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'HB',N'20221019',N'I')
 ,(N'ZA',N'20181217',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'HB',N'20221019',N'I')
 ,(N'ZA',N'20181225',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'HB',N'20221019',N'I')
 ,(N'ZA',N'20181226',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'HB',N'20221019',N'I')
 ,(N'ZA',N'20190101',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'HB',N'20221019',N'I')
 ,(N'ZA',N'20190321',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'HB',N'20221019',N'I')
 ,(N'ZA',N'20190419',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'HB',N'20221019',N'I')
 ,(N'ZA',N'20190422',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'HB',N'20221019',N'I')
 ,(N'ZA',N'20190427',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'HB',N'20221019',N'I')
 ,(N'ZA',N'20190501',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'HB',N'20221019',N'I')
 ,(N'ZA',N'20190508',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'HB',N'20221019',N'I')
 ,(N'ZA',N'20190617',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'HB',N'20221019',N'I')
 ,(N'ZA',N'20190809',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'HB',N'20221019',N'I')
 ,(N'ZA',N'20190924',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'HB',N'20221019',N'I')
 ,(N'ZA',N'20191216',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'HB',N'20221019',N'I')
 ,(N'ZA',N'20191225',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'HB',N'20221019',N'I')
 ,(N'ZA',N'20191226',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'HB',N'20221019',N'I')
 ,(N'ZA',N'20200101',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'HB',N'20221019',N'I')
 ,(N'ZA',N'20200321',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'HB',N'20221019',N'I')
 ,(N'ZA',N'20200410',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'HB',N'20221019',N'I')
 ,(N'ZA',N'20200413',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'HB',N'20221019',N'I')
 ,(N'ZA',N'20200427',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'HB',N'20221019',N'I')
 ,(N'ZA',N'20200501',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'HB',N'20221019',N'I')
 ,(N'ZA',N'20200616',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'HB',N'20221019',N'I')
 ,(N'ZA',N'20200810',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'HB',N'20221019',N'I')
 ,(N'ZA',N'20200924',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'HB',N'20221019',N'I')
 ,(N'ZA',N'20201216',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'HB',N'20221019',N'I')
 ,(N'ZA',N'20201225',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'HB',N'20221019',N'I')
 ,(N'ZA',N'20201226',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'HB',N'20221019',N'I')
 ,(N'ZA',N'20210101',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'HB',N'20221019',N'I')
 ,(N'ZA',N'20210322',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'HB',N'20221019',N'I')
 ,(N'ZA',N'20210402',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'HB',N'20221019',N'I')
 ,(N'ZA',N'20210405',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'HB',N'20221019',N'I')
 ,(N'ZA',N'20210427',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'HB',N'20221019',N'I')
 ,(N'ZA',N'20210501',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'HB',N'20221019',N'I')
 ,(N'ZA',N'20210616',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'HB',N'20221019',N'I')
 ,(N'ZA',N'20210809',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'HB',N'20221019',N'I')
 ,(N'ZA',N'20210924',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'HB',N'20221019',N'I')
 ,(N'ZA',N'20211101',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'HB',N'20221019',N'I')
 ,(N'ZA',N'20211216',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'HB',N'20221019',N'I')
 ,(N'ZA',N'20211225',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'HB',N'20221019',N'I')
 ,(N'ZA',N'20211227',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'HB',N'20221019',N'I')
 ,(N'ZA',N'20220101',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'HB',N'20221019',N'I')
 ,(N'ZA',N'20220321',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'HB',N'20221019',N'I')
 ,(N'ZA',N'20220415',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'HB',N'20221019',N'I')
 ,(N'ZA',N'20220418',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'HB',N'20221019',N'I')
 ,(N'ZA',N'20220427',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'HB',N'20221019',N'I')
 ,(N'ZA',N'20220502',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'HB',N'20221019',N'I')
 ,(N'ZA',N'20220616',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'HB',N'20221019',N'I')
 ,(N'ZA',N'20220809',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'HB',N'20221019',N'I')
 ,(N'ZA',N'20220924',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'HB',N'20221019',N'I')
 ,(N'ZA',N'20221216',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'HB',N'20221019',N'I')
 ,(N'ZA',N'20221225',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'HB',N'20221019',N'I')
 ,(N'ZA',N'20221226',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'HB',N'20221019',N'I')
 ,(N'ZA',N'20221227',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'HB',N'20221019',N'I')
 ,(N'ZA',N'20230102',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'HB',N'20221019',N'I')
 ,(N'ZA',N'20230321',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'HB',N'20221019',N'I')
 ,(N'ZA',N'20230407',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'HB',N'20221019',N'I')
 ,(N'ZA',N'20230410',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'HB',N'20221019',N'I')
 ,(N'ZA',N'20230427',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'HB',N'20221019',N'I')
 ,(N'ZA',N'20230501',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'HB',N'20221019',N'I')
 ,(N'ZA',N'20230616',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'HB',N'20221019',N'I')
 ,(N'ZA',N'20230809',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'HB',N'20221019',N'I')
 ,(N'ZA',N'20230925',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'HB',N'20221019',N'I')
 ,(N'ZA',N'20231215',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'HB',N'20221019',N'I')
 ,(N'ZA',N'20231216',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'HB',N'20221019',N'I')
 ,(N'ZA',N'20231225',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'HB',N'20221019',N'I')
 ,(N'ZA',N'20231226',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'HB',N'20221019',N'I')
 ,(N'ZA',N'20240101',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'HB',N'20221019',N'I')
 ,(N'ZA',N'20240321',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'HB',N'20221019',N'I')
 ,(N'ZA',N'20240329',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'HB',N'20221019',N'I')
 ,(N'ZA',N'20240401',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'HB',N'20221019',N'I')
 ,(N'ZA',N'20240427',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'HB',N'20221019',N'I')
 ,(N'ZA',N'20240501',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'HB',N'20221019',N'I')
 ,(N'ZA',N'20240617',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'HB',N'20221019',N'I')
 ,(N'ZA',N'20240809',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'HB',N'20221019',N'I')
 ,(N'ZA',N'20240924',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'HB',N'20221019',N'I')
 ,(N'ZA',N'20241216',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'HB',N'20221019',N'I')
 ,(N'ZA',N'20241225',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'HB',N'20221019',N'I')
 ,(N'ZA',N'20241226',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'HB',N'20221019',N'I')
 ,(N'ZA',N'20250101',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'HB',N'20221019',N'I')
 ,(N'ZA',N'20250321',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'HB',N'20221019',N'I')
 ,(N'ZA',N'20250418',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'HB',N'20221019',N'I')
 ,(N'ZA',N'20250421',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'HB',N'20221019',N'I')
 ,(N'ZA',N'20250428',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'HB',N'20221019',N'I')
 ,(N'ZA',N'20250501',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'HB',N'20221019',N'I')
 ,(N'ZA',N'20250616',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'HB',N'20221019',N'I')
 ,(N'ZA',N'20250809',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'HB',N'20221019',N'I')
 ,(N'ZA',N'20250924',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'HB',N'20221019',N'I')
 ,(N'ZA',N'20251216',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'HB',N'20221019',N'I')
 ,(N'ZA',N'20251225',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'HB',N'20221019',N'I')
 ,(N'ZA',N'20251226',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'HB',N'20221019',N'I')
 ) AS [Source] ([nw_country_code],[nw_non_working_date],[nw_create_date],[nw_last_updt_date],[nw_last_updt_time],[nw_last_updt_userid],[nw_business_date],[nw_record_status])
ON ([Target].[nw_country_code] = [Source].[nw_country_code] AND [Target].[nw_non_working_date] = [Source].[nw_non_working_date])
WHEN MATCHED AND (
	NULLIF([Source].[nw_create_date], [Target].[nw_create_date]) IS NOT NULL OR NULLIF([Target].[nw_create_date], [Source].[nw_create_date]) IS NOT NULL OR 
	NULLIF([Source].[nw_last_updt_date], [Target].[nw_last_updt_date]) IS NOT NULL OR NULLIF([Target].[nw_last_updt_date], [Source].[nw_last_updt_date]) IS NOT NULL OR 
	NULLIF([Source].[nw_last_updt_time], [Target].[nw_last_updt_time]) IS NOT NULL OR NULLIF([Target].[nw_last_updt_time], [Source].[nw_last_updt_time]) IS NOT NULL OR 
	NULLIF([Source].[nw_last_updt_userid], [Target].[nw_last_updt_userid]) IS NOT NULL OR NULLIF([Target].[nw_last_updt_userid], [Source].[nw_last_updt_userid]) IS NOT NULL OR 
	NULLIF([Source].[nw_business_date], [Target].[nw_business_date]) IS NOT NULL OR NULLIF([Target].[nw_business_date], [Source].[nw_business_date]) IS NOT NULL OR 
	NULLIF([Source].[nw_record_status], [Target].[nw_record_status]) IS NOT NULL OR NULLIF([Target].[nw_record_status], [Source].[nw_record_status]) IS NOT NULL) THEN
 UPDATE SET
  [Target].[nw_create_date] = [Source].[nw_create_date], 
  [Target].[nw_last_updt_date] = [Source].[nw_last_updt_date], 
  [Target].[nw_last_updt_time] = [Source].[nw_last_updt_time], 
  [Target].[nw_last_updt_userid] = [Source].[nw_last_updt_userid], 
  [Target].[nw_business_date] = [Source].[nw_business_date], 
  [Target].[nw_record_status] = [Source].[nw_record_status]
WHEN NOT MATCHED BY TARGET THEN
 INSERT([nw_country_code],[nw_non_working_date],[nw_create_date],[nw_last_updt_date],[nw_last_updt_time],[nw_last_updt_userid],[nw_business_date],[nw_record_status])
 VALUES([Source].[nw_country_code],[Source].[nw_non_working_date],[Source].[nw_create_date],[Source].[nw_last_updt_date],[Source].[nw_last_updt_time],[Source].[nw_last_updt_userid],[Source].[nw_business_date],[Source].[nw_record_status]);
 
IF @mergeError != 0 
BEGIN 
PRINT 'ERROR OCCURRED IN MERGE FOR nw_non_working_date.sql. Rows affected: ' + CAST(@mergeCount AS VARCHAR(100)); -- SQL should always return zero rows affected 
END 
ELSE IF @mergeCount > 0 
BEGIN 
PRINT 'nw_non_working_date.sql rows affected by MERGE: ' + CAST(@mergeCount AS VARCHAR(100)); 
END 
 
PRINT 'Include rt_reports_to.sql' 
MERGE INTO [rt_reports_to] AS [Target]
USING (VALUES
  (1,N'',N'20100101',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'AR',N'20240111',N'I',0,0,1.000000000000000e+002,0.000000000000000e+000)
 ,(1000,N'',N'20100101',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'JC',N'20221019',N'I',0,0,1.000000000000000e+002,0.000000000000000e+000)
 ,(1001,N'',N'20100101',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'JC',N'20221019',N'I',0,0,1.000000000000000e+002,0.000000000000000e+000)
 ,(1002,N'',N'20100101',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'JC',N'20221019',N'I',0,0,1.000000000000000e+002,0.000000000000000e+000)
 ,(10000,N'',N'20100101',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'JC',N'20221019',N'I',0,0,1.000000000000000e+002,0.000000000000000e+000)
 ,(10001,N'',N'20100101',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'JC',N'20221019',N'I',0,0,1.000000000000000e+002,0.000000000000000e+000)
 ,(10002,N'',N'20100101',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'JC',N'20230119',N'I',0,0,1.000000000000000e+002,0.000000000000000e+000)
 ,(10003,N'',N'20100101',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'JC',N'20221019',N'I',0,0,1.000000000000000e+002,0.000000000000000e+000)
 ,(10004,N'',N'20100101',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'JC',N'20221019',N'I',0,0,1.000000000000000e+002,0.000000000000000e+000)
 ,(10005,N'',N'20100101',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'JC',N'20221019',N'I',0,0,1.000000000000000e+002,0.000000000000000e+000)
) AS [Source] ([iy_intermediary_id],[co_commission_type],[rt_effective_date],[rt_create_date],[rt_last_updt_date],[rt_last_updt_time],[rt_last_updt_userid],[rt_business_date],[rt_record_status],[rt_reports_to_intermed_id],[rt_pays_to_intermed_id],[rt_pays_to_percent],[rt_pay_sacrifice_to_percent])
ON ([Target].[co_commission_type] = [Source].[co_commission_type] AND [Target].[iy_intermediary_id] = [Source].[iy_intermediary_id] AND [Target].[rt_effective_date] = [Source].[rt_effective_date])
WHEN MATCHED AND (
	NULLIF([Source].[rt_last_updt_userid], [Target].[rt_last_updt_userid]) IS NOT NULL OR NULLIF([Target].[rt_last_updt_userid], [Source].[rt_last_updt_userid]) IS NOT NULL OR 
	NULLIF([Source].[rt_business_date], [Target].[rt_business_date]) IS NOT NULL OR NULLIF([Target].[rt_business_date], [Source].[rt_business_date]) IS NOT NULL OR 
	NULLIF([Source].[rt_record_status], [Target].[rt_record_status]) IS NOT NULL OR NULLIF([Target].[rt_record_status], [Source].[rt_record_status]) IS NOT NULL OR 
	NULLIF([Source].[rt_reports_to_intermed_id], [Target].[rt_reports_to_intermed_id]) IS NOT NULL OR NULLIF([Target].[rt_reports_to_intermed_id], [Source].[rt_reports_to_intermed_id]) IS NOT NULL OR 
	NULLIF([Source].[rt_pays_to_intermed_id], [Target].[rt_pays_to_intermed_id]) IS NOT NULL OR NULLIF([Target].[rt_pays_to_intermed_id], [Source].[rt_pays_to_intermed_id]) IS NOT NULL OR 
	NULLIF([Source].[rt_pays_to_percent], [Target].[rt_pays_to_percent]) IS NOT NULL OR NULLIF([Target].[rt_pays_to_percent], [Source].[rt_pays_to_percent]) IS NOT NULL OR 
	NULLIF([Source].[rt_pay_sacrifice_to_percent], [Target].[rt_pay_sacrifice_to_percent]) IS NOT NULL OR NULLIF([Target].[rt_pay_sacrifice_to_percent], [Source].[rt_pay_sacrifice_to_percent]) IS NOT NULL) THEN
 UPDATE SET
  [Target].[rt_last_updt_date] = [Source].[rt_last_updt_date], 
  [Target].[rt_last_updt_time] = [Source].[rt_last_updt_time], 
  [Target].[rt_last_updt_userid] = [Source].[rt_last_updt_userid], 
  [Target].[rt_business_date] = [Source].[rt_business_date], 
  [Target].[rt_record_status] = [Source].[rt_record_status], 
  [Target].[rt_reports_to_intermed_id] = [Source].[rt_reports_to_intermed_id], 
  [Target].[rt_pays_to_intermed_id] = [Source].[rt_pays_to_intermed_id], 
  [Target].[rt_pays_to_percent] = [Source].[rt_pays_to_percent], 
  [Target].[rt_pay_sacrifice_to_percent] = [Source].[rt_pay_sacrifice_to_percent]
WHEN NOT MATCHED BY TARGET THEN
 INSERT([iy_intermediary_id],[co_commission_type],[rt_effective_date],[rt_create_date],[rt_last_updt_date],[rt_last_updt_time],[rt_last_updt_userid],[rt_business_date],[rt_record_status],[rt_reports_to_intermed_id],[rt_pays_to_intermed_id],[rt_pays_to_percent],[rt_pay_sacrifice_to_percent])
 VALUES([Source].[iy_intermediary_id],[Source].[co_commission_type],[Source].[rt_effective_date],[Source].[rt_create_date],[Source].[rt_last_updt_date],[Source].[rt_last_updt_time],[Source].[rt_last_updt_userid],[Source].[rt_business_date],[Source].[rt_record_status],[Source].[rt_reports_to_intermed_id],[Source].[rt_pays_to_intermed_id],[Source].[rt_pays_to_percent],[Source].[rt_pay_sacrifice_to_percent]);

 SELECT @mergeError = @@ERROR, @mergeCount = @@ROWCOUNT

 
IF @mergeError != 0 
BEGIN 
PRINT 'ERROR OCCURRED IN MERGE FOR rt_reports_to.sql. Rows affected: ' + CAST(@mergeCount AS VARCHAR(100)); -- SQL should always return zero rows affected 
END 
ELSE IF @mergeCount > 0 
BEGIN 
PRINT 'rt_reports_to.sql rows affected by MERGE: ' + CAST(@mergeCount AS VARCHAR(100)); 
END 
 
PRINT 'Include sc_system_control.sql' 
MERGE INTO [sc_system_control] AS [Target]
USING (VALUES
  (1,N'Y',N'ALL',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'SYSTEM',N'I',N'20221019',N'20221019',N'20221019',N'ZAR',6153,N'20221019',N'Y',N'20.5.0',N'Eclipse ESM',877258,N'20230331',N'',N'',0)
) AS [Source] ([sc_system_control_id],[sc_default],[sc_group_key],[sc_create_date],[sc_last_updt_date],[sc_last_updt_time],[sc_last_updt_userid],[sc_record_status],[sc_run_from_date],[sc_run_to_date],[sc_business_date],[sc_base_currency],[sc_base_language],[sc_trail_comm_process_to_date],[sc_logins_enabled],[sc_version_number],[sc_system_id],[sc_rule_master_key],[sc_eclipse_golive_date],[sc_client_reconciliation_status],[sc_data_migration_id],[sc_archive_master_key])
ON ([Target].[sc_system_control_id] = [Source].[sc_system_control_id])
WHEN MATCHED AND (
	NULLIF([Source].[sc_default], [Target].[sc_default]) IS NOT NULL OR NULLIF([Target].[sc_default], [Source].[sc_default]) IS NOT NULL OR 
	NULLIF([Source].[sc_group_key], [Target].[sc_group_key]) IS NOT NULL OR NULLIF([Target].[sc_group_key], [Source].[sc_group_key]) IS NOT NULL OR 
	NULLIF([Source].[sc_create_date], [Target].[sc_create_date]) IS NOT NULL OR NULLIF([Target].[sc_create_date], [Source].[sc_create_date]) IS NOT NULL OR 
	NULLIF([Source].[sc_last_updt_date], [Target].[sc_last_updt_date]) IS NOT NULL OR NULLIF([Target].[sc_last_updt_date], [Source].[sc_last_updt_date]) IS NOT NULL OR 
	NULLIF([Source].[sc_last_updt_time], [Target].[sc_last_updt_time]) IS NOT NULL OR NULLIF([Target].[sc_last_updt_time], [Source].[sc_last_updt_time]) IS NOT NULL OR 
	NULLIF([Source].[sc_last_updt_userid], [Target].[sc_last_updt_userid]) IS NOT NULL OR NULLIF([Target].[sc_last_updt_userid], [Source].[sc_last_updt_userid]) IS NOT NULL OR 
	NULLIF([Source].[sc_record_status], [Target].[sc_record_status]) IS NOT NULL OR NULLIF([Target].[sc_record_status], [Source].[sc_record_status]) IS NOT NULL OR 
	NULLIF([Source].[sc_run_from_date], [Target].[sc_run_from_date]) IS NOT NULL OR NULLIF([Target].[sc_run_from_date], [Source].[sc_run_from_date]) IS NOT NULL OR 
	NULLIF([Source].[sc_run_to_date], [Target].[sc_run_to_date]) IS NOT NULL OR NULLIF([Target].[sc_run_to_date], [Source].[sc_run_to_date]) IS NOT NULL OR 
	NULLIF([Source].[sc_business_date], [Target].[sc_business_date]) IS NOT NULL OR NULLIF([Target].[sc_business_date], [Source].[sc_business_date]) IS NOT NULL OR 
	NULLIF([Source].[sc_base_currency], [Target].[sc_base_currency]) IS NOT NULL OR NULLIF([Target].[sc_base_currency], [Source].[sc_base_currency]) IS NOT NULL OR 
	NULLIF([Source].[sc_base_language], [Target].[sc_base_language]) IS NOT NULL OR NULLIF([Target].[sc_base_language], [Source].[sc_base_language]) IS NOT NULL OR 
	NULLIF([Source].[sc_trail_comm_process_to_date], [Target].[sc_trail_comm_process_to_date]) IS NOT NULL OR NULLIF([Target].[sc_trail_comm_process_to_date], [Source].[sc_trail_comm_process_to_date]) IS NOT NULL OR 
	NULLIF([Source].[sc_logins_enabled], [Target].[sc_logins_enabled]) IS NOT NULL OR NULLIF([Target].[sc_logins_enabled], [Source].[sc_logins_enabled]) IS NOT NULL OR 
	NULLIF([Source].[sc_version_number], [Target].[sc_version_number]) IS NOT NULL OR NULLIF([Target].[sc_version_number], [Source].[sc_version_number]) IS NOT NULL OR 
	NULLIF([Source].[sc_system_id], [Target].[sc_system_id]) IS NOT NULL OR NULLIF([Target].[sc_system_id], [Source].[sc_system_id]) IS NOT NULL OR 
	NULLIF([Source].[sc_rule_master_key], [Target].[sc_rule_master_key]) IS NOT NULL OR NULLIF([Target].[sc_rule_master_key], [Source].[sc_rule_master_key]) IS NOT NULL OR 
	NULLIF([Source].[sc_eclipse_golive_date], [Target].[sc_eclipse_golive_date]) IS NOT NULL OR NULLIF([Target].[sc_eclipse_golive_date], [Source].[sc_eclipse_golive_date]) IS NOT NULL OR 
	NULLIF([Source].[sc_client_reconciliation_status], [Target].[sc_client_reconciliation_status]) IS NOT NULL OR NULLIF([Target].[sc_client_reconciliation_status], [Source].[sc_client_reconciliation_status]) IS NOT NULL OR 
	NULLIF([Source].[sc_data_migration_id], [Target].[sc_data_migration_id]) IS NOT NULL OR NULLIF([Target].[sc_data_migration_id], [Source].[sc_data_migration_id]) IS NOT NULL OR 
	NULLIF([Source].[sc_archive_master_key], [Target].[sc_archive_master_key]) IS NOT NULL OR NULLIF([Target].[sc_archive_master_key], [Source].[sc_archive_master_key]) IS NOT NULL) THEN
 UPDATE SET
  [Target].[sc_default] = [Source].[sc_default], 
  [Target].[sc_group_key] = [Source].[sc_group_key], 
  [Target].[sc_create_date] = [Source].[sc_create_date], 
  [Target].[sc_last_updt_date] = [Source].[sc_last_updt_date], 
  [Target].[sc_last_updt_time] = [Source].[sc_last_updt_time], 
  [Target].[sc_last_updt_userid] = [Source].[sc_last_updt_userid], 
  [Target].[sc_record_status] = [Source].[sc_record_status], 
  [Target].[sc_run_from_date] = [Source].[sc_run_from_date], 
  [Target].[sc_run_to_date] = [Source].[sc_run_to_date], 
  [Target].[sc_business_date] = [Source].[sc_business_date], 
  [Target].[sc_base_currency] = [Source].[sc_base_currency], 
  [Target].[sc_base_language] = [Source].[sc_base_language], 
  [Target].[sc_trail_comm_process_to_date] = [Source].[sc_trail_comm_process_to_date], 
  [Target].[sc_logins_enabled] = [Source].[sc_logins_enabled], 
  [Target].[sc_version_number] = [Source].[sc_version_number], 
  [Target].[sc_system_id] = [Source].[sc_system_id], 
  [Target].[sc_rule_master_key] = [Source].[sc_rule_master_key], 
  [Target].[sc_eclipse_golive_date] = [Source].[sc_eclipse_golive_date], 
  [Target].[sc_client_reconciliation_status] = [Source].[sc_client_reconciliation_status], 
  [Target].[sc_data_migration_id] = [Source].[sc_data_migration_id], 
  [Target].[sc_archive_master_key] = [Source].[sc_archive_master_key]
WHEN NOT MATCHED BY TARGET THEN
 INSERT([sc_system_control_id],[sc_default],[sc_group_key],[sc_create_date],[sc_last_updt_date],[sc_last_updt_time],[sc_last_updt_userid],[sc_record_status],[sc_run_from_date],[sc_run_to_date],[sc_business_date],[sc_base_currency],[sc_base_language],[sc_trail_comm_process_to_date],[sc_logins_enabled],[sc_version_number],[sc_system_id],[sc_rule_master_key],[sc_eclipse_golive_date],[sc_client_reconciliation_status],[sc_data_migration_id],[sc_archive_master_key])
 VALUES([Source].[sc_system_control_id],[Source].[sc_default],[Source].[sc_group_key],[Source].[sc_create_date],[Source].[sc_last_updt_date],[Source].[sc_last_updt_time],[Source].[sc_last_updt_userid],[Source].[sc_record_status],[Source].[sc_run_from_date],[Source].[sc_run_to_date],[Source].[sc_business_date],[Source].[sc_base_currency],[Source].[sc_base_language],[Source].[sc_trail_comm_process_to_date],[Source].[sc_logins_enabled],[Source].[sc_version_number],[Source].[sc_system_id],[Source].[sc_rule_master_key],[Source].[sc_eclipse_golive_date],[Source].[sc_client_reconciliation_status],[Source].[sc_data_migration_id],[Source].[sc_archive_master_key]);
 
IF @mergeError != 0 
BEGIN 
PRINT 'ERROR OCCURRED IN MERGE FOR sc_system_control.sql. Rows affected: ' + CAST(@mergeCount AS VARCHAR(100)); -- SQL should always return zero rows affected 
END 
ELSE IF @mergeCount > 0 
BEGIN 
PRINT 'sc_system_control.sql rows affected by MERGE: ' + CAST(@mergeCount AS VARCHAR(100)); 
END 
 
PRINT 'Include sn_next_system_number.sql' 
MERGE INTO [sn_next_system_number] AS [Target]
USING (VALUES
  (N'ACCOUNT',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'D8341',N'20060210',N'I',100003)
 ,(N'ADDRESS',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'sysman',N'20030515',N'I',100020)
 ,(N'AECTRL',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'BRData',N'20121214',N'I',0)
 ,(N'AUDREFEMP',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'BRData',N'20110407',N'I',100000)
 ,(N'AUDREFPOL',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'BRData',N'20110407',N'I',100000)
 ,(N'BACSTELIP',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'BRData',N'20110405',N'I',0)
 ,(N'BELGIUM',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'script',N'20061214',N'I',0)
 ,(N'BENEFICIARY',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'sysman',N'20141113',N'I',0)
 ,(N'BILLINGGRPS',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'corman1',N'20100415',N'I',0)
 ,(N'BLOBREPOSITORY',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'Script',N'20141009',N'I',0)
 ,(N'BULKACTION',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'Port',N'20130516',N'I',0)
 ,(N'BULKSWITCH',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'sysman',N'20100415',N'I',0)
 ,(N'CASHBATCH',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'sysman',N'20030515',N'I',0)
 ,(N'CASHINPUT',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'sysman',N'20030515',N'I',0)
 ,(N'CC',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'SYSTEM1',N'20100415',N'I',0)
 ,(N'CHQ_PAY_GENACC',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'CR108',N'20130516',N'I',100000)
 ,(N'CHQBATNUM',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'script',N'20060210',N'I',0)
 ,(N'CLADJUSTMENT',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'sysman',N'20070223',N'I',0)
 ,(N'CLAIM',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'sysman',N'20050610',N'I',0)
 ,(N'CLIENT',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'sysman',N'20030515',N'I',1000000020)
 ,(N'CLIENTRELAT',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'TAMM',N'20051904',N'I',0)
 ,(N'CLIENTSALARIES',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'oscheme',N'20140718',N'I',0)
 ,(N'COMPANY',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'sysman',N'20030515',N'I',2)
 ,(N'COMPANYBANK',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'ebv',N'20030515',N'I',1)
 ,(N'CONTCAT',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'corman1',N'20100415',N'I',1000)
 ,(N'CORRES_LOG',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'BRData',N'20120427',N'I',0)
 ,(N'CUSTCOMPLAINT',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'sysman',N'20061108',N'I',0)
 ,(N'DCASSID',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'script',N'20060210',N'I',0)
 ,(N'DCTRFID',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'SYSTEM',N'20060210',N'I',0)
 ,(N'DD_SWIFTAT',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'script',N'20070920',N'I',0)
 ,(N'DD_SWIFTDE',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'script',N'20070920',N'I',0)
 ,(N'DELTAFILECOUNTE',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'D104',N'20130516',N'I',0)
 ,(N'DOC_MPA',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'D561301',N'20160219',N'I',0)
 ,(N'DOC_SA',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'sysman',N'20130607',N'I',0)
 ,(N'EVENTAEOO',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'BRData',N'20130212',N'I',0)
 ,(N'EVENTAFS',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'BRData',N'20110623',N'I',0)
 ,(N'EVENTCLM',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'BRData',N'20110905',N'I',0)
 ,(N'EVENTCTRN',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'BRData',N'20121114',N'I',0)
 ,(N'EVENTIDCH',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'D7579',N'20130516',N'I',0)
 ,(N'EVENTIDCL',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'D7579',N'20130516',N'I',0)
 ,(N'EVENTIDCO',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'D7579',N'20130516',N'I',0)
 ,(N'EVENTIDCP',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'D7579',N'20130516',N'I',0)
 ,(N'EVENTIDFD',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'D7579',N'20130516',N'I',0)
 ,(N'EVENTIDLB',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'D7579',N'20130516',N'I',0)
 ,(N'EVENTIDLP',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'CR516',N'20130516',N'I',0)
 ,(N'EVENTIDMI',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'D7579',N'20130516',N'I',0)
 ,(N'EVENTIDPC',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'CR516',N'20130516',N'I',0)
 ,(N'EVENTIDPD',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'CR516',N'20130516',N'I',0)
 ,(N'EVENTIDPU',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'CR516',N'20130516',N'I',0)
 ,(N'EVENTIDSC',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'D7579',N'20130516',N'I',0)
 ,(N'EVENTIDSW',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'D7579',N'20130516',N'I',0)
 ,(N'EVENTIDTI',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'D7579',N'20130516',N'I',0)
 ,(N'EVENTIDUA',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'D7579',N'20130516',N'I',0)
 ,(N'EVENTIDXX',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'CR516',N'20130516',N'I',0)
 ,(N'EVENTMIN',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'BRData',N'20110623',N'I',0)
 ,(N'EVENTMOT',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'BRData',N'20110623',N'I',0)
 ,(N'EVENTPIR',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'DD',N'20141009',N'I',0)
 ,(N'EVENTSWI',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'BRData',N'20110623',N'I',0)
 ,(N'EVENTUAJ',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'BRData',N'20110905',N'I',0)
 ,(N'EXCHANGERATE',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'D104H002',N'20160219',N'I',0)
 ,(N'EXCLUSION',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'script',N'20070413',N'I',0)
 ,(N'EXTRACTID1',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'ebv',N'20030515',N'I',0)
 ,(N'EXTRACTID2',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'ebv',N'20030515',N'I',0)
 ,(N'EXTRACTID3',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'ebv',N'20030515',N'I',0)
 ,(N'FASTCLIENT',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'PORT',N'10000101',N'I',0)
 ,(N'FUND_PER_POLICY',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'sysman',N'20080320',N'I',1)
 ,(N'FUNDCLOSURE',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'GTI992',N'20120705',N'I',0)
 ,(N'FUNDPRICE',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'D104H002',N'20160219',N'I',0)
 ,(N'FUNDSPLTHIST',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'robert',N'20061214',N'I',10000)
 ,(N'ILLUSTRATIONREF',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'sysman',N'20130724',N'I',0)
 ,(N'INSTFILENUMBER',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'BRData',N'20111209',N'I',0)
 ,(N'INSTFILESEQNO',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'BRData',N'20111209',N'I',0)
 ,(N'INTERMEDIARY',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'oindiv',N'20030515',N'I',10005)
 ,(N'INVESTMENTGRPS',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'corman1',N'20100415',N'I',0)
 ,(N'IY_EXTREF_0',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'oindiv',N'20121126',N'I',10000)
 ,(N'IY_EXTREF_B',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'sysman',N'20121126',N'I',10000)
 ,(N'IY_EXTREF_F',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'script',N'20121126',N'I',10000)
 ,(N'IY_EXTREF_N',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'script',N'20121126',N'I',10000)
 ,(N'LOADING',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'script',N'20070413',N'I',0)
 ,(N'MSGIDSEPADC',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'D7911',N'20130212',N'I',0)
 ,(N'MSGIDSEPADD',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'D7911',N'20130212',N'I',0)
 ,(N'NORWAY',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'script',N'20070110',N'I',0)
 ,(N'NOTE',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'sysman',N'20051904',N'I',0)
 ,(N'PAYINFOSEPADC',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'D7911',N'20130212',N'I',0)
 ,(N'PAYINFOSEPADD',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'D7911',N'20130212',N'I',0)
 ,(N'PAYMENT',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'SYSTEM',N'20030515',N'I',0)
 ,(N'PAYMENT_CHQ_REF',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'Script',N'20141113',N'I',0)
 ,(N'PAYMNB',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'KP',N'20130618',N'I',0)
 ,(N'PAYMPACS',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'KP',N'20130618',N'I',0)
 ,(N'PIRACLAIM',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'DD',N'20141009',N'I',0)
 ,(N'PIRASLOG',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'SYSTEM',N'20141009',N'I',0)
 ,(N'POLICY',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'sysman',N'20030515',N'I',10000000)
 ,(N'PPTTYPEGRPS',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'BRData',N'20111209',N'I',0)
 ,(N'PR_AT_1',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'script',N'20070411',N'I',10000000)
 ,(N'PR_DE_1',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'script',N'20070411',N'I',10000000)
 ,(N'PRICEADJUST',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'script',N'20091002',N'I',0)
 ,(N'QUOTATION',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'sysman',N'20050822',N'I',0)
 ,(N'REQPACK',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'',N'20070420',N'I',0)
 ,(N'REQUEST',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'BRData',N'20120418',N'I',0)
 ,(N'REQUIREMENT',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'',N'20070420',N'I',0)
 ,(N'RPTEVNT',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'BRData',N'20110523',N'I',0)
 ,(N'S2P',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'BRData',N'20120418',N'I',0)
 ,(N'SA_ANIV',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'corman1',N'',N'I',0)
 ,(N'SAPEXTRACTID',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'BRData',N'20110501',N'I',0)
 ,(N'SCHCOMPANYNO',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'corman1',N'20141113',N'I',0)
 ,(N'SCHEDULEREFID',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'Script',N'20141009',N'I',0)
 ,(N'SCHEME',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'corman1',N'10000101',N'I',0)
 ,(N'SCHEME_CNTR_CAT',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'corman1',N'20100415',N'I',0)
 ,(N'SCHMMEMCLASSID',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'corman1',N'20100415',N'I',0)
 ,(N'SCLAIM',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'sysman',N'20130326',N'I',0)
 ,(N'SPLITS_GROUP_ID',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'sysman',N'20081218',N'I',10000)
 ,(N'SWEDEN',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'SYSTEM1',N'20061214',N'I',0)
 ,(N'SYSTEM_CONTROL',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'Script',N'20140904',N'I',0)
 ,(N'SYSTEMLOG',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'corman1',N'20150930',N'I',0)
 ,(N'WSTRANSID',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'sysman',N'20160126',N'I',0)
 ,(N'CLTTAXDIRECTIVE',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'sysman',N'20230202',N'I',0)
 ,(N'EXITTAXDIRECREQ',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'sysman',N'20230202',N'I',0) 
 ,(N'IYCOMMPAYMID',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'sysman',N'20230202',N'I',0)
 ,(N'TRANSFERID',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'sysman',N'20230202',N'I',1)
 ,(N'EXITTAXDETAILID',CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),N'sysman',N'20230202',N'I',0)
) AS [Source] ([sn_type],[sn_create_date],[sn_last_updt_date],[sn_last_updt_time],[sn_last_updt_userid],[sn_business_date],[sn_record_status],[sn_next_id])
ON ([Target].[sn_type] = [Source].[sn_type])
WHEN MATCHED AND (
	NULLIF([Source].[sn_last_updt_userid], [Target].[sn_last_updt_userid]) IS NOT NULL OR NULLIF([Target].[sn_last_updt_userid], [Source].[sn_last_updt_userid]) IS NOT NULL OR 
	NULLIF([Source].[sn_business_date], [Target].[sn_business_date]) IS NOT NULL OR NULLIF([Target].[sn_business_date], [Source].[sn_business_date]) IS NOT NULL OR 
	NULLIF([Source].[sn_record_status], [Target].[sn_record_status]) IS NOT NULL OR NULLIF([Target].[sn_record_status], [Source].[sn_record_status]) IS NOT NULL OR 
	NULLIF([Source].[sn_next_id], [Target].[sn_next_id]) IS NOT NULL OR NULLIF([Target].[sn_next_id], [Source].[sn_next_id]) IS NOT NULL) THEN
 UPDATE SET
  [Target].[sn_last_updt_date] = CONVERT(CHAR(8),GETDATE(),112), 
  [Target].[sn_last_updt_time] = RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')), 
  [Target].[sn_last_updt_userid] = [Source].[sn_last_updt_userid], 
  [Target].[sn_business_date] = [Source].[sn_business_date], 
  [Target].[sn_record_status] = [Source].[sn_record_status]
WHEN NOT MATCHED BY TARGET THEN
 INSERT([sn_type],[sn_create_date],[sn_last_updt_date],[sn_last_updt_time],[sn_last_updt_userid],[sn_business_date],[sn_record_status],[sn_next_id])
 VALUES([Source].[sn_type],CONVERT(CHAR(8),GETDATE(),112),CONVERT(CHAR(8),GETDATE(),112),RTRIM(REPLACE(CONVERT(CHAR(8),GETDATE(),108),':','')),[Source].[sn_last_updt_userid],[Source].[sn_business_date],[Source].[sn_record_status],[Source].[sn_next_id]);


 
IF @mergeError != 0 
BEGIN 
PRINT 'ERROR OCCURRED IN MERGE FOR sn_next_system_number.sql. Rows affected: ' + CAST(@mergeCount AS VARCHAR(100)); -- SQL should always return zero rows affected 
END 
ELSE IF @mergeCount > 0 
BEGIN 
PRINT 'sn_next_system_number.sql rows affected by MERGE: ' + CAST(@mergeCount AS VARCHAR(100)); 
END 
 
 
-- Product Setup 
 
 
exec sp_MSForEachTable "ALTER TABLE ? WITH CHECK CHECK CONSTRAINT all" 
 
 
exec sp_MSForEachTable 'IF EXISTS (SELECT * FROM (SELECT c.name AS obj_or_col, p.name, p.value FROM sys.columns c LEFT JOIN sys.extended_properties p ON p.major_id = c.object_id and p.minor_id = c.column_id AND p.class = 1 WHERE object_id = object_id(''?'') UNION SELECT ''?'' AS obj_or_col, p2.name, p2.value FROM sys.tables t LEFT JOIN (SELECT * FROM sys.extended_properties WHERE minor_id = 0) p2 ON t.object_id = p2.major_id WHERE object_id = object_id(''?'')) a WHERE a.value is null) BEGIN DECLARE @log NVARCHAR(255) SET @log = ''TABLE '' + ''?'' + '' - THE EXTENDED PROPERTY IS REQUIRED FOR THE TABLE AND FOR EACH OF ITS COLUMNS IN PERCANA SCHEMA.'' RAISERROR(''Error: %s'',16, 1,  @log) END' 
 
 
-- Post Deployment Scripts 
 
print 'Include PostDeploymentScript.Data.sql' 
Print 'Inserting PSSL entries (Data)'
--MG: Clear down this file when the release has been released to Production

--EXAMPLE:
--EXEC Add_PSSL_Log_Entry 'Detail of the Change', 'A Reference eg ALM1234', 'A Note eg Table/SP updated XXXX', @Version

--No need to define @version again, it's already declared in the base DB

--@Version is set in "UpdateVersion.sql"


 
GO

GO
PRINT N'Checking existing data against newly created constraints';


GO
USE [$(DatabaseName)];


GO
ALTER TABLE [dbo].[gsco_scheme_charge_options] WITH CHECK CHECK CONSTRAINT [FK_gsc_scheme];


GO
PRINT N'Update complete.';


GO



(56,1): SQL72014: Framework Microsoft SqlClient Data Provider: Msg 50000, Level 16, State 127, Line 12 Rows were detected. The schema update is terminating because data loss might occur.
(45,0): SQL72045: Script execution error.  The executed script:
IF EXISTS (SELECT TOP 1 1
           FROM   [dbo].[iy_intermediary])
    RAISERROR (N'Rows were detected. The schema update is terminating because data loss might occur.', 16, 127)
        WITH NOWAIT;

An error occurred while the batch was being executed.
